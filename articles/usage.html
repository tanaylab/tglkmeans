<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>basic usage • tglkmeans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="basic usage">
<meta property="og:description" content="tglkmeans">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tglkmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../articles/usage.html">
    <span class="fa fa-road"></span>
     
    Usage
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tanaylab/tglkmeans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="usage_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>basic usage</h1>
                        <h4 data-toc-skip class="author">Aviezer Lifshitz</h4>
            
            <h4 data-toc-skip class="date">2023-06-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tanaylab/tglkmeans/blob/HEAD/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>Basic usage of the package.</p>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>First, let’s create 5 clusters normally distributed around 1 to 5, with sd of 0.3:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">5</span>, dims <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1 0.9986639 0.8901407          1</span></span>
<span><span class="co">## 2     2 0.9397869 0.9131388          1</span></span>
<span><span class="co">## 3     3 1.1809664 0.4672072          1</span></span>
<span><span class="co">## 4     4 1.4292573 0.5436311          1</span></span>
<span><span class="co">## 5     5 1.2596318 0.2413431          1</span></span>
<span><span class="co">## 6     6 0.7151423 0.7210814          1</span></span>
<span><span class="co">## 7     7 0.8884853 1.1352640          1</span></span>
<span><span class="co">## 8     8 0.7950018 1.1187463          1</span></span>
<span><span class="co">## 9     9 0.8690248 0.4504063          1</span></span>
<span><span class="co">## 10   10 0.6357113 0.9715179          1</span></span>
<span><span class="co">## 11   11 0.9000577 1.2805444          1</span></span>
<span><span class="co">## 12   12 1.4746360 0.6156472          1</span></span>
<span><span class="co">## 13   13 1.4366340 1.0545479          1</span></span>
<span><span class="co">## 14   14 1.2899331 1.2562131          1</span></span>
<span><span class="co">## 15   15 1.4628055 1.2575146          1</span></span>
<span><span class="co">## 16   16 0.6130055 1.1904492          1</span></span>
<span><span class="co">## 17   17 1.1835260 1.2417895          1</span></span>
<span><span class="co">## 18   18 0.9506597 1.1431190          1</span></span>
<span><span class="co">## 19   19 1.1844314 1.0518474          1</span></span>
<span><span class="co">## 20   20 1.2355932 1.2807134          1</span></span>
<span><span class="co">## 21   21 0.8570776 0.7379783          1</span></span>
<span><span class="co">## 22   22 0.4053151 1.3345618          1</span></span>
<span><span class="co">## 23   23 0.4636049 0.7165247          1</span></span>
<span><span class="co">## 24   24 0.5373783 1.0177528          1</span></span>
<span><span class="co">## 25   25 1.2278081 1.1435106          1</span></span>
<span><span class="co">## 26   26 1.1913541 1.0906512          1</span></span>
<span><span class="co">## 27   27 1.1720428 1.4386357          1</span></span>
<span><span class="co">## 28   28 1.2248446 0.9125590          1</span></span>
<span><span class="co">## 29   29 0.9941577 1.2716917          1</span></span>
<span><span class="co">## 30   30 0.5898527 0.9275008          1</span></span>
<span><span class="co">## 31   31 0.3510941 0.9855369          1</span></span>
<span><span class="co">## 32   32 0.7980975 1.1412251          1</span></span>
<span><span class="co">## 33   33 0.9440323 0.7440647          1</span></span>
<span><span class="co">## 34   34 1.3585888 1.6240801          1</span></span>
<span><span class="co">## 35   35 1.2414055 0.5266514          1</span></span>
<span><span class="co">## 36   36 0.9566505 0.7442030          1</span></span>
<span><span class="co">## 37   37 0.7600531 0.5761380          1</span></span>
<span><span class="co">## 38   38 0.7945392 0.8946354          1</span></span>
<span><span class="co">## 39   39 0.7022760 0.6940815          1</span></span>
<span><span class="co">## 40   40 0.8106867 0.6235157          1</span></span>
<span><span class="co">## 41   41 1.0284872 0.8775284          1</span></span>
<span><span class="co">## 42   42 1.0352253 0.8710146          1</span></span>
<span><span class="co">## 43   43 1.1060478 0.4315174          1</span></span>
<span><span class="co">## 44   44 0.9791098 0.7284765          1</span></span>
<span><span class="co">## 45   45 0.7899155 0.9785046          1</span></span>
<span><span class="co">## 46   46 0.7923973 0.5739655          1</span></span>
<span><span class="co">## 47   47 1.4455441 1.0285549          1</span></span>
<span><span class="co">## 48   48 0.5880953 0.9597077          1</span></span>
<span><span class="co">## 49   49 1.2522732 0.9665366          1</span></span>
<span><span class="co">## 50   50 0.8333133 0.8287706          1</span></span>
<span><span class="co">## 51   51 0.6653892 1.3618898          1</span></span>
<span><span class="co">## 52   52 1.7845117 1.1310143          1</span></span>
<span><span class="co">## 53   53 1.2110432 1.2772413          1</span></span>
<span><span class="co">## 54   54 0.8931158 1.2921937          1</span></span>
<span><span class="co">## 55   55 0.5620760 0.5846358          1</span></span>
<span><span class="co">## 56   56 0.7746430 1.0278849          1</span></span>
<span><span class="co">## 57   57 1.1820735 1.0146473          1</span></span>
<span><span class="co">## 58   58 0.7237688 1.4774062          1</span></span>
<span><span class="co">## 59   59 0.9076580 0.8193090          1</span></span>
<span><span class="co">## 60   60 0.8088752 0.6154539          1</span></span>
<span><span class="co">## 61   61 1.0404385 1.1320746          1</span></span>
<span><span class="co">## 62   62 0.3177934 1.1419999          1</span></span>
<span><span class="co">## 63   63 1.4013021 0.9802873          1</span></span>
<span><span class="co">## 64   64 1.1390429 0.9890521          1</span></span>
<span><span class="co">## 65   65 1.0870802 1.5227485          1</span></span>
<span><span class="co">## 66   66 0.8104032 1.6313094          1</span></span>
<span><span class="co">## 67   67 0.4766740 1.1755215          1</span></span>
<span><span class="co">## 68   68 0.9305353 0.9386070          1</span></span>
<span><span class="co">## 69   69 0.7532836 0.8747611          1</span></span>
<span><span class="co">## 70   70 0.9370037 0.7618708          1</span></span>
<span><span class="co">## 71   71 0.8397674 1.2007583          1</span></span>
<span><span class="co">## 72   72 0.9238208 0.5452316          1</span></span>
<span><span class="co">## 73   73 0.9623825 1.2708313          1</span></span>
<span><span class="co">## 74   74 0.4977256 0.8563626          1</span></span>
<span><span class="co">## 75   75 0.8549983 0.7741227          1</span></span>
<span><span class="co">## 76   76 1.1704810 0.4946855          1</span></span>
<span><span class="co">## 77   77 0.9162371 0.6329495          1</span></span>
<span><span class="co">## 78   78 0.7358961 0.5230634          1</span></span>
<span><span class="co">## 79   79 0.7460989 0.4275599          1</span></span>
<span><span class="co">## 80   80 0.3638633 0.7987698          1</span></span>
<span><span class="co">## 81   81 0.6318527 0.9165657          1</span></span>
<span><span class="co">## 82   82 1.6152692 1.4224224          1</span></span>
<span><span class="co">## 83   83 0.6978724 1.0889629          1</span></span>
<span><span class="co">## 84   84 0.7447581 0.5610648          1</span></span>
<span><span class="co">## 85   85 1.2139032 1.0594453          1</span></span>
<span><span class="co">## 86   86 1.4895143 1.3067910          1</span></span>
<span><span class="co">## 87   87 0.7923500 1.2111718          1</span></span>
<span><span class="co">## 88   88 1.4411077 0.9895184          1</span></span>
<span><span class="co">## 89   89 1.0737991 0.8694432          1</span></span>
<span><span class="co">## 90   90 0.8694068 1.4964493          1</span></span>
<span><span class="co">## 91   91 0.3885946 0.8752887          1</span></span>
<span><span class="co">## 92   92 1.4100884 0.6048284          1</span></span>
<span><span class="co">## 93   93 1.2501683 0.3574455          1</span></span>
<span><span class="co">## 94   94 0.3639745 1.3606872          1</span></span>
<span><span class="co">## 95   95 1.3267792 0.6413599          1</span></span>
<span><span class="co">## 96   96 1.0940570 0.7259493          1</span></span>
<span><span class="co">## 97   97 1.2448649 1.0849730          1</span></span>
<span><span class="co">## 98   98 1.1569162 0.8200929          1</span></span>
<span><span class="co">## 99   99 1.1379620 1.3875872          1</span></span>
<span><span class="co">## 100 100 1.0565823 0.9511343          1</span></span>
<span><span class="co">## 101 101 1.6416216 1.6828977          2</span></span>
<span><span class="co">## 102 102 2.1694707 2.2125773          2</span></span>
<span><span class="co">## 103 103 1.4947234 2.0589632          2</span></span>
<span><span class="co">## 104 104 1.5932699 2.4656596          2</span></span>
<span><span class="co">## 105 105 1.7437876 2.4574327          2</span></span>
<span><span class="co">## 106 106 2.3313391 2.5108229          2</span></span>
<span><span class="co">## 107 107 1.6614988 2.5705861          2</span></span>
<span><span class="co">## 108 108 2.6522224 1.4231406          2</span></span>
<span><span class="co">## 109 109 2.0632449 2.5595931          2</span></span>
<span><span class="co">## 110 110 2.0899348 2.1322522          2</span></span>
<span><span class="co">## 111 111 1.6631189 2.4167389          2</span></span>
<span><span class="co">## 112 112 1.9068049 2.1704974          2</span></span>
<span><span class="co">## 113 113 1.6753682 1.4924698          2</span></span>
<span><span class="co">## 114 114 2.1241447 1.5642625          2</span></span>
<span><span class="co">## 115 115 1.8151511 1.9170639          2</span></span>
<span><span class="co">## 116 116 2.2544943 1.8265669          2</span></span>
<span><span class="co">## 117 117 2.4208950 1.8593799          2</span></span>
<span><span class="co">## 118 118 1.9786677 1.7520775          2</span></span>
<span><span class="co">## 119 119 2.2372721 1.5055899          2</span></span>
<span><span class="co">## 120 120 2.4838427 1.7996151          2</span></span>
<span><span class="co">## 121 121 2.0613878 1.3385585          2</span></span>
<span><span class="co">## 122 122 1.7240434 1.9695839          2</span></span>
<span><span class="co">## 123 123 2.7044538 1.5063201          2</span></span>
<span><span class="co">## 124 124 1.8954359 1.4132558          2</span></span>
<span><span class="co">## 125 125 1.9502301 1.9647875          2</span></span>
<span><span class="co">## 126 126 1.4339560 2.2161246          2</span></span>
<span><span class="co">## 127 127 2.0551036 1.9945926          2</span></span>
<span><span class="co">## 128 128 2.2422182 2.0302269          2</span></span>
<span><span class="co">## 129 129 2.1268752 2.0671875          2</span></span>
<span><span class="co">## 130 130 1.7048198 2.2226269          2</span></span>
<span><span class="co">## 131 131 1.5576361 2.2794209          2</span></span>
<span><span class="co">## 132 132 2.2415996 2.1610902          2</span></span>
<span><span class="co">## 133 133 1.7911792 1.2212559          2</span></span>
<span><span class="co">## 134 134 1.7169240 1.9998300          2</span></span>
<span><span class="co">## 135 135 1.5115295 1.5301805          2</span></span>
<span><span class="co">## 136 136 2.1605979 1.4866680          2</span></span>
<span><span class="co">## 137 137 2.4336286 1.2961107          2</span></span>
<span><span class="co">## 138 138 2.1522741 1.8020930          2</span></span>
<span><span class="co">## 139 139 1.7725645 1.7136550          2</span></span>
<span><span class="co">## 140 140 2.0001988 1.8948502          2</span></span>
<span><span class="co">## 141 141 2.7241006 1.9873009          2</span></span>
<span><span class="co">## 142 142 2.3714159 1.7081804          2</span></span>
<span><span class="co">## 143 143 1.8723639 1.6053945          2</span></span>
<span><span class="co">## 144 144 2.1072140 1.8091032          2</span></span>
<span><span class="co">## 145 145 2.2936213 2.1687568          2</span></span>
<span><span class="co">## 146 146 2.2043625 2.4514877          2</span></span>
<span><span class="co">## 147 147 1.7648243 2.4158670          2</span></span>
<span><span class="co">## 148 148 2.2334881 2.4615828          2</span></span>
<span><span class="co">## 149 149 1.7834150 2.4378427          2</span></span>
<span><span class="co">## 150 150 1.8272180 2.1571475          2</span></span>
<span><span class="co">## 151 151 2.1738078 1.6600999          2</span></span>
<span><span class="co">## 152 152 2.4365192 1.8413524          2</span></span>
<span><span class="co">## 153 153 1.7927813 2.1444888          2</span></span>
<span><span class="co">## 154 154 1.8975729 2.0878644          2</span></span>
<span><span class="co">## 155 155 1.1603959 1.7239607          2</span></span>
<span><span class="co">## 156 156 1.7583913 1.7751672          2</span></span>
<span><span class="co">## 157 157 2.2760671 1.9737002          2</span></span>
<span><span class="co">## 158 158 2.1956289 2.1844034          2</span></span>
<span><span class="co">## 159 159 2.2053458 2.2911432          2</span></span>
<span><span class="co">## 160 160 1.9851161 1.6441387          2</span></span>
<span><span class="co">## 161 161 2.1008578 1.6761701          2</span></span>
<span><span class="co">## 162 162 1.8272071 2.0604697          2</span></span>
<span><span class="co">## 163 163 1.2923658 2.1755957          2</span></span>
<span><span class="co">## 164 164 1.9635670 2.3951215          2</span></span>
<span><span class="co">## 165 165 2.2749796 1.8571944          2</span></span>
<span><span class="co">## 166 166 2.1556153 2.0123586          2</span></span>
<span><span class="co">## 167 167 2.3061893 1.8365463          2</span></span>
<span><span class="co">## 168 168 2.4120947 2.3642072          2</span></span>
<span><span class="co">## 169 169 2.4215307 2.3055680          2</span></span>
<span><span class="co">## 170 170 1.9749919 1.8675248          2</span></span>
<span><span class="co">## 171 171 2.8527492 2.1584536          2</span></span>
<span><span class="co">## 172 172 1.6851311 1.5629254          2</span></span>
<span><span class="co">## 173 173 1.8517314 2.0980886          2</span></span>
<span><span class="co">## 174 174 1.8782458 2.0736759          2</span></span>
<span><span class="co">## 175 175 1.9883913 1.6019185          2</span></span>
<span><span class="co">## 176 176 2.1570711 2.1786492          2</span></span>
<span><span class="co">## 177 177 1.5542745 2.0186447          2</span></span>
<span><span class="co">## 178 178 1.8779004 1.7952421          2</span></span>
<span><span class="co">## 179 179 2.0293495 2.6718543          2</span></span>
<span><span class="co">## 180 180 1.5396571 2.3480480          2</span></span>
<span><span class="co">## 181 181 2.1121541 1.9987047          2</span></span>
<span><span class="co">## 182 182 1.3815479 1.6964449          2</span></span>
<span><span class="co">## 183 183 1.8810873 1.6201371          2</span></span>
<span><span class="co">## 184 184 2.1664888 2.0304742          2</span></span>
<span><span class="co">## 185 185 1.6449955 2.8446532          2</span></span>
<span><span class="co">## 186 186 2.3458794 2.2354540          2</span></span>
<span><span class="co">## 187 187 1.6533284 1.8893014          2</span></span>
<span><span class="co">## 188 188 2.1818932 1.5441471          2</span></span>
<span><span class="co">## 189 189 2.4306306 2.2458746          2</span></span>
<span><span class="co">## 190 190 1.5520431 2.4467210          2</span></span>
<span><span class="co">## 191 191 2.5497076 1.4227117          2</span></span>
<span><span class="co">## 192 192 2.4628584 1.7974234          2</span></span>
<span><span class="co">## 193 193 1.6500536 1.6134059          2</span></span>
<span><span class="co">## 194 194 1.9664335 1.8358849          2</span></span>
<span><span class="co">## 195 195 1.8149487 1.7343726          2</span></span>
<span><span class="co">## 196 196 2.3165582 1.6119428          2</span></span>
<span><span class="co">## 197 197 1.7583275 2.0834805          2</span></span>
<span><span class="co">## 198 198 1.8363199 1.8298996          2</span></span>
<span><span class="co">## 199 199 1.9900491 2.0167937          2</span></span>
<span><span class="co">## 200 200 1.7365051 2.0967882          2</span></span>
<span><span class="co">## 201 201 3.0995097 3.1327280          3</span></span>
<span><span class="co">## 202 202 2.7698552 3.4792139          3</span></span>
<span><span class="co">## 203 203 3.0557657 2.8916042          3</span></span>
<span><span class="co">## 204 204 2.9834171 2.7812550          3</span></span>
<span><span class="co">## 205 205 2.7077484 3.0028620          3</span></span>
<span><span class="co">## 206 206 3.5529338 2.8174249          3</span></span>
<span><span class="co">## 207 207 3.1145937 2.9296861          3</span></span>
<span><span class="co">## 208 208 3.0276545 2.7030419          3</span></span>
<span><span class="co">## 209 209 2.9342741 2.9249126          3</span></span>
<span><span class="co">## 210 210 2.3886147 2.9607946          3</span></span>
<span><span class="co">## 211 211 3.4066372 3.1685642          3</span></span>
<span><span class="co">## 212 212 3.1460331 3.4524589          3</span></span>
<span><span class="co">## 213 213 3.1272178 2.4038076          3</span></span>
<span><span class="co">## 214 214 2.5090997 3.2901521          3</span></span>
<span><span class="co">## 215 215 3.2338410 3.1214154          3</span></span>
<span><span class="co">## 216 216 3.1821068 3.3753391          3</span></span>
<span><span class="co">## 217 217 3.1984427 3.0461769          3</span></span>
<span><span class="co">## 218 218 2.9452986 2.9731589          3</span></span>
<span><span class="co">## 219 219 3.6255536 3.0621680          3</span></span>
<span><span class="co">## 220 220 3.0555659 2.5300382          3</span></span>
<span><span class="co">## 221 221 3.2489237 3.0919799          3</span></span>
<span><span class="co">## 222 222 2.7814229 2.6196570          3</span></span>
<span><span class="co">## 223 223 3.0303750 3.0238096          3</span></span>
<span><span class="co">## 224 224 2.5751567 2.8613348          3</span></span>
<span><span class="co">## 225 225 2.5982992 3.1365577          3</span></span>
<span><span class="co">## 226 226 3.0170827 3.0586300          3</span></span>
<span><span class="co">## 227 227 2.6364785 2.5016556          3</span></span>
<span><span class="co">## 228 228 3.3362844 2.7517755          3</span></span>
<span><span class="co">## 229 229 2.8321165 2.8225409          3</span></span>
<span><span class="co">## 230 230 3.2146355 2.8797882          3</span></span>
<span><span class="co">## 231 231 3.4420281 2.8392432          3</span></span>
<span><span class="co">## 232 232 2.5358856 3.0906140          3</span></span>
<span><span class="co">## 233 233 3.1036352 3.2885783          3</span></span>
<span><span class="co">## 234 234 2.5309675 2.7860577          3</span></span>
<span><span class="co">## 235 235 2.7776047 3.4559390          3</span></span>
<span><span class="co">## 236 236 3.0078860 3.4520906          3</span></span>
<span><span class="co">## 237 237 2.8130873 2.7874695          3</span></span>
<span><span class="co">## 238 238 3.2655888 2.8149989          3</span></span>
<span><span class="co">## 239 239 3.4547605 2.7512910          3</span></span>
<span><span class="co">## 240 240 3.0724875 3.2103453          3</span></span>
<span><span class="co">## 241 241 2.9853481 3.0290340          3</span></span>
<span><span class="co">## 242 242 3.1675863 3.1982829          3</span></span>
<span><span class="co">## 243 243 3.2498522 2.9857507          3</span></span>
<span><span class="co">## 244 244 3.1940424 2.4447082          3</span></span>
<span><span class="co">## 245 245 2.9661290 2.7578137          3</span></span>
<span><span class="co">## 246 246 3.4447029 3.4663193          3</span></span>
<span><span class="co">## 247 247 2.5047434 3.2155372          3</span></span>
<span><span class="co">## 248 248 3.3212748 2.6449064          3</span></span>
<span><span class="co">## 249 249 3.0298966 2.9182890          3</span></span>
<span><span class="co">## 250 250 3.1158815 2.9701552          3</span></span>
<span><span class="co">## 251 251 3.1567977 2.6369640          3</span></span>
<span><span class="co">## 252 252 2.8144704 2.7927103          3</span></span>
<span><span class="co">## 253 253 3.1637285 2.6422195          3</span></span>
<span><span class="co">## 254 254 3.5034262 3.5089439          3</span></span>
<span><span class="co">## 255 255 3.0802757 2.9813467          3</span></span>
<span><span class="co">## 256 256 2.6908065 3.3316679          3</span></span>
<span><span class="co">## 257 257 2.7242858 2.6126822          3</span></span>
<span><span class="co">## 258 258 3.2333140 3.0136000          3</span></span>
<span><span class="co">## 259 259 2.7359091 2.6478292          3</span></span>
<span><span class="co">## 260 260 3.1571434 3.1656884          3</span></span>
<span><span class="co">## 261 261 2.5164492 2.4586080          3</span></span>
<span><span class="co">## 262 262 3.1245367 2.7794705          3</span></span>
<span><span class="co">## 263 263 3.2515531 3.0552140          3</span></span>
<span><span class="co">## 264 264 3.3512803 2.4730304          3</span></span>
<span><span class="co">## 265 265 3.5762443 2.8675582          3</span></span>
<span><span class="co">## 266 266 2.8886885 3.1169958          3</span></span>
<span><span class="co">## 267 267 2.5015348 2.8367546          3</span></span>
<span><span class="co">## 268 268 3.3442126 3.0754673          3</span></span>
<span><span class="co">## 269 269 3.1350370 3.3800419          3</span></span>
<span><span class="co">## 270 270 2.9728863 3.2534819          3</span></span>
<span><span class="co">## 271 271 3.5294919 2.5435678          3</span></span>
<span><span class="co">## 272 272 2.9565621 2.7205359          3</span></span>
<span><span class="co">## 273 273 3.3275495 3.0091254          3</span></span>
<span><span class="co">## 274 274 2.5068723 2.8207366          3</span></span>
<span><span class="co">## 275 275 2.7515886 2.8463482          3</span></span>
<span><span class="co">## 276 276 3.2685897 3.5124465          3</span></span>
<span><span class="co">## 277 277 3.3792386 2.9366154          3</span></span>
<span><span class="co">## 278 278 2.7338901 2.9946934          3</span></span>
<span><span class="co">## 279 279 2.6966923 3.3913970          3</span></span>
<span><span class="co">## 280 280 2.9078201 3.3529007          3</span></span>
<span><span class="co">## 281 281 3.3265280 2.5226962          3</span></span>
<span><span class="co">## 282 282 2.7338085 3.6466376          3</span></span>
<span><span class="co">## 283 283 3.0517487 2.8330542          3</span></span>
<span><span class="co">## 284 284 3.3108583 2.9274674          3</span></span>
<span><span class="co">## 285 285 3.4100330 3.2213875          3</span></span>
<span><span class="co">## 286 286 2.8701537 3.1734770          3</span></span>
<span><span class="co">## 287 287 2.8882973 2.8565646          3</span></span>
<span><span class="co">## 288 288 2.6810788 2.9361883          3</span></span>
<span><span class="co">## 289 289 2.9144117 2.5099988          3</span></span>
<span><span class="co">## 290 290 2.5213434 2.6960218          3</span></span>
<span><span class="co">## 291 291 3.0044328 3.6875492          3</span></span>
<span><span class="co">## 292 292 3.0207895 2.9999522          3</span></span>
<span><span class="co">## 293 293 3.7529353 3.0233251          3</span></span>
<span><span class="co">## 294 294 2.6429832 3.1539783          3</span></span>
<span><span class="co">## 295 295 2.8774127 2.9546151          3</span></span>
<span><span class="co">## 296 296 2.6917573 3.2446237          3</span></span>
<span><span class="co">## 297 297 3.0219083 2.9216956          3</span></span>
<span><span class="co">## 298 298 2.7133416 2.9399786          3</span></span>
<span><span class="co">## 299 299 2.5290588 2.8336728          3</span></span>
<span><span class="co">## 300 300 2.8339630 2.9244353          3</span></span>
<span><span class="co">## 301 301 3.6827275 3.9143127          4</span></span>
<span><span class="co">## 302 302 3.6451423 3.8732027          4</span></span>
<span><span class="co">## 303 303 4.5078391 3.3695755          4</span></span>
<span><span class="co">## 304 304 4.1067610 3.7173803          4</span></span>
<span><span class="co">## 305 305 4.2717270 3.6311418          4</span></span>
<span><span class="co">## 306 306 3.5601913 3.5499961          4</span></span>
<span><span class="co">## 307 307 3.4987118 4.0345744          4</span></span>
<span><span class="co">## 308 308 3.5868712 3.6315781          4</span></span>
<span><span class="co">## 309 309 4.2734378 3.5578991          4</span></span>
<span><span class="co">## 310 310 4.0082714 4.0291610          4</span></span>
<span><span class="co">## 311 311 3.9186778 4.4257748          4</span></span>
<span><span class="co">## 312 312 4.4275275 4.0530806          4</span></span>
<span><span class="co">## 313 313 4.1948289 3.9918542          4</span></span>
<span><span class="co">## 314 314 3.7524734 3.6975072          4</span></span>
<span><span class="co">## 315 315 4.4280750 3.9421931          4</span></span>
<span><span class="co">## 316 316 3.5411473 4.2852805          4</span></span>
<span><span class="co">## 317 317 4.2930264 3.6823815          4</span></span>
<span><span class="co">## 318 318 4.1129335 3.8192652          4</span></span>
<span><span class="co">## 319 319 4.1278784 4.1323663          4</span></span>
<span><span class="co">## 320 320 4.2333228 4.1939448          4</span></span>
<span><span class="co">## 321 321 3.7322933 3.6899587          4</span></span>
<span><span class="co">## 322 322 4.4967534 3.6249355          4</span></span>
<span><span class="co">## 323 323 3.6921004 3.4484854          4</span></span>
<span><span class="co">## 324 324 3.5790849 3.7963040          4</span></span>
<span><span class="co">## 325 325 4.1668725 3.9202452          4</span></span>
<span><span class="co">## 326 326 4.3961144 4.2318955          4</span></span>
<span><span class="co">## 327 327 4.4237751 4.4406793          4</span></span>
<span><span class="co">## 328 328 4.0099167 4.3908413          4</span></span>
<span><span class="co">## 329 329 4.3734565 3.7357805          4</span></span>
<span><span class="co">## 330 330 3.6820188 3.8037643          4</span></span>
<span><span class="co">## 331 331 3.5317091 4.5738935          4</span></span>
<span><span class="co">## 332 332 3.8045617 4.2312715          4</span></span>
<span><span class="co">## 333 333 4.1512557 3.4746429          4</span></span>
<span><span class="co">## 334 334 3.8602608 4.0567404          4</span></span>
<span><span class="co">## 335 335 3.9415544 4.0419390          4</span></span>
<span><span class="co">## 336 336 3.9232192 3.9483418          4</span></span>
<span><span class="co">## 337 337 3.8137935 4.2225889          4</span></span>
<span><span class="co">## 338 338 3.7538624 4.1986128          4</span></span>
<span><span class="co">## 339 339 4.2663364 4.0637035          4</span></span>
<span><span class="co">## 340 340 3.8117509 4.0089107          4</span></span>
<span><span class="co">## 341 341 4.1448374 3.8001259          4</span></span>
<span><span class="co">## 342 342 3.4769725 4.4117039          4</span></span>
<span><span class="co">## 343 343 3.4789531 3.9947659          4</span></span>
<span><span class="co">## 344 344 3.7474825 3.6556807          4</span></span>
<span><span class="co">## 345 345 3.7612865 3.9781061          4</span></span>
<span><span class="co">## 346 346 3.4081523 4.2035435          4</span></span>
<span><span class="co">## 347 347 3.9001237 4.2866974          4</span></span>
<span><span class="co">## 348 348 4.0942516 3.9934442          4</span></span>
<span><span class="co">## 349 349 4.2131818 3.9155908          4</span></span>
<span><span class="co">## 350 350 3.3531850 4.1516174          4</span></span>
<span><span class="co">## 351 351 3.9657946 3.7860470          4</span></span>
<span><span class="co">## 352 352 3.7092893 3.9675834          4</span></span>
<span><span class="co">## 353 353 3.8241026 3.9547404          4</span></span>
<span><span class="co">## 354 354 3.7177788 4.1256941          4</span></span>
<span><span class="co">## 355 355 3.4754691 3.8876261          4</span></span>
<span><span class="co">## 356 356 4.4749792 4.0339102          4</span></span>
<span><span class="co">## 357 357 3.7922571 3.8634003          4</span></span>
<span><span class="co">## 358 358 4.1014997 3.7730194          4</span></span>
<span><span class="co">## 359 359 4.3500305 3.1640311          4</span></span>
<span><span class="co">## 360 360 4.0696820 4.2095976          4</span></span>
<span><span class="co">## 361 361 3.7055325 3.6931475          4</span></span>
<span><span class="co">## 362 362 3.9387532 4.1175573          4</span></span>
<span><span class="co">## 363 363 4.2464549 3.9905273          4</span></span>
<span><span class="co">## 364 364 4.0169749 4.1255735          4</span></span>
<span><span class="co">## 365 365 4.0801235 3.8511793          4</span></span>
<span><span class="co">## 366 366 3.9067405 3.8182578          4</span></span>
<span><span class="co">## 367 367 4.2187438 4.1539399          4</span></span>
<span><span class="co">## 368 368 3.9281208 4.5162197          4</span></span>
<span><span class="co">## 369 369 4.2422699 3.9650074          4</span></span>
<span><span class="co">## 370 370 4.2836551 4.2657522          4</span></span>
<span><span class="co">## 371 371 3.8726235 4.0272507          4</span></span>
<span><span class="co">## 372 372 3.6720589 3.7830983          4</span></span>
<span><span class="co">## 373 373 3.7512415 4.0078289          4</span></span>
<span><span class="co">## 374 374 3.7555742 4.5696159          4</span></span>
<span><span class="co">## 375 375 3.7717379 4.4006751          4</span></span>
<span><span class="co">## 376 376 3.9596750 3.3780514          4</span></span>
<span><span class="co">## 377 377 3.9030253 4.3689184          4</span></span>
<span><span class="co">## 378 378 3.9929990 4.0610642          4</span></span>
<span><span class="co">## 379 379 4.1123468 4.2379579          4</span></span>
<span><span class="co">## 380 380 4.5828190 4.2439457          4</span></span>
<span><span class="co">## 381 381 3.8151591 3.5900917          4</span></span>
<span><span class="co">## 382 382 3.9881944 3.8433819          4</span></span>
<span><span class="co">## 383 383 3.8345901 4.0470741          4</span></span>
<span><span class="co">## 384 384 4.4829795 3.6032498          4</span></span>
<span><span class="co">## 385 385 4.4819427 4.5539042          4</span></span>
<span><span class="co">## 386 386 3.9190303 3.8803203          4</span></span>
<span><span class="co">## 387 387 4.2250081 4.1633805          4</span></span>
<span><span class="co">## 388 388 3.7626860 4.8736366          4</span></span>
<span><span class="co">## 389 389 4.2178352 3.9220259          4</span></span>
<span><span class="co">## 390 390 3.9639790 3.9580201          4</span></span>
<span><span class="co">## 391 391 4.2852783 3.6561234          4</span></span>
<span><span class="co">## 392 392 4.2747956 3.8884854          4</span></span>
<span><span class="co">## 393 393 4.0458076 3.9028172          4</span></span>
<span><span class="co">## 394 394 3.9677686 4.1034577          4</span></span>
<span><span class="co">## 395 395 3.5276438 4.4403817          4</span></span>
<span><span class="co">## 396 396 3.8447032 3.8917343          4</span></span>
<span><span class="co">## 397 397 3.8593144 3.8869368          4</span></span>
<span><span class="co">## 398 398 3.8711366 4.0226513          4</span></span>
<span><span class="co">## 399 399 4.1450347 4.2901954          4</span></span>
<span><span class="co">## 400 400 4.1108677 3.8679964          4</span></span>
<span><span class="co">## 401 401 4.9457100 4.6710968          5</span></span>
<span><span class="co">## 402 402 5.3349654 5.0997240          5</span></span>
<span><span class="co">## 403 403 5.3185422 4.7448883          5</span></span>
<span><span class="co">## 404 404 4.8582681 5.3238070          5</span></span>
<span><span class="co">## 405 405 5.5390381 5.1685786          5</span></span>
<span><span class="co">## 406 406 4.9592228 4.2990718          5</span></span>
<span><span class="co">## 407 407 4.7985652 4.7411486          5</span></span>
<span><span class="co">## 408 408 5.2336508 5.3455436          5</span></span>
<span><span class="co">## 409 409 5.1522549 4.6352605          5</span></span>
<span><span class="co">## 410 410 4.3388656 4.8200015          5</span></span>
<span><span class="co">## 411 411 5.3686047 5.5392093          5</span></span>
<span><span class="co">## 412 412 4.7420224 5.1198095          5</span></span>
<span><span class="co">## 413 413 5.0544886 5.2174818          5</span></span>
<span><span class="co">## 414 414 5.1553467 5.4715098          5</span></span>
<span><span class="co">## 415 415 5.0184367 4.7908311          5</span></span>
<span><span class="co">## 416 416 5.1669496 5.2871979          5</span></span>
<span><span class="co">## 417 417 4.7695759 5.7427835          5</span></span>
<span><span class="co">## 418 418 5.3225309 4.8965442          5</span></span>
<span><span class="co">## 419 419 4.1846116 4.8569612          5</span></span>
<span><span class="co">## 420 420 5.1644572 5.5417924          5</span></span>
<span><span class="co">## 421 421 4.8333231 4.8817064          5</span></span>
<span><span class="co">## 422 422 4.7953162 4.9019264          5</span></span>
<span><span class="co">## 423 423 4.9937558 4.6519847          5</span></span>
<span><span class="co">## 424 424 5.6572280 5.1705279          5</span></span>
<span><span class="co">## 425 425 5.2224694 5.3299182          5</span></span>
<span><span class="co">## 426 426 4.4974308 4.7196690          5</span></span>
<span><span class="co">## 427 427 4.9451748 5.2857547          5</span></span>
<span><span class="co">## 428 428 5.0090737 4.7180627          5</span></span>
<span><span class="co">## 429 429 5.3140443 4.7009635          5</span></span>
<span><span class="co">## 430 430 4.9307850 4.6724667          5</span></span>
<span><span class="co">## 431 431 4.8145807 4.6249856          5</span></span>
<span><span class="co">## 432 432 5.1313323 4.7415155          5</span></span>
<span><span class="co">## 433 433 5.3837170 5.4142552          5</span></span>
<span><span class="co">## 434 434 5.4153798 5.3253147          5</span></span>
<span><span class="co">## 435 435 5.1877162 5.0582915          5</span></span>
<span><span class="co">## 436 436 5.1323347 5.3409462          5</span></span>
<span><span class="co">## 437 437 5.5028899 5.5261178          5</span></span>
<span><span class="co">## 438 438 4.8653504 4.8808507          5</span></span>
<span><span class="co">## 439 439 5.3815319 5.2185908          5</span></span>
<span><span class="co">## 440 440 5.3712985 4.7264304          5</span></span>
<span><span class="co">## 441 441 4.9631232 4.8414262          5</span></span>
<span><span class="co">## 442 442 5.1232930 5.2228696          5</span></span>
<span><span class="co">## 443 443 5.1141965 5.2977088          5</span></span>
<span><span class="co">## 444 444 5.3747529 4.4409490          5</span></span>
<span><span class="co">## 445 445 5.3281578 4.7584600          5</span></span>
<span><span class="co">## 446 446 4.9625295 4.4318370          5</span></span>
<span><span class="co">## 447 447 5.2580186 5.1313763          5</span></span>
<span><span class="co">## 448 448 5.2872071 5.0705238          5</span></span>
<span><span class="co">## 449 449 4.6258888 5.6229670          5</span></span>
<span><span class="co">## 450 450 5.0562624 4.8468164          5</span></span>
<span><span class="co">## 451 451 4.7147723 5.0579952          5</span></span>
<span><span class="co">## 452 452 5.4318983 4.8251189          5</span></span>
<span><span class="co">## 453 453 4.9025356 5.0088127          5</span></span>
<span><span class="co">## 454 454 4.2304833 5.0741650          5</span></span>
<span><span class="co">## 455 455 4.4655376 4.8001240          5</span></span>
<span><span class="co">## 456 456 4.8839557 5.6193508          5</span></span>
<span><span class="co">## 457 457 5.1039849 5.5942051          5</span></span>
<span><span class="co">## 458 458 4.7506100 5.2773516          5</span></span>
<span><span class="co">## 459 459 4.8552875 5.2283270          5</span></span>
<span><span class="co">## 460 460 4.6988891 4.4607288          5</span></span>
<span><span class="co">## 461 461 5.4835504 4.8497529          5</span></span>
<span><span class="co">## 462 462 4.3234961 4.7025539          5</span></span>
<span><span class="co">## 463 463 4.8673869 5.1772804          5</span></span>
<span><span class="co">## 464 464 4.8918910 4.9039878          5</span></span>
<span><span class="co">## 465 465 5.0821512 5.0894679          5</span></span>
<span><span class="co">## 466 466 4.9149197 4.7890772          5</span></span>
<span><span class="co">## 467 467 5.2058784 5.5306713          5</span></span>
<span><span class="co">## 468 468 5.0256259 4.5104337          5</span></span>
<span><span class="co">## 469 469 4.8418064 4.4913246          5</span></span>
<span><span class="co">## 470 470 5.3210492 5.1454600          5</span></span>
<span><span class="co">## 471 471 5.3694261 5.3370361          5</span></span>
<span><span class="co">## 472 472 4.8703886 4.2149139          5</span></span>
<span><span class="co">## 473 473 4.8897906 4.7509414          5</span></span>
<span><span class="co">## 474 474 4.9916760 5.2338352          5</span></span>
<span><span class="co">## 475 475 5.3419165 4.9968641          5</span></span>
<span><span class="co">## 476 476 5.2020340 4.9727372          5</span></span>
<span><span class="co">## 477 477 5.0339331 5.3658228          5</span></span>
<span><span class="co">## 478 478 4.7719437 5.0154828          5</span></span>
<span><span class="co">## 479 479 5.0017508 5.1136895          5</span></span>
<span><span class="co">## 480 480 5.5456673 5.6435130          5</span></span>
<span><span class="co">## 481 481 4.2678764 4.8866338          5</span></span>
<span><span class="co">## 482 482 4.8606806 4.8883353          5</span></span>
<span><span class="co">## 483 483 5.3373415 5.0236280          5</span></span>
<span><span class="co">## 484 484 4.8347445 5.6367827          5</span></span>
<span><span class="co">## 485 485 5.0965512 5.1914834          5</span></span>
<span><span class="co">## 486 486 4.9391667 4.8967730          5</span></span>
<span><span class="co">## 487 487 5.2770300 5.1900489          5</span></span>
<span><span class="co">## 488 488 5.1307704 4.5772297          5</span></span>
<span><span class="co">## 489 489 4.7141706 4.9212947          5</span></span>
<span><span class="co">## 490 490 4.5748958 5.1520131          5</span></span>
<span><span class="co">## 491 491 5.1036948 4.9735734          5</span></span>
<span><span class="co">## 492 492 4.9029354 4.7587856          5</span></span>
<span><span class="co">## 493 493 5.0619552 5.2915141          5</span></span>
<span><span class="co">## 494 494 4.7955937 4.8325474          5</span></span>
<span><span class="co">## 495 495 4.6351913 5.3527271          5</span></span>
<span><span class="co">## 496 496 4.6741199 4.9844760          5</span></span>
<span><span class="co">## 497 497 5.3324965 4.9279474          5</span></span>
<span><span class="co">## 498 498 4.8868725 4.7749906          5</span></span>
<span><span class="co">## 499 499 5.3359997 5.0423805          5</span></span>
<span><span class="co">## 500 500 5.0358797 5.4614423          5</span></span></code></pre>
<p>This is how our data looks like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now we can cluster it using kmeans++:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_for_clust</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data_for_clust</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## id column: id</span></span></code></pre>
<pre><code><span><span class="co">## KMEans: will generate seeds</span></span>
<span><span class="co">## KMeans into generate seeds</span></span>
<span><span class="co">## at seed 0</span></span>
<span><span class="co">## add new core from 445 to 0</span></span>
<span><span class="co">## at seed 1</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 350 450</span></span>
<span><span class="co">## picked up 7 dist was 2.73477</span></span>
<span><span class="co">## add new core from 7 to 1</span></span>
<span><span class="co">## at seed 2</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 300 400</span></span>
<span><span class="co">## picked up 268 dist was 1.11354</span></span>
<span><span class="co">## add new core from 268 to 2</span></span>
<span><span class="co">## at seed 3</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 250 350</span></span>
<span><span class="co">## picked up 146 dist was 0.767924</span></span>
<span><span class="co">## add new core from 146 to 3</span></span>
<span><span class="co">## at seed 4</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 200 300</span></span>
<span><span class="co">## picked up 395 dist was 0.516288</span></span>
<span><span class="co">## add new core from 395 to 4</span></span>
<span><span class="co">## KMEans: reassign after init</span></span>
<span><span class="co">## KMEans: iter 0</span></span>
<span><span class="co">## KMEans: iter 1 changed 6</span></span>
<span><span class="co">## KMEans: iter 1</span></span>
<span><span class="co">## KMEans: iter 2 changed 1</span></span>
<span><span class="co">## KMEans: iter 2</span></span>
<span><span class="co">## KMEans: iter 3 changed 1</span></span>
<span><span class="co">## KMEans: iter 3</span></span>
<span><span class="co">## KMEans: iter 4 changed 0</span></span></code></pre>
<p>The returned list contains 3 fields:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">km</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "centers" "cluster" "size"</span></span></code></pre>
<p><code>km$centers</code> contains a tibble with <code>clust</code> column and the cluster centers:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 5.01  5.02 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2 3.96  3.98 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3 1.99  1.96 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4 0.952 0.948</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5 3.00  2.96</span></span></code></pre>
<p>clusters are numbered according to <code>order_func</code> (see ‘Custom cluster ordering’ section).</p>
<p><code>km$cluster</code> contains tibble with <code>id</code> column with the observation id (<code>1:n</code> if no id column was supplied), and <code>clust</code> column with the observation assigned cluster:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">cluster</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 500 × 2</span></span></span>
<span><span class="co">##    id    clust</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 2         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 5         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 6         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 7         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 8         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 9         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 10        4</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre>
<p><code>km$size</code> contains tibble with <code>clust</code> column and <code>n</code> column with the number of points in each cluster:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">size</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">##   clust     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1   101</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4    99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5   100</span></span></code></pre>
<p>We can now check our clustering performance - fraction of observations that were classified correctly (Note that <code>match_clusters</code> function is internal to the package and is used only in this vignette):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.988</span></span></code></pre>
<p>And plot the results:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="custom-cluster-ordering">Custom cluster ordering<a class="anchor" aria-label="anchor" href="#custom-cluster-ordering"></a>
</h2>
<p>By default, the clusters where ordered using the following function: <code>hclust(dist(cor(t(centers))))</code> - hclust of the euclidean distance of the correlation matrix of the centers.</p>
<p>We can supply our own function to order the clusters using <code>reorder_func</code> argument. The function would be applied to each center and he clusters would be ordered by the result.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    reorder_func <span class="op">=</span> <span class="va">median</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 0.952 0.948</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2 1.99  1.96 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3 3.00  2.96 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4 3.96  3.98 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5 5.01  5.02</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>tglkmeans can deal with missing data, as long as at least one dimension is not missing. for example:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1        NA 0.8901407          1</span></span>
<span><span class="co">## 2     2 0.9397869 0.9131388          1</span></span>
<span><span class="co">## 3     3 1.1809664 0.4672072          1</span></span>
<span><span class="co">## 4     4 1.4292573 0.5436311          1</span></span>
<span><span class="co">## 5     5 1.2596318 0.2413431          1</span></span>
<span><span class="co">## 6     6 0.7151423 0.7210814          1</span></span>
<span><span class="co">## 7     7 0.8884853 1.1352640          1</span></span>
<span><span class="co">## 8     8 0.7950018 1.1187463          1</span></span>
<span><span class="co">## 9     9 0.8690248 0.4504063          1</span></span>
<span><span class="co">## 10   10 0.6357113 0.9715179          1</span></span>
<span><span class="co">## 11   11 0.9000577 1.2805444          1</span></span>
<span><span class="co">## 12   12        NA 0.6156472          1</span></span>
<span><span class="co">## 13   13 1.4366340 1.0545479          1</span></span>
<span><span class="co">## 14   14        NA 1.2562131          1</span></span>
<span><span class="co">## 15   15        NA 1.2575146          1</span></span>
<span><span class="co">## 16   16 0.6130055 1.1904492          1</span></span>
<span><span class="co">## 17   17 1.1835260 1.2417895          1</span></span>
<span><span class="co">## 18   18 0.9506597 1.1431190          1</span></span>
<span><span class="co">## 19   19 1.1844314 1.0518474          1</span></span>
<span><span class="co">## 20   20 1.2355932 1.2807134          1</span></span>
<span><span class="co">## 21   21 0.8570776 0.7379783          1</span></span>
<span><span class="co">## 22   22 0.4053151 1.3345618          1</span></span>
<span><span class="co">## 23   23 0.4636049 0.7165247          1</span></span>
<span><span class="co">## 24   24 0.5373783 1.0177528          1</span></span>
<span><span class="co">## 25   25 1.2278081 1.1435106          1</span></span>
<span><span class="co">## 26   26 1.1913541 1.0906512          1</span></span>
<span><span class="co">## 27   27 1.1720428 1.4386357          1</span></span>
<span><span class="co">## 28   28 1.2248446 0.9125590          1</span></span>
<span><span class="co">## 29   29 0.9941577 1.2716917          1</span></span>
<span><span class="co">## 30   30 0.5898527 0.9275008          1</span></span>
<span><span class="co">## 31   31 0.3510941 0.9855369          1</span></span>
<span><span class="co">## 32   32 0.7980975 1.1412251          1</span></span>
<span><span class="co">## 33   33 0.9440323 0.7440647          1</span></span>
<span><span class="co">## 34   34        NA 1.6240801          1</span></span>
<span><span class="co">## 35   35 1.2414055 0.5266514          1</span></span>
<span><span class="co">## 36   36        NA 0.7442030          1</span></span>
<span><span class="co">## 37   37 0.7600531 0.5761380          1</span></span>
<span><span class="co">## 38   38 0.7945392 0.8946354          1</span></span>
<span><span class="co">## 39   39 0.7022760 0.6940815          1</span></span>
<span><span class="co">## 40   40        NA 0.6235157          1</span></span>
<span><span class="co">## 41   41 1.0284872 0.8775284          1</span></span>
<span><span class="co">## 42   42 1.0352253 0.8710146          1</span></span>
<span><span class="co">## 43   43 1.1060478 0.4315174          1</span></span>
<span><span class="co">## 44   44 0.9791098 0.7284765          1</span></span>
<span><span class="co">## 45   45 0.7899155 0.9785046          1</span></span>
<span><span class="co">## 46   46        NA 0.5739655          1</span></span>
<span><span class="co">## 47   47 1.4455441 1.0285549          1</span></span>
<span><span class="co">## 48   48 0.5880953 0.9597077          1</span></span>
<span><span class="co">## 49   49 1.2522732 0.9665366          1</span></span>
<span><span class="co">## 50   50 0.8333133 0.8287706          1</span></span>
<span><span class="co">## 51   51 0.6653892 1.3618898          1</span></span>
<span><span class="co">## 52   52        NA 1.1310143          1</span></span>
<span><span class="co">## 53   53        NA 1.2772413          1</span></span>
<span><span class="co">## 54   54 0.8931158 1.2921937          1</span></span>
<span><span class="co">## 55   55        NA 0.5846358          1</span></span>
<span><span class="co">## 56   56        NA 1.0278849          1</span></span>
<span><span class="co">## 57   57 1.1820735 1.0146473          1</span></span>
<span><span class="co">## 58   58 0.7237688 1.4774062          1</span></span>
<span><span class="co">## 59   59 0.9076580 0.8193090          1</span></span>
<span><span class="co">## 60   60 0.8088752 0.6154539          1</span></span>
<span><span class="co">## 61   61 1.0404385 1.1320746          1</span></span>
<span><span class="co">## 62   62 0.3177934 1.1419999          1</span></span>
<span><span class="co">## 63   63 1.4013021 0.9802873          1</span></span>
<span><span class="co">## 64   64        NA 0.9890521          1</span></span>
<span><span class="co">## 65   65 1.0870802 1.5227485          1</span></span>
<span><span class="co">## 66   66        NA 1.6313094          1</span></span>
<span><span class="co">## 67   67 0.4766740 1.1755215          1</span></span>
<span><span class="co">## 68   68 0.9305353 0.9386070          1</span></span>
<span><span class="co">## 69   69 0.7532836 0.8747611          1</span></span>
<span><span class="co">## 70   70 0.9370037 0.7618708          1</span></span>
<span><span class="co">## 71   71 0.8397674 1.2007583          1</span></span>
<span><span class="co">## 72   72 0.9238208 0.5452316          1</span></span>
<span><span class="co">## 73   73        NA 1.2708313          1</span></span>
<span><span class="co">## 74   74 0.4977256 0.8563626          1</span></span>
<span><span class="co">## 75   75 0.8549983 0.7741227          1</span></span>
<span><span class="co">## 76   76 1.1704810 0.4946855          1</span></span>
<span><span class="co">## 77   77 0.9162371 0.6329495          1</span></span>
<span><span class="co">## 78   78        NA 0.5230634          1</span></span>
<span><span class="co">## 79   79 0.7460989 0.4275599          1</span></span>
<span><span class="co">## 80   80 0.3638633 0.7987698          1</span></span>
<span><span class="co">## 81   81 0.6318527 0.9165657          1</span></span>
<span><span class="co">## 82   82 1.6152692 1.4224224          1</span></span>
<span><span class="co">## 83   83 0.6978724 1.0889629          1</span></span>
<span><span class="co">## 84   84 0.7447581 0.5610648          1</span></span>
<span><span class="co">## 85   85 1.2139032 1.0594453          1</span></span>
<span><span class="co">## 86   86        NA 1.3067910          1</span></span>
<span><span class="co">## 87   87 0.7923500 1.2111718          1</span></span>
<span><span class="co">## 88   88 1.4411077 0.9895184          1</span></span>
<span><span class="co">## 89   89 1.0737991 0.8694432          1</span></span>
<span><span class="co">## 90   90 0.8694068 1.4964493          1</span></span>
<span><span class="co">## 91   91 0.3885946 0.8752887          1</span></span>
<span><span class="co">## 92   92        NA 0.6048284          1</span></span>
<span><span class="co">## 93   93 1.2501683 0.3574455          1</span></span>
<span><span class="co">## 94   94        NA 1.3606872          1</span></span>
<span><span class="co">## 95   95 1.3267792 0.6413599          1</span></span>
<span><span class="co">## 96   96 1.0940570 0.7259493          1</span></span>
<span><span class="co">## 97   97 1.2448649 1.0849730          1</span></span>
<span><span class="co">## 98   98 1.1569162 0.8200929          1</span></span>
<span><span class="co">## 99   99 1.1379620 1.3875872          1</span></span>
<span><span class="co">## 100 100 1.0565823 0.9511343          1</span></span>
<span><span class="co">## 101 101 1.6416216 1.6828977          2</span></span>
<span><span class="co">## 102 102        NA 2.2125773          2</span></span>
<span><span class="co">## 103 103 1.4947234 2.0589632          2</span></span>
<span><span class="co">## 104 104 1.5932699 2.4656596          2</span></span>
<span><span class="co">## 105 105        NA 2.4574327          2</span></span>
<span><span class="co">## 106 106 2.3313391 2.5108229          2</span></span>
<span><span class="co">## 107 107 1.6614988 2.5705861          2</span></span>
<span><span class="co">## 108 108        NA 1.4231406          2</span></span>
<span><span class="co">## 109 109        NA 2.5595931          2</span></span>
<span><span class="co">## 110 110 2.0899348 2.1322522          2</span></span>
<span><span class="co">## 111 111 1.6631189 2.4167389          2</span></span>
<span><span class="co">## 112 112        NA 2.1704974          2</span></span>
<span><span class="co">## 113 113 1.6753682 1.4924698          2</span></span>
<span><span class="co">## 114 114 2.1241447 1.5642625          2</span></span>
<span><span class="co">## 115 115 1.8151511 1.9170639          2</span></span>
<span><span class="co">## 116 116 2.2544943 1.8265669          2</span></span>
<span><span class="co">## 117 117 2.4208950 1.8593799          2</span></span>
<span><span class="co">## 118 118 1.9786677 1.7520775          2</span></span>
<span><span class="co">## 119 119 2.2372721 1.5055899          2</span></span>
<span><span class="co">## 120 120 2.4838427 1.7996151          2</span></span>
<span><span class="co">## 121 121 2.0613878 1.3385585          2</span></span>
<span><span class="co">## 122 122 1.7240434 1.9695839          2</span></span>
<span><span class="co">## 123 123 2.7044538 1.5063201          2</span></span>
<span><span class="co">## 124 124 1.8954359 1.4132558          2</span></span>
<span><span class="co">## 125 125        NA 1.9647875          2</span></span>
<span><span class="co">## 126 126 1.4339560 2.2161246          2</span></span>
<span><span class="co">## 127 127 2.0551036 1.9945926          2</span></span>
<span><span class="co">## 128 128 2.2422182 2.0302269          2</span></span>
<span><span class="co">## 129 129        NA 2.0671875          2</span></span>
<span><span class="co">## 130 130 1.7048198 2.2226269          2</span></span>
<span><span class="co">## 131 131 1.5576361 2.2794209          2</span></span>
<span><span class="co">## 132 132 2.2415996 2.1610902          2</span></span>
<span><span class="co">## 133 133        NA 1.2212559          2</span></span>
<span><span class="co">## 134 134 1.7169240 1.9998300          2</span></span>
<span><span class="co">## 135 135        NA 1.5301805          2</span></span>
<span><span class="co">## 136 136 2.1605979 1.4866680          2</span></span>
<span><span class="co">## 137 137 2.4336286 1.2961107          2</span></span>
<span><span class="co">## 138 138 2.1522741 1.8020930          2</span></span>
<span><span class="co">## 139 139 1.7725645 1.7136550          2</span></span>
<span><span class="co">## 140 140 2.0001988 1.8948502          2</span></span>
<span><span class="co">## 141 141 2.7241006 1.9873009          2</span></span>
<span><span class="co">## 142 142        NA 1.7081804          2</span></span>
<span><span class="co">## 143 143 1.8723639 1.6053945          2</span></span>
<span><span class="co">## 144 144 2.1072140 1.8091032          2</span></span>
<span><span class="co">## 145 145 2.2936213 2.1687568          2</span></span>
<span><span class="co">## 146 146 2.2043625 2.4514877          2</span></span>
<span><span class="co">## 147 147        NA 2.4158670          2</span></span>
<span><span class="co">## 148 148 2.2334881 2.4615828          2</span></span>
<span><span class="co">## 149 149 1.7834150 2.4378427          2</span></span>
<span><span class="co">## 150 150 1.8272180 2.1571475          2</span></span>
<span><span class="co">## 151 151 2.1738078 1.6600999          2</span></span>
<span><span class="co">## 152 152 2.4365192 1.8413524          2</span></span>
<span><span class="co">## 153 153 1.7927813 2.1444888          2</span></span>
<span><span class="co">## 154 154 1.8975729 2.0878644          2</span></span>
<span><span class="co">## 155 155 1.1603959 1.7239607          2</span></span>
<span><span class="co">## 156 156 1.7583913 1.7751672          2</span></span>
<span><span class="co">## 157 157 2.2760671 1.9737002          2</span></span>
<span><span class="co">## 158 158        NA 2.1844034          2</span></span>
<span><span class="co">## 159 159 2.2053458 2.2911432          2</span></span>
<span><span class="co">## 160 160 1.9851161 1.6441387          2</span></span>
<span><span class="co">## 161 161 2.1008578 1.6761701          2</span></span>
<span><span class="co">## 162 162 1.8272071 2.0604697          2</span></span>
<span><span class="co">## 163 163 1.2923658 2.1755957          2</span></span>
<span><span class="co">## 164 164        NA 2.3951215          2</span></span>
<span><span class="co">## 165 165 2.2749796 1.8571944          2</span></span>
<span><span class="co">## 166 166        NA 2.0123586          2</span></span>
<span><span class="co">## 167 167 2.3061893 1.8365463          2</span></span>
<span><span class="co">## 168 168 2.4120947 2.3642072          2</span></span>
<span><span class="co">## 169 169 2.4215307 2.3055680          2</span></span>
<span><span class="co">## 170 170 1.9749919 1.8675248          2</span></span>
<span><span class="co">## 171 171 2.8527492 2.1584536          2</span></span>
<span><span class="co">## 172 172 1.6851311 1.5629254          2</span></span>
<span><span class="co">## 173 173 1.8517314 2.0980886          2</span></span>
<span><span class="co">## 174 174 1.8782458 2.0736759          2</span></span>
<span><span class="co">## 175 175 1.9883913 1.6019185          2</span></span>
<span><span class="co">## 176 176 2.1570711 2.1786492          2</span></span>
<span><span class="co">## 177 177        NA 2.0186447          2</span></span>
<span><span class="co">## 178 178 1.8779004 1.7952421          2</span></span>
<span><span class="co">## 179 179 2.0293495 2.6718543          2</span></span>
<span><span class="co">## 180 180 1.5396571 2.3480480          2</span></span>
<span><span class="co">## 181 181 2.1121541 1.9987047          2</span></span>
<span><span class="co">## 182 182        NA 1.6964449          2</span></span>
<span><span class="co">## 183 183 1.8810873 1.6201371          2</span></span>
<span><span class="co">## 184 184 2.1664888 2.0304742          2</span></span>
<span><span class="co">## 185 185 1.6449955 2.8446532          2</span></span>
<span><span class="co">## 186 186 2.3458794 2.2354540          2</span></span>
<span><span class="co">## 187 187        NA 1.8893014          2</span></span>
<span><span class="co">## 188 188        NA 1.5441471          2</span></span>
<span><span class="co">## 189 189 2.4306306 2.2458746          2</span></span>
<span><span class="co">## 190 190 1.5520431 2.4467210          2</span></span>
<span><span class="co">## 191 191 2.5497076 1.4227117          2</span></span>
<span><span class="co">## 192 192 2.4628584 1.7974234          2</span></span>
<span><span class="co">## 193 193 1.6500536 1.6134059          2</span></span>
<span><span class="co">## 194 194 1.9664335 1.8358849          2</span></span>
<span><span class="co">## 195 195 1.8149487 1.7343726          2</span></span>
<span><span class="co">## 196 196 2.3165582 1.6119428          2</span></span>
<span><span class="co">## 197 197        NA 2.0834805          2</span></span>
<span><span class="co">## 198 198 1.8363199 1.8298996          2</span></span>
<span><span class="co">## 199 199 1.9900491 2.0167937          2</span></span>
<span><span class="co">## 200 200 1.7365051 2.0967882          2</span></span>
<span><span class="co">## 201 201 3.0995097 3.1327280          3</span></span>
<span><span class="co">## 202 202 2.7698552 3.4792139          3</span></span>
<span><span class="co">## 203 203 3.0557657 2.8916042          3</span></span>
<span><span class="co">## 204 204 2.9834171 2.7812550          3</span></span>
<span><span class="co">## 205 205        NA 3.0028620          3</span></span>
<span><span class="co">## 206 206 3.5529338 2.8174249          3</span></span>
<span><span class="co">## 207 207 3.1145937 2.9296861          3</span></span>
<span><span class="co">## 208 208 3.0276545 2.7030419          3</span></span>
<span><span class="co">## 209 209 2.9342741 2.9249126          3</span></span>
<span><span class="co">## 210 210 2.3886147 2.9607946          3</span></span>
<span><span class="co">## 211 211 3.4066372 3.1685642          3</span></span>
<span><span class="co">## 212 212 3.1460331 3.4524589          3</span></span>
<span><span class="co">## 213 213 3.1272178 2.4038076          3</span></span>
<span><span class="co">## 214 214 2.5090997 3.2901521          3</span></span>
<span><span class="co">## 215 215 3.2338410 3.1214154          3</span></span>
<span><span class="co">## 216 216 3.1821068 3.3753391          3</span></span>
<span><span class="co">## 217 217 3.1984427 3.0461769          3</span></span>
<span><span class="co">## 218 218 2.9452986 2.9731589          3</span></span>
<span><span class="co">## 219 219 3.6255536 3.0621680          3</span></span>
<span><span class="co">## 220 220 3.0555659 2.5300382          3</span></span>
<span><span class="co">## 221 221 3.2489237 3.0919799          3</span></span>
<span><span class="co">## 222 222 2.7814229 2.6196570          3</span></span>
<span><span class="co">## 223 223 3.0303750 3.0238096          3</span></span>
<span><span class="co">## 224 224 2.5751567 2.8613348          3</span></span>
<span><span class="co">## 225 225        NA 3.1365577          3</span></span>
<span><span class="co">## 226 226 3.0170827 3.0586300          3</span></span>
<span><span class="co">## 227 227 2.6364785 2.5016556          3</span></span>
<span><span class="co">## 228 228 3.3362844 2.7517755          3</span></span>
<span><span class="co">## 229 229 2.8321165 2.8225409          3</span></span>
<span><span class="co">## 230 230        NA 2.8797882          3</span></span>
<span><span class="co">## 231 231 3.4420281 2.8392432          3</span></span>
<span><span class="co">## 232 232        NA 3.0906140          3</span></span>
<span><span class="co">## 233 233 3.1036352 3.2885783          3</span></span>
<span><span class="co">## 234 234 2.5309675 2.7860577          3</span></span>
<span><span class="co">## 235 235 2.7776047 3.4559390          3</span></span>
<span><span class="co">## 236 236 3.0078860 3.4520906          3</span></span>
<span><span class="co">## 237 237 2.8130873 2.7874695          3</span></span>
<span><span class="co">## 238 238        NA 2.8149989          3</span></span>
<span><span class="co">## 239 239 3.4547605 2.7512910          3</span></span>
<span><span class="co">## 240 240 3.0724875 3.2103453          3</span></span>
<span><span class="co">## 241 241        NA 3.0290340          3</span></span>
<span><span class="co">## 242 242 3.1675863 3.1982829          3</span></span>
<span><span class="co">## 243 243 3.2498522 2.9857507          3</span></span>
<span><span class="co">## 244 244 3.1940424 2.4447082          3</span></span>
<span><span class="co">## 245 245 2.9661290 2.7578137          3</span></span>
<span><span class="co">## 246 246 3.4447029 3.4663193          3</span></span>
<span><span class="co">## 247 247 2.5047434 3.2155372          3</span></span>
<span><span class="co">## 248 248 3.3212748 2.6449064          3</span></span>
<span><span class="co">## 249 249 3.0298966 2.9182890          3</span></span>
<span><span class="co">## 250 250 3.1158815 2.9701552          3</span></span>
<span><span class="co">## 251 251 3.1567977 2.6369640          3</span></span>
<span><span class="co">## 252 252 2.8144704 2.7927103          3</span></span>
<span><span class="co">## 253 253 3.1637285 2.6422195          3</span></span>
<span><span class="co">## 254 254 3.5034262 3.5089439          3</span></span>
<span><span class="co">## 255 255 3.0802757 2.9813467          3</span></span>
<span><span class="co">## 256 256 2.6908065 3.3316679          3</span></span>
<span><span class="co">## 257 257 2.7242858 2.6126822          3</span></span>
<span><span class="co">## 258 258 3.2333140 3.0136000          3</span></span>
<span><span class="co">## 259 259 2.7359091 2.6478292          3</span></span>
<span><span class="co">## 260 260        NA 3.1656884          3</span></span>
<span><span class="co">## 261 261 2.5164492 2.4586080          3</span></span>
<span><span class="co">## 262 262        NA 2.7794705          3</span></span>
<span><span class="co">## 263 263 3.2515531 3.0552140          3</span></span>
<span><span class="co">## 264 264 3.3512803 2.4730304          3</span></span>
<span><span class="co">## 265 265 3.5762443 2.8675582          3</span></span>
<span><span class="co">## 266 266        NA 3.1169958          3</span></span>
<span><span class="co">## 267 267        NA 2.8367546          3</span></span>
<span><span class="co">## 268 268        NA 3.0754673          3</span></span>
<span><span class="co">## 269 269        NA 3.3800419          3</span></span>
<span><span class="co">## 270 270 2.9728863 3.2534819          3</span></span>
<span><span class="co">## 271 271 3.5294919 2.5435678          3</span></span>
<span><span class="co">## 272 272 2.9565621 2.7205359          3</span></span>
<span><span class="co">## 273 273 3.3275495 3.0091254          3</span></span>
<span><span class="co">## 274 274 2.5068723 2.8207366          3</span></span>
<span><span class="co">## 275 275 2.7515886 2.8463482          3</span></span>
<span><span class="co">## 276 276 3.2685897 3.5124465          3</span></span>
<span><span class="co">## 277 277        NA 2.9366154          3</span></span>
<span><span class="co">## 278 278 2.7338901 2.9946934          3</span></span>
<span><span class="co">## 279 279 2.6966923 3.3913970          3</span></span>
<span><span class="co">## 280 280 2.9078201 3.3529007          3</span></span>
<span><span class="co">## 281 281 3.3265280 2.5226962          3</span></span>
<span><span class="co">## 282 282 2.7338085 3.6466376          3</span></span>
<span><span class="co">## 283 283        NA 2.8330542          3</span></span>
<span><span class="co">## 284 284 3.3108583 2.9274674          3</span></span>
<span><span class="co">## 285 285 3.4100330 3.2213875          3</span></span>
<span><span class="co">## 286 286 2.8701537 3.1734770          3</span></span>
<span><span class="co">## 287 287 2.8882973 2.8565646          3</span></span>
<span><span class="co">## 288 288 2.6810788 2.9361883          3</span></span>
<span><span class="co">## 289 289 2.9144117 2.5099988          3</span></span>
<span><span class="co">## 290 290        NA 2.6960218          3</span></span>
<span><span class="co">## 291 291 3.0044328 3.6875492          3</span></span>
<span><span class="co">## 292 292 3.0207895 2.9999522          3</span></span>
<span><span class="co">## 293 293 3.7529353 3.0233251          3</span></span>
<span><span class="co">## 294 294 2.6429832 3.1539783          3</span></span>
<span><span class="co">## 295 295 2.8774127 2.9546151          3</span></span>
<span><span class="co">## 296 296 2.6917573 3.2446237          3</span></span>
<span><span class="co">## 297 297 3.0219083 2.9216956          3</span></span>
<span><span class="co">## 298 298 2.7133416 2.9399786          3</span></span>
<span><span class="co">## 299 299 2.5290588 2.8336728          3</span></span>
<span><span class="co">## 300 300 2.8339630 2.9244353          3</span></span>
<span><span class="co">## 301 301 3.6827275 3.9143127          4</span></span>
<span><span class="co">## 302 302 3.6451423 3.8732027          4</span></span>
<span><span class="co">## 303 303 4.5078391 3.3695755          4</span></span>
<span><span class="co">## 304 304 4.1067610 3.7173803          4</span></span>
<span><span class="co">## 305 305 4.2717270 3.6311418          4</span></span>
<span><span class="co">## 306 306 3.5601913 3.5499961          4</span></span>
<span><span class="co">## 307 307 3.4987118 4.0345744          4</span></span>
<span><span class="co">## 308 308 3.5868712 3.6315781          4</span></span>
<span><span class="co">## 309 309 4.2734378 3.5578991          4</span></span>
<span><span class="co">## 310 310 4.0082714 4.0291610          4</span></span>
<span><span class="co">## 311 311        NA 4.4257748          4</span></span>
<span><span class="co">## 312 312        NA 4.0530806          4</span></span>
<span><span class="co">## 313 313        NA 3.9918542          4</span></span>
<span><span class="co">## 314 314 3.7524734 3.6975072          4</span></span>
<span><span class="co">## 315 315        NA 3.9421931          4</span></span>
<span><span class="co">## 316 316        NA 4.2852805          4</span></span>
<span><span class="co">## 317 317        NA 3.6823815          4</span></span>
<span><span class="co">## 318 318 4.1129335 3.8192652          4</span></span>
<span><span class="co">## 319 319 4.1278784 4.1323663          4</span></span>
<span><span class="co">## 320 320        NA 4.1939448          4</span></span>
<span><span class="co">## 321 321 3.7322933 3.6899587          4</span></span>
<span><span class="co">## 322 322 4.4967534 3.6249355          4</span></span>
<span><span class="co">## 323 323 3.6921004 3.4484854          4</span></span>
<span><span class="co">## 324 324 3.5790849 3.7963040          4</span></span>
<span><span class="co">## 325 325        NA 3.9202452          4</span></span>
<span><span class="co">## 326 326 4.3961144 4.2318955          4</span></span>
<span><span class="co">## 327 327 4.4237751 4.4406793          4</span></span>
<span><span class="co">## 328 328        NA 4.3908413          4</span></span>
<span><span class="co">## 329 329 4.3734565 3.7357805          4</span></span>
<span><span class="co">## 330 330        NA 3.8037643          4</span></span>
<span><span class="co">## 331 331 3.5317091 4.5738935          4</span></span>
<span><span class="co">## 332 332        NA 4.2312715          4</span></span>
<span><span class="co">## 333 333 4.1512557 3.4746429          4</span></span>
<span><span class="co">## 334 334 3.8602608 4.0567404          4</span></span>
<span><span class="co">## 335 335 3.9415544 4.0419390          4</span></span>
<span><span class="co">## 336 336 3.9232192 3.9483418          4</span></span>
<span><span class="co">## 337 337 3.8137935 4.2225889          4</span></span>
<span><span class="co">## 338 338 3.7538624 4.1986128          4</span></span>
<span><span class="co">## 339 339 4.2663364 4.0637035          4</span></span>
<span><span class="co">## 340 340 3.8117509 4.0089107          4</span></span>
<span><span class="co">## 341 341 4.1448374 3.8001259          4</span></span>
<span><span class="co">## 342 342 3.4769725 4.4117039          4</span></span>
<span><span class="co">## 343 343 3.4789531 3.9947659          4</span></span>
<span><span class="co">## 344 344 3.7474825 3.6556807          4</span></span>
<span><span class="co">## 345 345 3.7612865 3.9781061          4</span></span>
<span><span class="co">## 346 346 3.4081523 4.2035435          4</span></span>
<span><span class="co">## 347 347 3.9001237 4.2866974          4</span></span>
<span><span class="co">## 348 348        NA 3.9934442          4</span></span>
<span><span class="co">## 349 349 4.2131818 3.9155908          4</span></span>
<span><span class="co">## 350 350 3.3531850 4.1516174          4</span></span>
<span><span class="co">## 351 351        NA 3.7860470          4</span></span>
<span><span class="co">## 352 352 3.7092893 3.9675834          4</span></span>
<span><span class="co">## 353 353        NA 3.9547404          4</span></span>
<span><span class="co">## 354 354        NA 4.1256941          4</span></span>
<span><span class="co">## 355 355        NA 3.8876261          4</span></span>
<span><span class="co">## 356 356 4.4749792 4.0339102          4</span></span>
<span><span class="co">## 357 357        NA 3.8634003          4</span></span>
<span><span class="co">## 358 358 4.1014997 3.7730194          4</span></span>
<span><span class="co">## 359 359 4.3500305 3.1640311          4</span></span>
<span><span class="co">## 360 360 4.0696820 4.2095976          4</span></span>
<span><span class="co">## 361 361 3.7055325 3.6931475          4</span></span>
<span><span class="co">## 362 362 3.9387532 4.1175573          4</span></span>
<span><span class="co">## 363 363 4.2464549 3.9905273          4</span></span>
<span><span class="co">## 364 364 4.0169749 4.1255735          4</span></span>
<span><span class="co">## 365 365 4.0801235 3.8511793          4</span></span>
<span><span class="co">## 366 366 3.9067405 3.8182578          4</span></span>
<span><span class="co">## 367 367 4.2187438 4.1539399          4</span></span>
<span><span class="co">## 368 368        NA 4.5162197          4</span></span>
<span><span class="co">## 369 369 4.2422699 3.9650074          4</span></span>
<span><span class="co">## 370 370        NA 4.2657522          4</span></span>
<span><span class="co">## 371 371 3.8726235 4.0272507          4</span></span>
<span><span class="co">## 372 372        NA 3.7830983          4</span></span>
<span><span class="co">## 373 373 3.7512415 4.0078289          4</span></span>
<span><span class="co">## 374 374 3.7555742 4.5696159          4</span></span>
<span><span class="co">## 375 375 3.7717379 4.4006751          4</span></span>
<span><span class="co">## 376 376 3.9596750 3.3780514          4</span></span>
<span><span class="co">## 377 377 3.9030253 4.3689184          4</span></span>
<span><span class="co">## 378 378 3.9929990 4.0610642          4</span></span>
<span><span class="co">## 379 379 4.1123468 4.2379579          4</span></span>
<span><span class="co">## 380 380 4.5828190 4.2439457          4</span></span>
<span><span class="co">## 381 381 3.8151591 3.5900917          4</span></span>
<span><span class="co">## 382 382 3.9881944 3.8433819          4</span></span>
<span><span class="co">## 383 383 3.8345901 4.0470741          4</span></span>
<span><span class="co">## 384 384 4.4829795 3.6032498          4</span></span>
<span><span class="co">## 385 385 4.4819427 4.5539042          4</span></span>
<span><span class="co">## 386 386 3.9190303 3.8803203          4</span></span>
<span><span class="co">## 387 387 4.2250081 4.1633805          4</span></span>
<span><span class="co">## 388 388 3.7626860 4.8736366          4</span></span>
<span><span class="co">## 389 389 4.2178352 3.9220259          4</span></span>
<span><span class="co">## 390 390 3.9639790 3.9580201          4</span></span>
<span><span class="co">## 391 391        NA 3.6561234          4</span></span>
<span><span class="co">## 392 392 4.2747956 3.8884854          4</span></span>
<span><span class="co">## 393 393 4.0458076 3.9028172          4</span></span>
<span><span class="co">## 394 394        NA 4.1034577          4</span></span>
<span><span class="co">## 395 395        NA 4.4403817          4</span></span>
<span><span class="co">## 396 396 3.8447032 3.8917343          4</span></span>
<span><span class="co">## 397 397 3.8593144 3.8869368          4</span></span>
<span><span class="co">## 398 398        NA 4.0226513          4</span></span>
<span><span class="co">## 399 399 4.1450347 4.2901954          4</span></span>
<span><span class="co">## 400 400        NA 3.8679964          4</span></span>
<span><span class="co">## 401 401 4.9457100 4.6710968          5</span></span>
<span><span class="co">## 402 402        NA 5.0997240          5</span></span>
<span><span class="co">## 403 403 5.3185422 4.7448883          5</span></span>
<span><span class="co">## 404 404 4.8582681 5.3238070          5</span></span>
<span><span class="co">## 405 405        NA 5.1685786          5</span></span>
<span><span class="co">## 406 406 4.9592228 4.2990718          5</span></span>
<span><span class="co">## 407 407        NA 4.7411486          5</span></span>
<span><span class="co">## 408 408 5.2336508 5.3455436          5</span></span>
<span><span class="co">## 409 409 5.1522549 4.6352605          5</span></span>
<span><span class="co">## 410 410 4.3388656 4.8200015          5</span></span>
<span><span class="co">## 411 411 5.3686047 5.5392093          5</span></span>
<span><span class="co">## 412 412 4.7420224 5.1198095          5</span></span>
<span><span class="co">## 413 413 5.0544886 5.2174818          5</span></span>
<span><span class="co">## 414 414        NA 5.4715098          5</span></span>
<span><span class="co">## 415 415 5.0184367 4.7908311          5</span></span>
<span><span class="co">## 416 416 5.1669496 5.2871979          5</span></span>
<span><span class="co">## 417 417 4.7695759 5.7427835          5</span></span>
<span><span class="co">## 418 418 5.3225309 4.8965442          5</span></span>
<span><span class="co">## 419 419 4.1846116 4.8569612          5</span></span>
<span><span class="co">## 420 420 5.1644572 5.5417924          5</span></span>
<span><span class="co">## 421 421 4.8333231 4.8817064          5</span></span>
<span><span class="co">## 422 422 4.7953162 4.9019264          5</span></span>
<span><span class="co">## 423 423 4.9937558 4.6519847          5</span></span>
<span><span class="co">## 424 424 5.6572280 5.1705279          5</span></span>
<span><span class="co">## 425 425 5.2224694 5.3299182          5</span></span>
<span><span class="co">## 426 426 4.4974308 4.7196690          5</span></span>
<span><span class="co">## 427 427 4.9451748 5.2857547          5</span></span>
<span><span class="co">## 428 428 5.0090737 4.7180627          5</span></span>
<span><span class="co">## 429 429 5.3140443 4.7009635          5</span></span>
<span><span class="co">## 430 430 4.9307850 4.6724667          5</span></span>
<span><span class="co">## 431 431 4.8145807 4.6249856          5</span></span>
<span><span class="co">## 432 432        NA 4.7415155          5</span></span>
<span><span class="co">## 433 433 5.3837170 5.4142552          5</span></span>
<span><span class="co">## 434 434 5.4153798 5.3253147          5</span></span>
<span><span class="co">## 435 435 5.1877162 5.0582915          5</span></span>
<span><span class="co">## 436 436        NA 5.3409462          5</span></span>
<span><span class="co">## 437 437 5.5028899 5.5261178          5</span></span>
<span><span class="co">## 438 438 4.8653504 4.8808507          5</span></span>
<span><span class="co">## 439 439 5.3815319 5.2185908          5</span></span>
<span><span class="co">## 440 440 5.3712985 4.7264304          5</span></span>
<span><span class="co">## 441 441 4.9631232 4.8414262          5</span></span>
<span><span class="co">## 442 442        NA 5.2228696          5</span></span>
<span><span class="co">## 443 443 5.1141965 5.2977088          5</span></span>
<span><span class="co">## 444 444 5.3747529 4.4409490          5</span></span>
<span><span class="co">## 445 445 5.3281578 4.7584600          5</span></span>
<span><span class="co">## 446 446 4.9625295 4.4318370          5</span></span>
<span><span class="co">## 447 447 5.2580186 5.1313763          5</span></span>
<span><span class="co">## 448 448 5.2872071 5.0705238          5</span></span>
<span><span class="co">## 449 449 4.6258888 5.6229670          5</span></span>
<span><span class="co">## 450 450 5.0562624 4.8468164          5</span></span>
<span><span class="co">## 451 451 4.7147723 5.0579952          5</span></span>
<span><span class="co">## 452 452        NA 4.8251189          5</span></span>
<span><span class="co">## 453 453 4.9025356 5.0088127          5</span></span>
<span><span class="co">## 454 454 4.2304833 5.0741650          5</span></span>
<span><span class="co">## 455 455 4.4655376 4.8001240          5</span></span>
<span><span class="co">## 456 456        NA 5.6193508          5</span></span>
<span><span class="co">## 457 457 5.1039849 5.5942051          5</span></span>
<span><span class="co">## 458 458        NA 5.2773516          5</span></span>
<span><span class="co">## 459 459        NA 5.2283270          5</span></span>
<span><span class="co">## 460 460 4.6988891 4.4607288          5</span></span>
<span><span class="co">## 461 461 5.4835504 4.8497529          5</span></span>
<span><span class="co">## 462 462        NA 4.7025539          5</span></span>
<span><span class="co">## 463 463 4.8673869 5.1772804          5</span></span>
<span><span class="co">## 464 464        NA 4.9039878          5</span></span>
<span><span class="co">## 465 465        NA 5.0894679          5</span></span>
<span><span class="co">## 466 466 4.9149197 4.7890772          5</span></span>
<span><span class="co">## 467 467 5.2058784 5.5306713          5</span></span>
<span><span class="co">## 468 468 5.0256259 4.5104337          5</span></span>
<span><span class="co">## 469 469 4.8418064 4.4913246          5</span></span>
<span><span class="co">## 470 470        NA 5.1454600          5</span></span>
<span><span class="co">## 471 471        NA 5.3370361          5</span></span>
<span><span class="co">## 472 472 4.8703886 4.2149139          5</span></span>
<span><span class="co">## 473 473 4.8897906 4.7509414          5</span></span>
<span><span class="co">## 474 474 4.9916760 5.2338352          5</span></span>
<span><span class="co">## 475 475 5.3419165 4.9968641          5</span></span>
<span><span class="co">## 476 476 5.2020340 4.9727372          5</span></span>
<span><span class="co">## 477 477 5.0339331 5.3658228          5</span></span>
<span><span class="co">## 478 478 4.7719437 5.0154828          5</span></span>
<span><span class="co">## 479 479 5.0017508 5.1136895          5</span></span>
<span><span class="co">## 480 480 5.5456673 5.6435130          5</span></span>
<span><span class="co">## 481 481 4.2678764 4.8866338          5</span></span>
<span><span class="co">## 482 482        NA 4.8883353          5</span></span>
<span><span class="co">## 483 483 5.3373415 5.0236280          5</span></span>
<span><span class="co">## 484 484 4.8347445 5.6367827          5</span></span>
<span><span class="co">## 485 485 5.0965512 5.1914834          5</span></span>
<span><span class="co">## 486 486 4.9391667 4.8967730          5</span></span>
<span><span class="co">## 487 487        NA 5.1900489          5</span></span>
<span><span class="co">## 488 488        NA 4.5772297          5</span></span>
<span><span class="co">## 489 489 4.7141706 4.9212947          5</span></span>
<span><span class="co">## 490 490 4.5748958 5.1520131          5</span></span>
<span><span class="co">## 491 491 5.1036948 4.9735734          5</span></span>
<span><span class="co">## 492 492        NA 4.7587856          5</span></span>
<span><span class="co">## 493 493 5.0619552 5.2915141          5</span></span>
<span><span class="co">## 494 494        NA 4.8325474          5</span></span>
<span><span class="co">## 495 495        NA 5.3527271          5</span></span>
<span><span class="co">## 496 496 4.6741199 4.9844760          5</span></span>
<span><span class="co">## 497 497 5.3324965 4.9279474          5</span></span>
<span><span class="co">## 498 498 4.8868725 4.7749906          5</span></span>
<span><span class="co">## 499 499 5.3359997 5.0423805          5</span></span>
<span><span class="co">## 500 500 5.0358797 5.4614423          5</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.976</span></span></code></pre>
<p>and plotting the results (without the NA’s) we get:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 100 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="usage_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="high-dimensions">High dimensions<a class="anchor" aria-label="anchor" href="#high-dimensions"></a>
</h2>
<p>Let’s move to higher dimensions (and higher noise):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">30</span>, dims <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="comparison-with-r-vanilla-kmeans">Comparison with R vanilla kmeans<a class="anchor" aria-label="anchor" href="#comparison-with-r-vanilla-kmeans"></a>
</h2>
<p>Let’s compare it to R vanilla kmeans:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">km_standard</span><span class="op">$</span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, clust <span class="op">=</span> <span class="va">km_standard</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km_standard</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6818182</span></span></code></pre>
<p>We can see that kmeans++ clusters significantly better than R vanilla kmeans.</p>
</div>
<div class="section level2">
<h2 id="random-seed">Random seed<a class="anchor" aria-label="anchor" href="#random-seed"></a>
</h2>
<p>we can set the seed for the c++ random number generator, for reproducible results:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">km1</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">km2</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aviezer Lifshitz, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
