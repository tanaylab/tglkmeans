<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>basic usage • tglkmeans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="basic usage">
<meta property="og:description" content="tglkmeans">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tglkmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../articles/usage.html">
    <span class="fa fa-road"></span>
     
    Usage
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tanaylab/tglkmeans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>basic usage</h1>
                        <h4 data-toc-skip class="author">Aviezer
Lifshitz</h4>
            
            <h4 data-toc-skip class="date">2023-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tanaylab/tglkmeans/blob/HEAD/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>Basic usage of the package.</p>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>First, let’s create 5 clusters normally distributed around 1 to 5,
with sd of 0.3:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">5</span>, dims <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1 0.7430492 1.2385192          1</span></span>
<span><span class="co">## 2     2 1.0632653 1.4624126          1</span></span>
<span><span class="co">## 3     3 1.0091054 1.2428376          1</span></span>
<span><span class="co">## 4     4 0.9067030 0.9607555          1</span></span>
<span><span class="co">## 5     5 0.9738398 0.8930422          1</span></span>
<span><span class="co">## 6     6 0.8836296 1.0854607          1</span></span>
<span><span class="co">## 7     7 0.9884398 0.8204134          1</span></span>
<span><span class="co">## 8     8 0.9597240 1.1219836          1</span></span>
<span><span class="co">## 9     9 0.7250387 1.2314090          1</span></span>
<span><span class="co">## 10   10 1.1039797 0.9535994          1</span></span>
<span><span class="co">## 11   11 1.3210268 0.8297166          1</span></span>
<span><span class="co">## 12   12 0.4766216 0.9185898          1</span></span>
<span><span class="co">## 13   13 1.6325891 1.6177051          1</span></span>
<span><span class="co">## 14   14 1.3113365 0.9186262          1</span></span>
<span><span class="co">## 15   15 0.9932542 0.9675673          1</span></span>
<span><span class="co">## 16   16 0.9545074 1.1980653          1</span></span>
<span><span class="co">## 17   17 0.7834417 0.7959827          1</span></span>
<span><span class="co">## 18   18 0.7549301 1.1054243          1</span></span>
<span><span class="co">## 19   19 1.4141635 0.9969158          1</span></span>
<span><span class="co">## 20   20 1.1752963 1.1338602          1</span></span>
<span><span class="co">## 21   21 0.8498138 0.7177325          1</span></span>
<span><span class="co">## 22   22 0.6793986 0.5925461          1</span></span>
<span><span class="co">## 23   23 1.3717700 1.0727067          1</span></span>
<span><span class="co">## 24   24 0.9807628 1.3671065          1</span></span>
<span><span class="co">## 25   25 0.8341958 1.3645523          1</span></span>
<span><span class="co">## 26   26 1.2430578 1.1913138          1</span></span>
<span><span class="co">## 27   27 0.9304780 1.0599653          1</span></span>
<span><span class="co">## 28   28 1.4272327 0.9095716          1</span></span>
<span><span class="co">## 29   29 0.4131021 0.8103874          1</span></span>
<span><span class="co">## 30   30 1.0269292 1.4934257          1</span></span>
<span><span class="co">## 31   31 0.7530564 1.1798437          1</span></span>
<span><span class="co">## 32   32 0.9579693 1.3671018          1</span></span>
<span><span class="co">## 33   33 1.1983143 1.1829427          1</span></span>
<span><span class="co">## 34   34 0.7222673 1.4320895          1</span></span>
<span><span class="co">## 35   35 1.3233979 0.8232459          1</span></span>
<span><span class="co">## 36   36 1.0907332 1.2707546          1</span></span>
<span><span class="co">## 37   37 0.8827172 0.6315236          1</span></span>
<span><span class="co">## 38   38 1.3190230 1.2106710          1</span></span>
<span><span class="co">## 39   39 1.0817388 0.6741992          1</span></span>
<span><span class="co">## 40   40 1.0834646 0.4680853          1</span></span>
<span><span class="co">## 41   41 0.8021608 0.6506042          1</span></span>
<span><span class="co">## 42   42 0.8017685 1.1761566          1</span></span>
<span><span class="co">## 43   43 0.8263279 1.0828269          1</span></span>
<span><span class="co">## 44   44 1.1584724 0.9195910          1</span></span>
<span><span class="co">## 45   45 0.7372256 1.0841829          1</span></span>
<span><span class="co">## 46   46 0.7099634 1.2594522          1</span></span>
<span><span class="co">## 47   47 0.9330989 0.7573145          1</span></span>
<span><span class="co">## 48   48 0.9451395 1.2000444          1</span></span>
<span><span class="co">## 49   49 1.1753990 0.8694374          1</span></span>
<span><span class="co">## 50   50 1.3370152 1.3456338          1</span></span>
<span><span class="co">## 51   51 1.3033279 1.0791028          1</span></span>
<span><span class="co">## 52   52 0.5244183 1.2444651          1</span></span>
<span><span class="co">## 53   53 0.3097894 0.9146414          1</span></span>
<span><span class="co">## 54   54 0.7929463 1.2223705          1</span></span>
<span><span class="co">## 55   55 1.1042708 0.9192085          1</span></span>
<span><span class="co">## 56   56 0.3843612 0.8537601          1</span></span>
<span><span class="co">## 57   57 1.0189271 0.5353380          1</span></span>
<span><span class="co">## 58   58 1.1661206 0.9354918          1</span></span>
<span><span class="co">## 59   59 1.0019300 0.9971708          1</span></span>
<span><span class="co">## 60   60 0.9019084 1.0347537          1</span></span>
<span><span class="co">## 61   61 1.0442313 1.2091773          1</span></span>
<span><span class="co">## 62   62 1.1146631 1.0733897          1</span></span>
<span><span class="co">## 63   63 1.1934781 1.0283311          1</span></span>
<span><span class="co">## 64   64 0.9198896 1.1761215          1</span></span>
<span><span class="co">## 65   65 1.0972464 0.4873048          1</span></span>
<span><span class="co">## 66   66 0.7557511 0.9660111          1</span></span>
<span><span class="co">## 67   67 1.0213654 0.9080284          1</span></span>
<span><span class="co">## 68   68 1.1026197 0.9219156          1</span></span>
<span><span class="co">## 69   69 0.7164445 1.3999265          1</span></span>
<span><span class="co">## 70   70 0.6302918 0.6697399          1</span></span>
<span><span class="co">## 71   71 0.6357540 1.2757072          1</span></span>
<span><span class="co">## 72   72 0.7745960 1.1193332          1</span></span>
<span><span class="co">## 73   73 1.4454219 1.2024694          1</span></span>
<span><span class="co">## 74   74 1.1195500 0.9640920          1</span></span>
<span><span class="co">## 75   75 1.2477788 1.2024804          1</span></span>
<span><span class="co">## 76   76 0.9076324 1.1225524          1</span></span>
<span><span class="co">## 77   77 1.0629873 0.5501808          1</span></span>
<span><span class="co">## 78   78 1.0774514 1.1044478          1</span></span>
<span><span class="co">## 79   79 1.3730237 0.9817487          1</span></span>
<span><span class="co">## 80   80 1.1941478 1.1109158          1</span></span>
<span><span class="co">## 81   81 1.2900718 1.3837420          1</span></span>
<span><span class="co">## 82   82 1.1719051 0.8054851          1</span></span>
<span><span class="co">## 83   83 1.0364919 1.1606824          1</span></span>
<span><span class="co">## 84   84 0.8381828 0.4903631          1</span></span>
<span><span class="co">## 85   85 0.6202187 1.0788677          1</span></span>
<span><span class="co">## 86   86 0.9956979 0.8416226          1</span></span>
<span><span class="co">## 87   87 0.7763893 1.2509713          1</span></span>
<span><span class="co">## 88   88 1.1868508 1.3856673          1</span></span>
<span><span class="co">## 89   89 1.2176874 1.3266710          1</span></span>
<span><span class="co">## 90   90 1.3596909 0.6368875          1</span></span>
<span><span class="co">## 91   91 0.9070912 1.1931093          1</span></span>
<span><span class="co">## 92   92 1.0425374 1.0317144          1</span></span>
<span><span class="co">## 93   93 0.8529284 1.6151374          1</span></span>
<span><span class="co">## 94   94 1.2806510 1.5517275          1</span></span>
<span><span class="co">## 95   95 0.6675255 1.2433530          1</span></span>
<span><span class="co">## 96   96 0.5948246 1.1445724          1</span></span>
<span><span class="co">## 97   97 1.5106730 1.3636066          1</span></span>
<span><span class="co">## 98   98 0.9660547 1.1628799          1</span></span>
<span><span class="co">## 99   99 1.0329465 1.3367626          1</span></span>
<span><span class="co">## 100 100 1.5389566 1.0799112          1</span></span>
<span><span class="co">## 101 101 1.9893436 1.7234758          2</span></span>
<span><span class="co">## 102 102 1.8728997 2.0252887          2</span></span>
<span><span class="co">## 103 103 2.1418636 2.4759030          2</span></span>
<span><span class="co">## 104 104 2.0373395 2.1585838          2</span></span>
<span><span class="co">## 105 105 1.9521219 2.1222689          2</span></span>
<span><span class="co">## 106 106 2.0972248 1.9550016          2</span></span>
<span><span class="co">## 107 107 1.9102149 1.6994288          2</span></span>
<span><span class="co">## 108 108 2.6697842 2.2771057          2</span></span>
<span><span class="co">## 109 109 2.2490434 2.0031428          2</span></span>
<span><span class="co">## 110 110 1.8410736 1.6761844          2</span></span>
<span><span class="co">## 111 111 1.7069275 2.1309328          2</span></span>
<span><span class="co">## 112 112 1.8691938 1.4681466          2</span></span>
<span><span class="co">## 113 113 1.5483043 1.5549211          2</span></span>
<span><span class="co">## 114 114 2.2116677 2.2944568          2</span></span>
<span><span class="co">## 115 115 1.9528328 1.7483763          2</span></span>
<span><span class="co">## 116 116 2.0138417 1.7344510          2</span></span>
<span><span class="co">## 117 117 1.9220152 1.6684943          2</span></span>
<span><span class="co">## 118 118 2.0953838 1.9162904          2</span></span>
<span><span class="co">## 119 119 1.6260517 1.9441978          2</span></span>
<span><span class="co">## 120 120 2.3518372 2.0473949          2</span></span>
<span><span class="co">## 121 121 2.1595539 1.4495225          2</span></span>
<span><span class="co">## 122 122 2.3224568 1.5055792          2</span></span>
<span><span class="co">## 123 123 1.9843636 2.3508035          2</span></span>
<span><span class="co">## 124 124 1.7566947 2.3406692          2</span></span>
<span><span class="co">## 125 125 1.8886169 1.0601442          2</span></span>
<span><span class="co">## 126 126 1.5145122 1.8344577          2</span></span>
<span><span class="co">## 127 127 1.7659421 2.1804234          2</span></span>
<span><span class="co">## 128 128 2.5783339 2.4035119          2</span></span>
<span><span class="co">## 129 129 2.0872218 2.1485815          2</span></span>
<span><span class="co">## 130 130 2.2010105 2.0103511          2</span></span>
<span><span class="co">## 131 131 2.0771575 2.4949382          2</span></span>
<span><span class="co">## 132 132 1.8369943 2.1098173          2</span></span>
<span><span class="co">## 133 133 1.7902472 1.8128744          2</span></span>
<span><span class="co">## 134 134 2.4108644 2.0811030          2</span></span>
<span><span class="co">## 135 135 2.0159057 1.9830252          2</span></span>
<span><span class="co">## 136 136 1.5229379 1.8011289          2</span></span>
<span><span class="co">## 137 137 1.9423433 1.6080791          2</span></span>
<span><span class="co">## 138 138 2.2734195 1.8092309          2</span></span>
<span><span class="co">## 139 139 1.9812245 2.3233085          2</span></span>
<span><span class="co">## 140 140 2.2612915 2.2962899          2</span></span>
<span><span class="co">## 141 141 1.6406213 1.6500043          2</span></span>
<span><span class="co">## 142 142 2.0437584 2.0782707          2</span></span>
<span><span class="co">## 143 143 1.9642895 2.4057392          2</span></span>
<span><span class="co">## 144 144 2.1354734 2.0700508          2</span></span>
<span><span class="co">## 145 145 2.2148060 2.1154023          2</span></span>
<span><span class="co">## 146 146 1.7672993 1.7574157          2</span></span>
<span><span class="co">## 147 147 2.2356529 1.6593681          2</span></span>
<span><span class="co">## 148 148 1.8656591 2.2021375          2</span></span>
<span><span class="co">## 149 149 1.5298507 1.9154250          2</span></span>
<span><span class="co">## 150 150 2.1246240 1.9515709          2</span></span>
<span><span class="co">## 151 151 1.9535186 1.8739588          2</span></span>
<span><span class="co">## 152 152 1.9740045 1.6184333          2</span></span>
<span><span class="co">## 153 153 1.8440159 1.8716431          2</span></span>
<span><span class="co">## 154 154 1.8763762 1.2939905          2</span></span>
<span><span class="co">## 155 155 1.6935202 1.6763095          2</span></span>
<span><span class="co">## 156 156 2.0649453 2.0801234          2</span></span>
<span><span class="co">## 157 157 2.0244719 2.2364674          2</span></span>
<span><span class="co">## 158 158 2.0614100 1.9566487          2</span></span>
<span><span class="co">## 159 159 2.1508474 1.7757375          2</span></span>
<span><span class="co">## 160 160 1.7577319 2.1912735          2</span></span>
<span><span class="co">## 161 161 1.6123089 2.0306997          2</span></span>
<span><span class="co">## 162 162 1.4586633 2.2003633          2</span></span>
<span><span class="co">## 163 163 1.9028347 2.2565469          2</span></span>
<span><span class="co">## 164 164 2.7504180 2.1930714          2</span></span>
<span><span class="co">## 165 165 2.0660930 1.6020781          2</span></span>
<span><span class="co">## 166 166 2.5759031 2.7102548          2</span></span>
<span><span class="co">## 167 167 2.0370512 2.2037135          2</span></span>
<span><span class="co">## 168 168 2.3200221 2.0944625          2</span></span>
<span><span class="co">## 169 169 2.2145119 2.2156689          2</span></span>
<span><span class="co">## 170 170 1.8556264 2.1629466          2</span></span>
<span><span class="co">## 171 171 2.2713156 2.1924320          2</span></span>
<span><span class="co">## 172 172 2.3995731 2.4691871          2</span></span>
<span><span class="co">## 173 173 2.6568515 1.8816512          2</span></span>
<span><span class="co">## 174 174 2.2546280 1.4919289          2</span></span>
<span><span class="co">## 175 175 1.4084809 2.1398608          2</span></span>
<span><span class="co">## 176 176 1.5289703 2.0988440          2</span></span>
<span><span class="co">## 177 177 1.7290119 2.5160855          2</span></span>
<span><span class="co">## 178 178 2.3695625 1.9724981          2</span></span>
<span><span class="co">## 179 179 2.0511561 2.6787041          2</span></span>
<span><span class="co">## 180 180 1.8378546 2.3259294          2</span></span>
<span><span class="co">## 181 181 2.1599868 2.1729733          2</span></span>
<span><span class="co">## 182 182 2.0210176 1.5915480          2</span></span>
<span><span class="co">## 183 183 1.8933156 1.7119722          2</span></span>
<span><span class="co">## 184 184 1.6245398 1.7927998          2</span></span>
<span><span class="co">## 185 185 2.3579139 1.9261809          2</span></span>
<span><span class="co">## 186 186 1.7133918 1.7799070          2</span></span>
<span><span class="co">## 187 187 1.7804334 2.3796395          2</span></span>
<span><span class="co">## 188 188 1.6902991 1.8953167          2</span></span>
<span><span class="co">## 189 189 2.2918209 2.0679006          2</span></span>
<span><span class="co">## 190 190 2.0365337 2.2148875          2</span></span>
<span><span class="co">## 191 191 2.0103891 1.5459126          2</span></span>
<span><span class="co">## 192 192 2.1413185 1.9421550          2</span></span>
<span><span class="co">## 193 193 2.0004413 1.7971965          2</span></span>
<span><span class="co">## 194 194 2.2973442 2.0062435          2</span></span>
<span><span class="co">## 195 195 2.2084804 2.0761863          2</span></span>
<span><span class="co">## 196 196 1.5638345 2.1767328          2</span></span>
<span><span class="co">## 197 197 1.8823218 1.8342943          2</span></span>
<span><span class="co">## 198 198 1.8165585 1.9889656          2</span></span>
<span><span class="co">## 199 199 2.8781572 2.3154735          2</span></span>
<span><span class="co">## 200 200 1.6381849 2.6477023          2</span></span>
<span><span class="co">## 201 201 2.5881539 2.7860207          3</span></span>
<span><span class="co">## 202 202 2.9374093 2.8433394          3</span></span>
<span><span class="co">## 203 203 3.0726754 3.4361779          3</span></span>
<span><span class="co">## 204 204 2.7384154 2.8167704          3</span></span>
<span><span class="co">## 205 205 2.6365472 2.6084169          3</span></span>
<span><span class="co">## 206 206 3.2700015 3.3291722          3</span></span>
<span><span class="co">## 207 207 3.1758634 2.3423561          3</span></span>
<span><span class="co">## 208 208 3.0764783 2.8548679          3</span></span>
<span><span class="co">## 209 209 3.2893967 2.9619790          3</span></span>
<span><span class="co">## 210 210 3.1144812 3.0105573          3</span></span>
<span><span class="co">## 211 211 3.6438966 2.8292218          3</span></span>
<span><span class="co">## 212 212 2.8659958 2.6499540          3</span></span>
<span><span class="co">## 213 213 2.3606533 2.6196182          3</span></span>
<span><span class="co">## 214 214 3.3560768 3.2820512          3</span></span>
<span><span class="co">## 215 215 3.1271905 3.0223024          3</span></span>
<span><span class="co">## 216 216 3.6961279 2.6794440          3</span></span>
<span><span class="co">## 217 217 3.2445741 3.4147667          3</span></span>
<span><span class="co">## 218 218 2.2716507 3.3767387          3</span></span>
<span><span class="co">## 219 219 3.3695678 2.7913205          3</span></span>
<span><span class="co">## 220 220 3.3420859 3.0000917          3</span></span>
<span><span class="co">## 221 221 3.3466260 2.5344483          3</span></span>
<span><span class="co">## 222 222 2.8824756 3.2668440          3</span></span>
<span><span class="co">## 223 223 3.3122410 3.1836023          3</span></span>
<span><span class="co">## 224 224 2.7213251 3.3333765          3</span></span>
<span><span class="co">## 225 225 3.1040288 3.4818998          3</span></span>
<span><span class="co">## 226 226 2.8163566 2.5229976          3</span></span>
<span><span class="co">## 227 227 3.1734726 3.9092963          3</span></span>
<span><span class="co">## 228 228 2.9956144 2.9580074          3</span></span>
<span><span class="co">## 229 229 3.0974713 3.1056741          3</span></span>
<span><span class="co">## 230 230 3.1278534 2.8898391          3</span></span>
<span><span class="co">## 231 231 3.0188421 2.6262928          3</span></span>
<span><span class="co">## 232 232 2.5449860 2.7164171          3</span></span>
<span><span class="co">## 233 233 2.9385217 3.0101151          3</span></span>
<span><span class="co">## 234 234 3.3214069 3.1730308          3</span></span>
<span><span class="co">## 235 235 3.5778948 2.9070594          3</span></span>
<span><span class="co">## 236 236 3.5333758 3.1611364          3</span></span>
<span><span class="co">## 237 237 3.0916981 3.4325396          3</span></span>
<span><span class="co">## 238 238 3.1159342 3.1451922          3</span></span>
<span><span class="co">## 239 239 3.0734084 2.7103724          3</span></span>
<span><span class="co">## 240 240 3.0616017 2.7281369          3</span></span>
<span><span class="co">## 241 241 2.7612977 3.0052509          3</span></span>
<span><span class="co">## 242 242 2.4436375 2.9510521          3</span></span>
<span><span class="co">## 243 243 2.3945861 2.7660739          3</span></span>
<span><span class="co">## 244 244 3.2096032 2.9225044          3</span></span>
<span><span class="co">## 245 245 3.1651277 2.8127540          3</span></span>
<span><span class="co">## 246 246 2.8501623 3.0811000          3</span></span>
<span><span class="co">## 247 247 2.5040361 3.0588138          3</span></span>
<span><span class="co">## 248 248 2.6344414 2.7632126          3</span></span>
<span><span class="co">## 249 249 2.6560768 3.5568917          3</span></span>
<span><span class="co">## 250 250 3.0849409 2.8847010          3</span></span>
<span><span class="co">## 251 251 3.0437244 2.7713456          3</span></span>
<span><span class="co">## 252 252 2.7369066 2.6495545          3</span></span>
<span><span class="co">## 253 253 2.8273591 3.2174017          3</span></span>
<span><span class="co">## 254 254 3.2984496 3.4593470          3</span></span>
<span><span class="co">## 255 255 3.2097054 3.0671464          3</span></span>
<span><span class="co">## 256 256 2.7873506 3.1419894          3</span></span>
<span><span class="co">## 257 257 2.9570476 3.3241539          3</span></span>
<span><span class="co">## 258 258 3.2327692 3.5024413          3</span></span>
<span><span class="co">## 259 259 3.0515342 3.0688494          3</span></span>
<span><span class="co">## 260 260 3.3089687 3.6680815          3</span></span>
<span><span class="co">## 261 261 3.3554380 3.0612410          3</span></span>
<span><span class="co">## 262 262 2.9693782 3.1398350          3</span></span>
<span><span class="co">## 263 263 2.6939019 3.1714252          3</span></span>
<span><span class="co">## 264 264 3.3658741 2.7140003          3</span></span>
<span><span class="co">## 265 265 3.0654379 2.6418295          3</span></span>
<span><span class="co">## 266 266 2.8992188 2.7884814          3</span></span>
<span><span class="co">## 267 267 3.1727597 3.3101728          3</span></span>
<span><span class="co">## 268 268 3.3181523 2.9520299          3</span></span>
<span><span class="co">## 269 269 2.6223298 3.2859046          3</span></span>
<span><span class="co">## 270 270 3.0608407 2.9359458          3</span></span>
<span><span class="co">## 271 271 3.4558353 2.6334099          3</span></span>
<span><span class="co">## 272 272 3.0380586 3.1413212          3</span></span>
<span><span class="co">## 273 273 2.2178366 3.2369885          3</span></span>
<span><span class="co">## 274 274 2.6622057 2.6140139          3</span></span>
<span><span class="co">## 275 275 3.1151685 3.2196035          3</span></span>
<span><span class="co">## 276 276 3.3447579 2.7698801          3</span></span>
<span><span class="co">## 277 277 2.8765780 2.8728017          3</span></span>
<span><span class="co">## 278 278 3.2002504 3.0644447          3</span></span>
<span><span class="co">## 279 279 3.2899559 2.8988890          3</span></span>
<span><span class="co">## 280 280 2.9409373 3.1128136          3</span></span>
<span><span class="co">## 281 281 3.0532709 3.3228395          3</span></span>
<span><span class="co">## 282 282 2.7715935 3.0025861          3</span></span>
<span><span class="co">## 283 283 2.6787192 2.9175988          3</span></span>
<span><span class="co">## 284 284 2.7382924 2.7984590          3</span></span>
<span><span class="co">## 285 285 3.1293270 2.8212770          3</span></span>
<span><span class="co">## 286 286 2.8501868 3.5869043          3</span></span>
<span><span class="co">## 287 287 3.2781090 3.2614783          3</span></span>
<span><span class="co">## 288 288 3.1193512 3.2655917          3</span></span>
<span><span class="co">## 289 289 2.4931749 3.0260382          3</span></span>
<span><span class="co">## 290 290 3.2128474 2.6336112          3</span></span>
<span><span class="co">## 291 291 3.1716221 2.6650562          3</span></span>
<span><span class="co">## 292 292 2.7587073 3.0332929          3</span></span>
<span><span class="co">## 293 293 3.3257159 2.8495212          3</span></span>
<span><span class="co">## 294 294 2.9220923 3.3256094          3</span></span>
<span><span class="co">## 295 295 2.3331561 2.9777662          3</span></span>
<span><span class="co">## 296 296 3.0286095 3.0668590          3</span></span>
<span><span class="co">## 297 297 2.9402710 3.1181600          3</span></span>
<span><span class="co">## 298 298 3.3974378 3.8059571          3</span></span>
<span><span class="co">## 299 299 3.1692825 3.0248625          3</span></span>
<span><span class="co">## 300 300 2.6708423 3.0508930          3</span></span>
<span><span class="co">## 301 301 3.3163214 3.9961462          4</span></span>
<span><span class="co">## 302 302 3.8480456 3.6049729          4</span></span>
<span><span class="co">## 303 303 3.9119561 3.0696002          4</span></span>
<span><span class="co">## 304 304 4.1438597 3.8612169          4</span></span>
<span><span class="co">## 305 305 4.3413801 3.9008435          4</span></span>
<span><span class="co">## 306 306 4.1973254 3.7357423          4</span></span>
<span><span class="co">## 307 307 4.0867695 4.5765792          4</span></span>
<span><span class="co">## 308 308 4.2855732 3.6635646          4</span></span>
<span><span class="co">## 309 309 4.7677484 3.7187659          4</span></span>
<span><span class="co">## 310 310 4.3173121 3.8508814          4</span></span>
<span><span class="co">## 311 311 3.8743803 4.1919103          4</span></span>
<span><span class="co">## 312 312 3.8197944 4.0869519          4</span></span>
<span><span class="co">## 313 313 4.5211535 4.1730579          4</span></span>
<span><span class="co">## 314 314 3.9784410 4.2658969          4</span></span>
<span><span class="co">## 315 315 4.2073084 3.6784368          4</span></span>
<span><span class="co">## 316 316 3.7130900 4.1312443          4</span></span>
<span><span class="co">## 317 317 4.0934706 3.6336712          4</span></span>
<span><span class="co">## 318 318 3.5269982 3.8561311          4</span></span>
<span><span class="co">## 319 319 4.0085925 4.0374766          4</span></span>
<span><span class="co">## 320 320 4.0659724 2.9940764          4</span></span>
<span><span class="co">## 321 321 4.0529028 4.5192412          4</span></span>
<span><span class="co">## 322 322 3.5507029 3.6630242          4</span></span>
<span><span class="co">## 323 323 4.6389668 4.2102324          4</span></span>
<span><span class="co">## 324 324 4.8124420 3.5565753          4</span></span>
<span><span class="co">## 325 325 4.3224819 4.2877713          4</span></span>
<span><span class="co">## 326 326 4.1976564 3.9082018          4</span></span>
<span><span class="co">## 327 327 4.1054628 3.7073072          4</span></span>
<span><span class="co">## 328 328 4.1330246 4.0511138          4</span></span>
<span><span class="co">## 329 329 4.0289551 3.7772953          4</span></span>
<span><span class="co">## 330 330 4.0558502 3.7708888          4</span></span>
<span><span class="co">## 331 331 4.4521628 4.2001692          4</span></span>
<span><span class="co">## 332 332 3.8750011 4.0098532          4</span></span>
<span><span class="co">## 333 333 3.6610181 3.8194875          4</span></span>
<span><span class="co">## 334 334 3.5593531 4.0859071          4</span></span>
<span><span class="co">## 335 335 4.0687200 3.8907345          4</span></span>
<span><span class="co">## 336 336 3.7749727 3.9711229          4</span></span>
<span><span class="co">## 337 337 4.3401283 4.2694714          4</span></span>
<span><span class="co">## 338 338 3.9672597 4.0776846          4</span></span>
<span><span class="co">## 339 339 4.6826138 4.3912036          4</span></span>
<span><span class="co">## 340 340 4.6782676 3.8954830          4</span></span>
<span><span class="co">## 341 341 4.0031356 3.8754589          4</span></span>
<span><span class="co">## 342 342 4.1530316 3.8512187          4</span></span>
<span><span class="co">## 343 343 3.2261482 3.9937986          4</span></span>
<span><span class="co">## 344 344 4.1099286 3.7844710          4</span></span>
<span><span class="co">## 345 345 4.2819667 3.9975686          4</span></span>
<span><span class="co">## 346 346 3.8004501 4.0723953          4</span></span>
<span><span class="co">## 347 347 3.5314841 4.2822629          4</span></span>
<span><span class="co">## 348 348 4.1690241 3.5916252          4</span></span>
<span><span class="co">## 349 349 4.4279273 3.7200483          4</span></span>
<span><span class="co">## 350 350 3.9784467 3.9712868          4</span></span>
<span><span class="co">## 351 351 3.9080551 4.0140618          4</span></span>
<span><span class="co">## 352 352 3.8414343 3.4922241          4</span></span>
<span><span class="co">## 353 353 4.1619063 4.1608244          4</span></span>
<span><span class="co">## 354 354 3.5147283 3.8346077          4</span></span>
<span><span class="co">## 355 355 3.6648015 3.6963891          4</span></span>
<span><span class="co">## 356 356 4.0820431 4.1651773          4</span></span>
<span><span class="co">## 357 357 3.9158700 4.0323795          4</span></span>
<span><span class="co">## 358 358 3.6447189 4.1073275          4</span></span>
<span><span class="co">## 359 359 4.1981740 4.1265714          4</span></span>
<span><span class="co">## 360 360 4.0943222 4.0072432          4</span></span>
<span><span class="co">## 361 361 3.2210574 3.8452484          4</span></span>
<span><span class="co">## 362 362 3.9621721 4.2848955          4</span></span>
<span><span class="co">## 363 363 3.9188612 4.5557841          4</span></span>
<span><span class="co">## 364 364 4.2515016 3.6272011          4</span></span>
<span><span class="co">## 365 365 3.8767300 3.9850528          4</span></span>
<span><span class="co">## 366 366 4.3489294 4.5425956          4</span></span>
<span><span class="co">## 367 367 3.5142772 4.0139339          4</span></span>
<span><span class="co">## 368 368 3.7497341 4.1981394          4</span></span>
<span><span class="co">## 369 369 3.8360383 4.1438053          4</span></span>
<span><span class="co">## 370 370 4.2746525 3.7724622          4</span></span>
<span><span class="co">## 371 371 3.7493358 3.7418640          4</span></span>
<span><span class="co">## 372 372 4.0153637 4.3236625          4</span></span>
<span><span class="co">## 373 373 4.0710055 3.5893687          4</span></span>
<span><span class="co">## 374 374 4.1060921 4.0351520          4</span></span>
<span><span class="co">## 375 375 4.1107073 4.4553653          4</span></span>
<span><span class="co">## 376 376 3.6184335 3.7375027          4</span></span>
<span><span class="co">## 377 377 3.7254603 4.1483177          4</span></span>
<span><span class="co">## 378 378 3.7827234 4.1987294          4</span></span>
<span><span class="co">## 379 379 4.1653649 4.2505309          4</span></span>
<span><span class="co">## 380 380 4.0341403 4.0778070          4</span></span>
<span><span class="co">## 381 381 3.7053525 4.3357822          4</span></span>
<span><span class="co">## 382 382 3.6912184 4.0142344          4</span></span>
<span><span class="co">## 383 383 4.2075639 4.3065027          4</span></span>
<span><span class="co">## 384 384 4.2606130 3.9242987          4</span></span>
<span><span class="co">## 385 385 4.0551890 4.4454177          4</span></span>
<span><span class="co">## 386 386 4.0113903 3.8920482          4</span></span>
<span><span class="co">## 387 387 3.8299075 4.4190033          4</span></span>
<span><span class="co">## 388 388 3.0546758 4.2027602          4</span></span>
<span><span class="co">## 389 389 4.0490752 3.8193729          4</span></span>
<span><span class="co">## 390 390 4.4001121 4.3153660          4</span></span>
<span><span class="co">## 391 391 4.2950570 4.1650320          4</span></span>
<span><span class="co">## 392 392 3.8918735 4.1717633          4</span></span>
<span><span class="co">## 393 393 4.0066153 3.7737863          4</span></span>
<span><span class="co">## 394 394 3.8212489 3.5539906          4</span></span>
<span><span class="co">## 395 395 3.7843959 4.4093675          4</span></span>
<span><span class="co">## 396 396 4.3525996 3.7366017          4</span></span>
<span><span class="co">## 397 397 3.6708574 3.9249805          4</span></span>
<span><span class="co">## 398 398 3.8634413 3.8797431          4</span></span>
<span><span class="co">## 399 399 4.0011510 3.7308744          4</span></span>
<span><span class="co">## 400 400 4.1530173 3.9875385          4</span></span>
<span><span class="co">## 401 401 4.7604750 5.0303147          5</span></span>
<span><span class="co">## 402 402 4.8224111 5.2336634          5</span></span>
<span><span class="co">## 403 403 4.9421232 4.7658553          5</span></span>
<span><span class="co">## 404 404 5.1778925 5.3293397          5</span></span>
<span><span class="co">## 405 405 5.4032785 4.7608758          5</span></span>
<span><span class="co">## 406 406 4.8400444 4.7418554          5</span></span>
<span><span class="co">## 407 407 5.3755312 4.7767578          5</span></span>
<span><span class="co">## 408 408 5.2191605 5.3625052          5</span></span>
<span><span class="co">## 409 409 5.3969841 5.2881435          5</span></span>
<span><span class="co">## 410 410 5.5468293 4.2582719          5</span></span>
<span><span class="co">## 411 411 4.9258344 5.1194716          5</span></span>
<span><span class="co">## 412 412 5.0841673 5.3819770          5</span></span>
<span><span class="co">## 413 413 4.9764956 5.0437223          5</span></span>
<span><span class="co">## 414 414 4.6299261 5.0706889          5</span></span>
<span><span class="co">## 415 415 5.0005296 4.6516857          5</span></span>
<span><span class="co">## 416 416 4.2664639 4.9088055          5</span></span>
<span><span class="co">## 417 417 5.2013344 5.0485206          5</span></span>
<span><span class="co">## 418 418 5.3757030 4.9686400          5</span></span>
<span><span class="co">## 419 419 5.3052808 5.0936254          5</span></span>
<span><span class="co">## 420 420 4.7974007 5.2276673          5</span></span>
<span><span class="co">## 421 421 5.0787710 4.8476066          5</span></span>
<span><span class="co">## 422 422 5.6306329 4.7893190          5</span></span>
<span><span class="co">## 423 423 4.9223120 5.1708370          5</span></span>
<span><span class="co">## 424 424 5.4460215 4.9301506          5</span></span>
<span><span class="co">## 425 425 4.9099029 5.1095351          5</span></span>
<span><span class="co">## 426 426 5.0335543 4.6836607          5</span></span>
<span><span class="co">## 427 427 4.9491656 4.7644046          5</span></span>
<span><span class="co">## 428 428 5.0474201 4.6480413          5</span></span>
<span><span class="co">## 429 429 4.7596282 5.0147904          5</span></span>
<span><span class="co">## 430 430 5.3922940 4.8636989          5</span></span>
<span><span class="co">## 431 431 4.6715994 5.0614461          5</span></span>
<span><span class="co">## 432 432 4.8198724 4.3877941          5</span></span>
<span><span class="co">## 433 433 4.9834796 5.3446260          5</span></span>
<span><span class="co">## 434 434 5.2857647 5.2271837          5</span></span>
<span><span class="co">## 435 435 5.6396815 5.3682321          5</span></span>
<span><span class="co">## 436 436 4.6199816 5.2500474          5</span></span>
<span><span class="co">## 437 437 4.7071840 4.7860646          5</span></span>
<span><span class="co">## 438 438 4.4167973 5.4983645          5</span></span>
<span><span class="co">## 439 439 5.3731032 4.7269568          5</span></span>
<span><span class="co">## 440 440 4.2906749 5.2129370          5</span></span>
<span><span class="co">## 441 441 5.0108626 4.7665189          5</span></span>
<span><span class="co">## 442 442 5.0531139 4.5193775          5</span></span>
<span><span class="co">## 443 443 5.3913488 4.9770136          5</span></span>
<span><span class="co">## 444 444 4.5033900 5.4467414          5</span></span>
<span><span class="co">## 445 445 4.8729843 5.1344040          5</span></span>
<span><span class="co">## 446 446 4.8262664 4.6405460          5</span></span>
<span><span class="co">## 447 447 5.4594615 5.1727556          5</span></span>
<span><span class="co">## 448 448 5.0831630 4.6421035          5</span></span>
<span><span class="co">## 449 449 4.6677088 5.3037310          5</span></span>
<span><span class="co">## 450 450 4.6988133 4.8702915          5</span></span>
<span><span class="co">## 451 451 4.8063763 4.3010388          5</span></span>
<span><span class="co">## 452 452 4.9666594 5.0343379          5</span></span>
<span><span class="co">## 453 453 4.9470064 5.0630873          5</span></span>
<span><span class="co">## 454 454 4.4580378 5.0924841          5</span></span>
<span><span class="co">## 455 455 5.3012668 4.6550552          5</span></span>
<span><span class="co">## 456 456 5.6192759 5.0337549          5</span></span>
<span><span class="co">## 457 457 4.9001991 5.1640583          5</span></span>
<span><span class="co">## 458 458 4.3803898 5.1069710          5</span></span>
<span><span class="co">## 459 459 4.9537210 5.3790410          5</span></span>
<span><span class="co">## 460 460 5.1922976 4.7031991          5</span></span>
<span><span class="co">## 461 461 5.4273328 5.0499487          5</span></span>
<span><span class="co">## 462 462 5.0610083 4.3501524          5</span></span>
<span><span class="co">## 463 463 4.9442742 5.0341703          5</span></span>
<span><span class="co">## 464 464 5.4642755 5.5962257          5</span></span>
<span><span class="co">## 465 465 5.1310785 4.6266227          5</span></span>
<span><span class="co">## 466 466 5.0042911 4.6920679          5</span></span>
<span><span class="co">## 467 467 4.7522912 4.7050338          5</span></span>
<span><span class="co">## 468 468 4.4833772 5.3444352          5</span></span>
<span><span class="co">## 469 469 4.5060573 4.9740896          5</span></span>
<span><span class="co">## 470 470 5.2568916 5.4105207          5</span></span>
<span><span class="co">## 471 471 4.8881868 4.7603572          5</span></span>
<span><span class="co">## 472 472 4.8910291 4.7058548          5</span></span>
<span><span class="co">## 473 473 5.8132555 5.3058181          5</span></span>
<span><span class="co">## 474 474 5.0951816 5.0620412          5</span></span>
<span><span class="co">## 475 475 4.8204404 4.9222689          5</span></span>
<span><span class="co">## 476 476 5.2062246 5.5659040          5</span></span>
<span><span class="co">## 477 477 4.6588269 5.0512429          5</span></span>
<span><span class="co">## 478 478 4.7263057 5.2138632          5</span></span>
<span><span class="co">## 479 479 5.1536755 4.1948721          5</span></span>
<span><span class="co">## 480 480 4.8856174 4.9368947          5</span></span>
<span><span class="co">## 481 481 5.4487780 4.3258923          5</span></span>
<span><span class="co">## 482 482 5.1463183 5.0782262          5</span></span>
<span><span class="co">## 483 483 5.2147613 4.7161557          5</span></span>
<span><span class="co">## 484 484 4.6464806 4.6955460          5</span></span>
<span><span class="co">## 485 485 5.0873426 5.4285909          5</span></span>
<span><span class="co">## 486 486 4.9410952 5.3756473          5</span></span>
<span><span class="co">## 487 487 4.8182023 4.4468860          5</span></span>
<span><span class="co">## 488 488 5.0324426 5.1507903          5</span></span>
<span><span class="co">## 489 489 4.8268818 4.8925392          5</span></span>
<span><span class="co">## 490 490 5.3415734 5.2570574          5</span></span>
<span><span class="co">## 491 491 5.0939423 4.7213679          5</span></span>
<span><span class="co">## 492 492 5.0301263 5.2850327          5</span></span>
<span><span class="co">## 493 493 4.9725643 4.8117807          5</span></span>
<span><span class="co">## 494 494 4.8652587 4.9068832          5</span></span>
<span><span class="co">## 495 495 4.8909992 4.2577597          5</span></span>
<span><span class="co">## 496 496 5.0657419 4.4297378          5</span></span>
<span><span class="co">## 497 497 5.0041300 5.0509305          5</span></span>
<span><span class="co">## 498 498 5.0709363 4.8546798          5</span></span>
<span><span class="co">## 499 499 5.1463348 5.1086778          5</span></span>
<span><span class="co">## 500 500 4.7421544 5.2676586          5</span></span></code></pre>
<p>This is how our data looks like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now we can cluster it using kmeans++:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_for_clust</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data_for_clust</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## id column: id</span></span></code></pre>
<pre><code><span><span class="co">## KMEans: will generate seeds</span></span>
<span><span class="co">## KMeans into generate seeds</span></span>
<span><span class="co">## at seed 0</span></span>
<span><span class="co">## add new core from 320 to 0</span></span>
<span><span class="co">## at seed 1</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 350 450</span></span>
<span><span class="co">## picked up 4 dist was 2.25911</span></span>
<span><span class="co">## add new core from 4 to 1</span></span>
<span><span class="co">## at seed 2</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 300 400</span></span>
<span><span class="co">## picked up 180 dist was 0.830861</span></span>
<span><span class="co">## add new core from 180 to 2</span></span>
<span><span class="co">## at seed 3</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 250 350</span></span>
<span><span class="co">## picked up 223 dist was 0.684277</span></span>
<span><span class="co">## add new core from 223 to 3</span></span>
<span><span class="co">## at seed 4</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 200 300</span></span>
<span><span class="co">## picked up 425 dist was 0.553173</span></span>
<span><span class="co">## add new core from 425 to 4</span></span>
<span><span class="co">## KMEans: reassign after init</span></span>
<span><span class="co">## KMEans: iter 0</span></span>
<span><span class="co">## KMEans: iter 1 changed 4</span></span>
<span><span class="co">## KMEans: iter 1</span></span>
<span><span class="co">## KMEans: iter 2 changed 1</span></span>
<span><span class="co">## KMEans: iter 2</span></span>
<span><span class="co">## KMEans: iter 3 changed 0</span></span></code></pre>
<p>The returned list contains 3 fields:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">km</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "centers" "cluster" "size"</span></span></code></pre>
<p><code>km$centers</code> contains a tibble with <code>clust</code>
column and the cluster centers:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 1.99   2.00</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2 3.98   3.99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3 0.999  1.05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4 3.01   3.00</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5 5.00   4.96</span></span></code></pre>
<p>clusters are numbered according to <code>order_func</code> (see
‘Custom cluster ordering’ section).</p>
<p><code>km$cluster</code> contains tibble with <code>id</code> column
with the observation id (<code>1:n</code> if no id column was supplied),
and <code>clust</code> column with the observation assigned cluster:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">cluster</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 500 × 2</span></span></span>
<span><span class="co">##    id    clust</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 2         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 5         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 6         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 7         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 8         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 9         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 10        3</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre>
<p><code>km$size</code> contains tibble with <code>clust</code> column
and <code>n</code> column with the number of points in each cluster:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">size</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">##   clust     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1    99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5   101</span></span></code></pre>
<p>We can now check our clustering performance - fraction of
observations that were classified correctly (Note that
<code>match_clusters</code> function is internal to the package and is
used only in this vignette):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.982</span></span></code></pre>
<p>And plot the results:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="custom-cluster-ordering">Custom cluster ordering<a class="anchor" aria-label="anchor" href="#custom-cluster-ordering"></a>
</h2>
<p>By default, the clusters where ordered using the following function:
<code>hclust(dist(cor(t(centers))))</code> - hclust of the euclidean
distance of the correlation matrix of the centers.</p>
<p>We can supply our own function to order the clusters using
<code>reorder_func</code> argument. The function would be applied to
each center and he clusters would be ordered by the result.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    reorder_func <span class="op">=</span> <span class="va">median</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 0.999  1.05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2 1.99   2.00</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3 3.01   3.00</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4 3.98   3.99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5 5.00   4.96</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>tglkmeans can deal with missing data, as long as at least one
dimension is not missing. for example:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1 0.7430492 1.2385192          1</span></span>
<span><span class="co">## 2     2 1.0632653 1.4624126          1</span></span>
<span><span class="co">## 3     3 1.0091054 1.2428376          1</span></span>
<span><span class="co">## 4     4 0.9067030 0.9607555          1</span></span>
<span><span class="co">## 5     5 0.9738398 0.8930422          1</span></span>
<span><span class="co">## 6     6 0.8836296 1.0854607          1</span></span>
<span><span class="co">## 7     7 0.9884398 0.8204134          1</span></span>
<span><span class="co">## 8     8 0.9597240 1.1219836          1</span></span>
<span><span class="co">## 9     9        NA 1.2314090          1</span></span>
<span><span class="co">## 10   10        NA 0.9535994          1</span></span>
<span><span class="co">## 11   11 1.3210268 0.8297166          1</span></span>
<span><span class="co">## 12   12 0.4766216 0.9185898          1</span></span>
<span><span class="co">## 13   13 1.6325891 1.6177051          1</span></span>
<span><span class="co">## 14   14        NA 0.9186262          1</span></span>
<span><span class="co">## 15   15 0.9932542 0.9675673          1</span></span>
<span><span class="co">## 16   16 0.9545074 1.1980653          1</span></span>
<span><span class="co">## 17   17 0.7834417 0.7959827          1</span></span>
<span><span class="co">## 18   18 0.7549301 1.1054243          1</span></span>
<span><span class="co">## 19   19 1.4141635 0.9969158          1</span></span>
<span><span class="co">## 20   20 1.1752963 1.1338602          1</span></span>
<span><span class="co">## 21   21 0.8498138 0.7177325          1</span></span>
<span><span class="co">## 22   22 0.6793986 0.5925461          1</span></span>
<span><span class="co">## 23   23 1.3717700 1.0727067          1</span></span>
<span><span class="co">## 24   24        NA 1.3671065          1</span></span>
<span><span class="co">## 25   25 0.8341958 1.3645523          1</span></span>
<span><span class="co">## 26   26        NA 1.1913138          1</span></span>
<span><span class="co">## 27   27 0.9304780 1.0599653          1</span></span>
<span><span class="co">## 28   28 1.4272327 0.9095716          1</span></span>
<span><span class="co">## 29   29 0.4131021 0.8103874          1</span></span>
<span><span class="co">## 30   30 1.0269292 1.4934257          1</span></span>
<span><span class="co">## 31   31 0.7530564 1.1798437          1</span></span>
<span><span class="co">## 32   32 0.9579693 1.3671018          1</span></span>
<span><span class="co">## 33   33 1.1983143 1.1829427          1</span></span>
<span><span class="co">## 34   34 0.7222673 1.4320895          1</span></span>
<span><span class="co">## 35   35 1.3233979 0.8232459          1</span></span>
<span><span class="co">## 36   36 1.0907332 1.2707546          1</span></span>
<span><span class="co">## 37   37 0.8827172 0.6315236          1</span></span>
<span><span class="co">## 38   38 1.3190230 1.2106710          1</span></span>
<span><span class="co">## 39   39 1.0817388 0.6741992          1</span></span>
<span><span class="co">## 40   40 1.0834646 0.4680853          1</span></span>
<span><span class="co">## 41   41 0.8021608 0.6506042          1</span></span>
<span><span class="co">## 42   42 0.8017685 1.1761566          1</span></span>
<span><span class="co">## 43   43 0.8263279 1.0828269          1</span></span>
<span><span class="co">## 44   44 1.1584724 0.9195910          1</span></span>
<span><span class="co">## 45   45 0.7372256 1.0841829          1</span></span>
<span><span class="co">## 46   46 0.7099634 1.2594522          1</span></span>
<span><span class="co">## 47   47 0.9330989 0.7573145          1</span></span>
<span><span class="co">## 48   48 0.9451395 1.2000444          1</span></span>
<span><span class="co">## 49   49 1.1753990 0.8694374          1</span></span>
<span><span class="co">## 50   50        NA 1.3456338          1</span></span>
<span><span class="co">## 51   51 1.3033279 1.0791028          1</span></span>
<span><span class="co">## 52   52 0.5244183 1.2444651          1</span></span>
<span><span class="co">## 53   53        NA 0.9146414          1</span></span>
<span><span class="co">## 54   54        NA 1.2223705          1</span></span>
<span><span class="co">## 55   55 1.1042708 0.9192085          1</span></span>
<span><span class="co">## 56   56 0.3843612 0.8537601          1</span></span>
<span><span class="co">## 57   57        NA 0.5353380          1</span></span>
<span><span class="co">## 58   58 1.1661206 0.9354918          1</span></span>
<span><span class="co">## 59   59 1.0019300 0.9971708          1</span></span>
<span><span class="co">## 60   60 0.9019084 1.0347537          1</span></span>
<span><span class="co">## 61   61 1.0442313 1.2091773          1</span></span>
<span><span class="co">## 62   62 1.1146631 1.0733897          1</span></span>
<span><span class="co">## 63   63 1.1934781 1.0283311          1</span></span>
<span><span class="co">## 64   64 0.9198896 1.1761215          1</span></span>
<span><span class="co">## 65   65 1.0972464 0.4873048          1</span></span>
<span><span class="co">## 66   66 0.7557511 0.9660111          1</span></span>
<span><span class="co">## 67   67 1.0213654 0.9080284          1</span></span>
<span><span class="co">## 68   68        NA 0.9219156          1</span></span>
<span><span class="co">## 69   69 0.7164445 1.3999265          1</span></span>
<span><span class="co">## 70   70 0.6302918 0.6697399          1</span></span>
<span><span class="co">## 71   71 0.6357540 1.2757072          1</span></span>
<span><span class="co">## 72   72 0.7745960 1.1193332          1</span></span>
<span><span class="co">## 73   73        NA 1.2024694          1</span></span>
<span><span class="co">## 74   74 1.1195500 0.9640920          1</span></span>
<span><span class="co">## 75   75 1.2477788 1.2024804          1</span></span>
<span><span class="co">## 76   76 0.9076324 1.1225524          1</span></span>
<span><span class="co">## 77   77 1.0629873 0.5501808          1</span></span>
<span><span class="co">## 78   78 1.0774514 1.1044478          1</span></span>
<span><span class="co">## 79   79        NA 0.9817487          1</span></span>
<span><span class="co">## 80   80 1.1941478 1.1109158          1</span></span>
<span><span class="co">## 81   81 1.2900718 1.3837420          1</span></span>
<span><span class="co">## 82   82 1.1719051 0.8054851          1</span></span>
<span><span class="co">## 83   83 1.0364919 1.1606824          1</span></span>
<span><span class="co">## 84   84 0.8381828 0.4903631          1</span></span>
<span><span class="co">## 85   85 0.6202187 1.0788677          1</span></span>
<span><span class="co">## 86   86 0.9956979 0.8416226          1</span></span>
<span><span class="co">## 87   87 0.7763893 1.2509713          1</span></span>
<span><span class="co">## 88   88 1.1868508 1.3856673          1</span></span>
<span><span class="co">## 89   89 1.2176874 1.3266710          1</span></span>
<span><span class="co">## 90   90 1.3596909 0.6368875          1</span></span>
<span><span class="co">## 91   91        NA 1.1931093          1</span></span>
<span><span class="co">## 92   92 1.0425374 1.0317144          1</span></span>
<span><span class="co">## 93   93 0.8529284 1.6151374          1</span></span>
<span><span class="co">## 94   94        NA 1.5517275          1</span></span>
<span><span class="co">## 95   95        NA 1.2433530          1</span></span>
<span><span class="co">## 96   96 0.5948246 1.1445724          1</span></span>
<span><span class="co">## 97   97        NA 1.3636066          1</span></span>
<span><span class="co">## 98   98 0.9660547 1.1628799          1</span></span>
<span><span class="co">## 99   99 1.0329465 1.3367626          1</span></span>
<span><span class="co">## 100 100        NA 1.0799112          1</span></span>
<span><span class="co">## 101 101 1.9893436 1.7234758          2</span></span>
<span><span class="co">## 102 102 1.8728997 2.0252887          2</span></span>
<span><span class="co">## 103 103        NA 2.4759030          2</span></span>
<span><span class="co">## 104 104 2.0373395 2.1585838          2</span></span>
<span><span class="co">## 105 105 1.9521219 2.1222689          2</span></span>
<span><span class="co">## 106 106 2.0972248 1.9550016          2</span></span>
<span><span class="co">## 107 107 1.9102149 1.6994288          2</span></span>
<span><span class="co">## 108 108 2.6697842 2.2771057          2</span></span>
<span><span class="co">## 109 109        NA 2.0031428          2</span></span>
<span><span class="co">## 110 110 1.8410736 1.6761844          2</span></span>
<span><span class="co">## 111 111 1.7069275 2.1309328          2</span></span>
<span><span class="co">## 112 112 1.8691938 1.4681466          2</span></span>
<span><span class="co">## 113 113 1.5483043 1.5549211          2</span></span>
<span><span class="co">## 114 114        NA 2.2944568          2</span></span>
<span><span class="co">## 115 115 1.9528328 1.7483763          2</span></span>
<span><span class="co">## 116 116 2.0138417 1.7344510          2</span></span>
<span><span class="co">## 117 117 1.9220152 1.6684943          2</span></span>
<span><span class="co">## 118 118 2.0953838 1.9162904          2</span></span>
<span><span class="co">## 119 119 1.6260517 1.9441978          2</span></span>
<span><span class="co">## 120 120 2.3518372 2.0473949          2</span></span>
<span><span class="co">## 121 121        NA 1.4495225          2</span></span>
<span><span class="co">## 122 122 2.3224568 1.5055792          2</span></span>
<span><span class="co">## 123 123 1.9843636 2.3508035          2</span></span>
<span><span class="co">## 124 124        NA 2.3406692          2</span></span>
<span><span class="co">## 125 125 1.8886169 1.0601442          2</span></span>
<span><span class="co">## 126 126 1.5145122 1.8344577          2</span></span>
<span><span class="co">## 127 127 1.7659421 2.1804234          2</span></span>
<span><span class="co">## 128 128        NA 2.4035119          2</span></span>
<span><span class="co">## 129 129 2.0872218 2.1485815          2</span></span>
<span><span class="co">## 130 130 2.2010105 2.0103511          2</span></span>
<span><span class="co">## 131 131 2.0771575 2.4949382          2</span></span>
<span><span class="co">## 132 132        NA 2.1098173          2</span></span>
<span><span class="co">## 133 133 1.7902472 1.8128744          2</span></span>
<span><span class="co">## 134 134 2.4108644 2.0811030          2</span></span>
<span><span class="co">## 135 135 2.0159057 1.9830252          2</span></span>
<span><span class="co">## 136 136 1.5229379 1.8011289          2</span></span>
<span><span class="co">## 137 137        NA 1.6080791          2</span></span>
<span><span class="co">## 138 138 2.2734195 1.8092309          2</span></span>
<span><span class="co">## 139 139        NA 2.3233085          2</span></span>
<span><span class="co">## 140 140 2.2612915 2.2962899          2</span></span>
<span><span class="co">## 141 141 1.6406213 1.6500043          2</span></span>
<span><span class="co">## 142 142 2.0437584 2.0782707          2</span></span>
<span><span class="co">## 143 143 1.9642895 2.4057392          2</span></span>
<span><span class="co">## 144 144        NA 2.0700508          2</span></span>
<span><span class="co">## 145 145 2.2148060 2.1154023          2</span></span>
<span><span class="co">## 146 146 1.7672993 1.7574157          2</span></span>
<span><span class="co">## 147 147 2.2356529 1.6593681          2</span></span>
<span><span class="co">## 148 148 1.8656591 2.2021375          2</span></span>
<span><span class="co">## 149 149 1.5298507 1.9154250          2</span></span>
<span><span class="co">## 150 150 2.1246240 1.9515709          2</span></span>
<span><span class="co">## 151 151 1.9535186 1.8739588          2</span></span>
<span><span class="co">## 152 152 1.9740045 1.6184333          2</span></span>
<span><span class="co">## 153 153 1.8440159 1.8716431          2</span></span>
<span><span class="co">## 154 154 1.8763762 1.2939905          2</span></span>
<span><span class="co">## 155 155 1.6935202 1.6763095          2</span></span>
<span><span class="co">## 156 156 2.0649453 2.0801234          2</span></span>
<span><span class="co">## 157 157        NA 2.2364674          2</span></span>
<span><span class="co">## 158 158        NA 1.9566487          2</span></span>
<span><span class="co">## 159 159 2.1508474 1.7757375          2</span></span>
<span><span class="co">## 160 160 1.7577319 2.1912735          2</span></span>
<span><span class="co">## 161 161 1.6123089 2.0306997          2</span></span>
<span><span class="co">## 162 162 1.4586633 2.2003633          2</span></span>
<span><span class="co">## 163 163 1.9028347 2.2565469          2</span></span>
<span><span class="co">## 164 164 2.7504180 2.1930714          2</span></span>
<span><span class="co">## 165 165 2.0660930 1.6020781          2</span></span>
<span><span class="co">## 166 166        NA 2.7102548          2</span></span>
<span><span class="co">## 167 167        NA 2.2037135          2</span></span>
<span><span class="co">## 168 168 2.3200221 2.0944625          2</span></span>
<span><span class="co">## 169 169 2.2145119 2.2156689          2</span></span>
<span><span class="co">## 170 170 1.8556264 2.1629466          2</span></span>
<span><span class="co">## 171 171 2.2713156 2.1924320          2</span></span>
<span><span class="co">## 172 172 2.3995731 2.4691871          2</span></span>
<span><span class="co">## 173 173 2.6568515 1.8816512          2</span></span>
<span><span class="co">## 174 174        NA 1.4919289          2</span></span>
<span><span class="co">## 175 175 1.4084809 2.1398608          2</span></span>
<span><span class="co">## 176 176 1.5289703 2.0988440          2</span></span>
<span><span class="co">## 177 177 1.7290119 2.5160855          2</span></span>
<span><span class="co">## 178 178        NA 1.9724981          2</span></span>
<span><span class="co">## 179 179 2.0511561 2.6787041          2</span></span>
<span><span class="co">## 180 180 1.8378546 2.3259294          2</span></span>
<span><span class="co">## 181 181 2.1599868 2.1729733          2</span></span>
<span><span class="co">## 182 182        NA 1.5915480          2</span></span>
<span><span class="co">## 183 183 1.8933156 1.7119722          2</span></span>
<span><span class="co">## 184 184 1.6245398 1.7927998          2</span></span>
<span><span class="co">## 185 185 2.3579139 1.9261809          2</span></span>
<span><span class="co">## 186 186 1.7133918 1.7799070          2</span></span>
<span><span class="co">## 187 187        NA 2.3796395          2</span></span>
<span><span class="co">## 188 188        NA 1.8953167          2</span></span>
<span><span class="co">## 189 189 2.2918209 2.0679006          2</span></span>
<span><span class="co">## 190 190 2.0365337 2.2148875          2</span></span>
<span><span class="co">## 191 191 2.0103891 1.5459126          2</span></span>
<span><span class="co">## 192 192 2.1413185 1.9421550          2</span></span>
<span><span class="co">## 193 193 2.0004413 1.7971965          2</span></span>
<span><span class="co">## 194 194 2.2973442 2.0062435          2</span></span>
<span><span class="co">## 195 195        NA 2.0761863          2</span></span>
<span><span class="co">## 196 196 1.5638345 2.1767328          2</span></span>
<span><span class="co">## 197 197 1.8823218 1.8342943          2</span></span>
<span><span class="co">## 198 198 1.8165585 1.9889656          2</span></span>
<span><span class="co">## 199 199 2.8781572 2.3154735          2</span></span>
<span><span class="co">## 200 200 1.6381849 2.6477023          2</span></span>
<span><span class="co">## 201 201        NA 2.7860207          3</span></span>
<span><span class="co">## 202 202 2.9374093 2.8433394          3</span></span>
<span><span class="co">## 203 203        NA 3.4361779          3</span></span>
<span><span class="co">## 204 204 2.7384154 2.8167704          3</span></span>
<span><span class="co">## 205 205 2.6365472 2.6084169          3</span></span>
<span><span class="co">## 206 206 3.2700015 3.3291722          3</span></span>
<span><span class="co">## 207 207 3.1758634 2.3423561          3</span></span>
<span><span class="co">## 208 208 3.0764783 2.8548679          3</span></span>
<span><span class="co">## 209 209 3.2893967 2.9619790          3</span></span>
<span><span class="co">## 210 210        NA 3.0105573          3</span></span>
<span><span class="co">## 211 211 3.6438966 2.8292218          3</span></span>
<span><span class="co">## 212 212        NA 2.6499540          3</span></span>
<span><span class="co">## 213 213 2.3606533 2.6196182          3</span></span>
<span><span class="co">## 214 214        NA 3.2820512          3</span></span>
<span><span class="co">## 215 215 3.1271905 3.0223024          3</span></span>
<span><span class="co">## 216 216 3.6961279 2.6794440          3</span></span>
<span><span class="co">## 217 217 3.2445741 3.4147667          3</span></span>
<span><span class="co">## 218 218 2.2716507 3.3767387          3</span></span>
<span><span class="co">## 219 219 3.3695678 2.7913205          3</span></span>
<span><span class="co">## 220 220        NA 3.0000917          3</span></span>
<span><span class="co">## 221 221 3.3466260 2.5344483          3</span></span>
<span><span class="co">## 222 222 2.8824756 3.2668440          3</span></span>
<span><span class="co">## 223 223 3.3122410 3.1836023          3</span></span>
<span><span class="co">## 224 224 2.7213251 3.3333765          3</span></span>
<span><span class="co">## 225 225        NA 3.4818998          3</span></span>
<span><span class="co">## 226 226 2.8163566 2.5229976          3</span></span>
<span><span class="co">## 227 227 3.1734726 3.9092963          3</span></span>
<span><span class="co">## 228 228 2.9956144 2.9580074          3</span></span>
<span><span class="co">## 229 229 3.0974713 3.1056741          3</span></span>
<span><span class="co">## 230 230 3.1278534 2.8898391          3</span></span>
<span><span class="co">## 231 231        NA 2.6262928          3</span></span>
<span><span class="co">## 232 232 2.5449860 2.7164171          3</span></span>
<span><span class="co">## 233 233 2.9385217 3.0101151          3</span></span>
<span><span class="co">## 234 234 3.3214069 3.1730308          3</span></span>
<span><span class="co">## 235 235 3.5778948 2.9070594          3</span></span>
<span><span class="co">## 236 236 3.5333758 3.1611364          3</span></span>
<span><span class="co">## 237 237 3.0916981 3.4325396          3</span></span>
<span><span class="co">## 238 238        NA 3.1451922          3</span></span>
<span><span class="co">## 239 239        NA 2.7103724          3</span></span>
<span><span class="co">## 240 240 3.0616017 2.7281369          3</span></span>
<span><span class="co">## 241 241 2.7612977 3.0052509          3</span></span>
<span><span class="co">## 242 242 2.4436375 2.9510521          3</span></span>
<span><span class="co">## 243 243 2.3945861 2.7660739          3</span></span>
<span><span class="co">## 244 244 3.2096032 2.9225044          3</span></span>
<span><span class="co">## 245 245 3.1651277 2.8127540          3</span></span>
<span><span class="co">## 246 246        NA 3.0811000          3</span></span>
<span><span class="co">## 247 247 2.5040361 3.0588138          3</span></span>
<span><span class="co">## 248 248        NA 2.7632126          3</span></span>
<span><span class="co">## 249 249 2.6560768 3.5568917          3</span></span>
<span><span class="co">## 250 250 3.0849409 2.8847010          3</span></span>
<span><span class="co">## 251 251 3.0437244 2.7713456          3</span></span>
<span><span class="co">## 252 252 2.7369066 2.6495545          3</span></span>
<span><span class="co">## 253 253        NA 3.2174017          3</span></span>
<span><span class="co">## 254 254 3.2984496 3.4593470          3</span></span>
<span><span class="co">## 255 255 3.2097054 3.0671464          3</span></span>
<span><span class="co">## 256 256 2.7873506 3.1419894          3</span></span>
<span><span class="co">## 257 257 2.9570476 3.3241539          3</span></span>
<span><span class="co">## 258 258 3.2327692 3.5024413          3</span></span>
<span><span class="co">## 259 259 3.0515342 3.0688494          3</span></span>
<span><span class="co">## 260 260        NA 3.6680815          3</span></span>
<span><span class="co">## 261 261 3.3554380 3.0612410          3</span></span>
<span><span class="co">## 262 262        NA 3.1398350          3</span></span>
<span><span class="co">## 263 263 2.6939019 3.1714252          3</span></span>
<span><span class="co">## 264 264 3.3658741 2.7140003          3</span></span>
<span><span class="co">## 265 265 3.0654379 2.6418295          3</span></span>
<span><span class="co">## 266 266 2.8992188 2.7884814          3</span></span>
<span><span class="co">## 267 267 3.1727597 3.3101728          3</span></span>
<span><span class="co">## 268 268 3.3181523 2.9520299          3</span></span>
<span><span class="co">## 269 269 2.6223298 3.2859046          3</span></span>
<span><span class="co">## 270 270 3.0608407 2.9359458          3</span></span>
<span><span class="co">## 271 271 3.4558353 2.6334099          3</span></span>
<span><span class="co">## 272 272 3.0380586 3.1413212          3</span></span>
<span><span class="co">## 273 273 2.2178366 3.2369885          3</span></span>
<span><span class="co">## 274 274 2.6622057 2.6140139          3</span></span>
<span><span class="co">## 275 275 3.1151685 3.2196035          3</span></span>
<span><span class="co">## 276 276        NA 2.7698801          3</span></span>
<span><span class="co">## 277 277        NA 2.8728017          3</span></span>
<span><span class="co">## 278 278        NA 3.0644447          3</span></span>
<span><span class="co">## 279 279        NA 2.8988890          3</span></span>
<span><span class="co">## 280 280 2.9409373 3.1128136          3</span></span>
<span><span class="co">## 281 281 3.0532709 3.3228395          3</span></span>
<span><span class="co">## 282 282 2.7715935 3.0025861          3</span></span>
<span><span class="co">## 283 283 2.6787192 2.9175988          3</span></span>
<span><span class="co">## 284 284        NA 2.7984590          3</span></span>
<span><span class="co">## 285 285 3.1293270 2.8212770          3</span></span>
<span><span class="co">## 286 286 2.8501868 3.5869043          3</span></span>
<span><span class="co">## 287 287 3.2781090 3.2614783          3</span></span>
<span><span class="co">## 288 288 3.1193512 3.2655917          3</span></span>
<span><span class="co">## 289 289 2.4931749 3.0260382          3</span></span>
<span><span class="co">## 290 290        NA 2.6336112          3</span></span>
<span><span class="co">## 291 291 3.1716221 2.6650562          3</span></span>
<span><span class="co">## 292 292 2.7587073 3.0332929          3</span></span>
<span><span class="co">## 293 293        NA 2.8495212          3</span></span>
<span><span class="co">## 294 294 2.9220923 3.3256094          3</span></span>
<span><span class="co">## 295 295 2.3331561 2.9777662          3</span></span>
<span><span class="co">## 296 296        NA 3.0668590          3</span></span>
<span><span class="co">## 297 297 2.9402710 3.1181600          3</span></span>
<span><span class="co">## 298 298 3.3974378 3.8059571          3</span></span>
<span><span class="co">## 299 299 3.1692825 3.0248625          3</span></span>
<span><span class="co">## 300 300 2.6708423 3.0508930          3</span></span>
<span><span class="co">## 301 301        NA 3.9961462          4</span></span>
<span><span class="co">## 302 302        NA 3.6049729          4</span></span>
<span><span class="co">## 303 303 3.9119561 3.0696002          4</span></span>
<span><span class="co">## 304 304 4.1438597 3.8612169          4</span></span>
<span><span class="co">## 305 305 4.3413801 3.9008435          4</span></span>
<span><span class="co">## 306 306 4.1973254 3.7357423          4</span></span>
<span><span class="co">## 307 307 4.0867695 4.5765792          4</span></span>
<span><span class="co">## 308 308 4.2855732 3.6635646          4</span></span>
<span><span class="co">## 309 309 4.7677484 3.7187659          4</span></span>
<span><span class="co">## 310 310 4.3173121 3.8508814          4</span></span>
<span><span class="co">## 311 311 3.8743803 4.1919103          4</span></span>
<span><span class="co">## 312 312 3.8197944 4.0869519          4</span></span>
<span><span class="co">## 313 313 4.5211535 4.1730579          4</span></span>
<span><span class="co">## 314 314 3.9784410 4.2658969          4</span></span>
<span><span class="co">## 315 315 4.2073084 3.6784368          4</span></span>
<span><span class="co">## 316 316 3.7130900 4.1312443          4</span></span>
<span><span class="co">## 317 317        NA 3.6336712          4</span></span>
<span><span class="co">## 318 318 3.5269982 3.8561311          4</span></span>
<span><span class="co">## 319 319 4.0085925 4.0374766          4</span></span>
<span><span class="co">## 320 320 4.0659724 2.9940764          4</span></span>
<span><span class="co">## 321 321 4.0529028 4.5192412          4</span></span>
<span><span class="co">## 322 322 3.5507029 3.6630242          4</span></span>
<span><span class="co">## 323 323 4.6389668 4.2102324          4</span></span>
<span><span class="co">## 324 324 4.8124420 3.5565753          4</span></span>
<span><span class="co">## 325 325 4.3224819 4.2877713          4</span></span>
<span><span class="co">## 326 326 4.1976564 3.9082018          4</span></span>
<span><span class="co">## 327 327 4.1054628 3.7073072          4</span></span>
<span><span class="co">## 328 328 4.1330246 4.0511138          4</span></span>
<span><span class="co">## 329 329 4.0289551 3.7772953          4</span></span>
<span><span class="co">## 330 330 4.0558502 3.7708888          4</span></span>
<span><span class="co">## 331 331 4.4521628 4.2001692          4</span></span>
<span><span class="co">## 332 332 3.8750011 4.0098532          4</span></span>
<span><span class="co">## 333 333        NA 3.8194875          4</span></span>
<span><span class="co">## 334 334 3.5593531 4.0859071          4</span></span>
<span><span class="co">## 335 335 4.0687200 3.8907345          4</span></span>
<span><span class="co">## 336 336        NA 3.9711229          4</span></span>
<span><span class="co">## 337 337        NA 4.2694714          4</span></span>
<span><span class="co">## 338 338 3.9672597 4.0776846          4</span></span>
<span><span class="co">## 339 339        NA 4.3912036          4</span></span>
<span><span class="co">## 340 340 4.6782676 3.8954830          4</span></span>
<span><span class="co">## 341 341        NA 3.8754589          4</span></span>
<span><span class="co">## 342 342 4.1530316 3.8512187          4</span></span>
<span><span class="co">## 343 343 3.2261482 3.9937986          4</span></span>
<span><span class="co">## 344 344 4.1099286 3.7844710          4</span></span>
<span><span class="co">## 345 345 4.2819667 3.9975686          4</span></span>
<span><span class="co">## 346 346 3.8004501 4.0723953          4</span></span>
<span><span class="co">## 347 347 3.5314841 4.2822629          4</span></span>
<span><span class="co">## 348 348        NA 3.5916252          4</span></span>
<span><span class="co">## 349 349 4.4279273 3.7200483          4</span></span>
<span><span class="co">## 350 350 3.9784467 3.9712868          4</span></span>
<span><span class="co">## 351 351 3.9080551 4.0140618          4</span></span>
<span><span class="co">## 352 352 3.8414343 3.4922241          4</span></span>
<span><span class="co">## 353 353 4.1619063 4.1608244          4</span></span>
<span><span class="co">## 354 354 3.5147283 3.8346077          4</span></span>
<span><span class="co">## 355 355        NA 3.6963891          4</span></span>
<span><span class="co">## 356 356        NA 4.1651773          4</span></span>
<span><span class="co">## 357 357 3.9158700 4.0323795          4</span></span>
<span><span class="co">## 358 358 3.6447189 4.1073275          4</span></span>
<span><span class="co">## 359 359 4.1981740 4.1265714          4</span></span>
<span><span class="co">## 360 360 4.0943222 4.0072432          4</span></span>
<span><span class="co">## 361 361 3.2210574 3.8452484          4</span></span>
<span><span class="co">## 362 362 3.9621721 4.2848955          4</span></span>
<span><span class="co">## 363 363        NA 4.5557841          4</span></span>
<span><span class="co">## 364 364        NA 3.6272011          4</span></span>
<span><span class="co">## 365 365 3.8767300 3.9850528          4</span></span>
<span><span class="co">## 366 366 4.3489294 4.5425956          4</span></span>
<span><span class="co">## 367 367 3.5142772 4.0139339          4</span></span>
<span><span class="co">## 368 368        NA 4.1981394          4</span></span>
<span><span class="co">## 369 369 3.8360383 4.1438053          4</span></span>
<span><span class="co">## 370 370 4.2746525 3.7724622          4</span></span>
<span><span class="co">## 371 371 3.7493358 3.7418640          4</span></span>
<span><span class="co">## 372 372        NA 4.3236625          4</span></span>
<span><span class="co">## 373 373 4.0710055 3.5893687          4</span></span>
<span><span class="co">## 374 374 4.1060921 4.0351520          4</span></span>
<span><span class="co">## 375 375        NA 4.4553653          4</span></span>
<span><span class="co">## 376 376 3.6184335 3.7375027          4</span></span>
<span><span class="co">## 377 377 3.7254603 4.1483177          4</span></span>
<span><span class="co">## 378 378 3.7827234 4.1987294          4</span></span>
<span><span class="co">## 379 379 4.1653649 4.2505309          4</span></span>
<span><span class="co">## 380 380        NA 4.0778070          4</span></span>
<span><span class="co">## 381 381 3.7053525 4.3357822          4</span></span>
<span><span class="co">## 382 382 3.6912184 4.0142344          4</span></span>
<span><span class="co">## 383 383 4.2075639 4.3065027          4</span></span>
<span><span class="co">## 384 384 4.2606130 3.9242987          4</span></span>
<span><span class="co">## 385 385 4.0551890 4.4454177          4</span></span>
<span><span class="co">## 386 386 4.0113903 3.8920482          4</span></span>
<span><span class="co">## 387 387        NA 4.4190033          4</span></span>
<span><span class="co">## 388 388 3.0546758 4.2027602          4</span></span>
<span><span class="co">## 389 389 4.0490752 3.8193729          4</span></span>
<span><span class="co">## 390 390 4.4001121 4.3153660          4</span></span>
<span><span class="co">## 391 391 4.2950570 4.1650320          4</span></span>
<span><span class="co">## 392 392 3.8918735 4.1717633          4</span></span>
<span><span class="co">## 393 393 4.0066153 3.7737863          4</span></span>
<span><span class="co">## 394 394 3.8212489 3.5539906          4</span></span>
<span><span class="co">## 395 395        NA 4.4093675          4</span></span>
<span><span class="co">## 396 396 4.3525996 3.7366017          4</span></span>
<span><span class="co">## 397 397        NA 3.9249805          4</span></span>
<span><span class="co">## 398 398 3.8634413 3.8797431          4</span></span>
<span><span class="co">## 399 399        NA 3.7308744          4</span></span>
<span><span class="co">## 400 400        NA 3.9875385          4</span></span>
<span><span class="co">## 401 401 4.7604750 5.0303147          5</span></span>
<span><span class="co">## 402 402 4.8224111 5.2336634          5</span></span>
<span><span class="co">## 403 403 4.9421232 4.7658553          5</span></span>
<span><span class="co">## 404 404 5.1778925 5.3293397          5</span></span>
<span><span class="co">## 405 405 5.4032785 4.7608758          5</span></span>
<span><span class="co">## 406 406 4.8400444 4.7418554          5</span></span>
<span><span class="co">## 407 407 5.3755312 4.7767578          5</span></span>
<span><span class="co">## 408 408 5.2191605 5.3625052          5</span></span>
<span><span class="co">## 409 409        NA 5.2881435          5</span></span>
<span><span class="co">## 410 410 5.5468293 4.2582719          5</span></span>
<span><span class="co">## 411 411 4.9258344 5.1194716          5</span></span>
<span><span class="co">## 412 412 5.0841673 5.3819770          5</span></span>
<span><span class="co">## 413 413 4.9764956 5.0437223          5</span></span>
<span><span class="co">## 414 414 4.6299261 5.0706889          5</span></span>
<span><span class="co">## 415 415 5.0005296 4.6516857          5</span></span>
<span><span class="co">## 416 416 4.2664639 4.9088055          5</span></span>
<span><span class="co">## 417 417 5.2013344 5.0485206          5</span></span>
<span><span class="co">## 418 418 5.3757030 4.9686400          5</span></span>
<span><span class="co">## 419 419 5.3052808 5.0936254          5</span></span>
<span><span class="co">## 420 420 4.7974007 5.2276673          5</span></span>
<span><span class="co">## 421 421 5.0787710 4.8476066          5</span></span>
<span><span class="co">## 422 422 5.6306329 4.7893190          5</span></span>
<span><span class="co">## 423 423 4.9223120 5.1708370          5</span></span>
<span><span class="co">## 424 424 5.4460215 4.9301506          5</span></span>
<span><span class="co">## 425 425        NA 5.1095351          5</span></span>
<span><span class="co">## 426 426 5.0335543 4.6836607          5</span></span>
<span><span class="co">## 427 427 4.9491656 4.7644046          5</span></span>
<span><span class="co">## 428 428 5.0474201 4.6480413          5</span></span>
<span><span class="co">## 429 429 4.7596282 5.0147904          5</span></span>
<span><span class="co">## 430 430 5.3922940 4.8636989          5</span></span>
<span><span class="co">## 431 431 4.6715994 5.0614461          5</span></span>
<span><span class="co">## 432 432        NA 4.3877941          5</span></span>
<span><span class="co">## 433 433 4.9834796 5.3446260          5</span></span>
<span><span class="co">## 434 434        NA 5.2271837          5</span></span>
<span><span class="co">## 435 435        NA 5.3682321          5</span></span>
<span><span class="co">## 436 436        NA 5.2500474          5</span></span>
<span><span class="co">## 437 437        NA 4.7860646          5</span></span>
<span><span class="co">## 438 438 4.4167973 5.4983645          5</span></span>
<span><span class="co">## 439 439        NA 4.7269568          5</span></span>
<span><span class="co">## 440 440        NA 5.2129370          5</span></span>
<span><span class="co">## 441 441 5.0108626 4.7665189          5</span></span>
<span><span class="co">## 442 442 5.0531139 4.5193775          5</span></span>
<span><span class="co">## 443 443 5.3913488 4.9770136          5</span></span>
<span><span class="co">## 444 444 4.5033900 5.4467414          5</span></span>
<span><span class="co">## 445 445 4.8729843 5.1344040          5</span></span>
<span><span class="co">## 446 446        NA 4.6405460          5</span></span>
<span><span class="co">## 447 447        NA 5.1727556          5</span></span>
<span><span class="co">## 448 448 5.0831630 4.6421035          5</span></span>
<span><span class="co">## 449 449        NA 5.3037310          5</span></span>
<span><span class="co">## 450 450 4.6988133 4.8702915          5</span></span>
<span><span class="co">## 451 451 4.8063763 4.3010388          5</span></span>
<span><span class="co">## 452 452 4.9666594 5.0343379          5</span></span>
<span><span class="co">## 453 453 4.9470064 5.0630873          5</span></span>
<span><span class="co">## 454 454 4.4580378 5.0924841          5</span></span>
<span><span class="co">## 455 455 5.3012668 4.6550552          5</span></span>
<span><span class="co">## 456 456 5.6192759 5.0337549          5</span></span>
<span><span class="co">## 457 457 4.9001991 5.1640583          5</span></span>
<span><span class="co">## 458 458 4.3803898 5.1069710          5</span></span>
<span><span class="co">## 459 459        NA 5.3790410          5</span></span>
<span><span class="co">## 460 460        NA 4.7031991          5</span></span>
<span><span class="co">## 461 461 5.4273328 5.0499487          5</span></span>
<span><span class="co">## 462 462 5.0610083 4.3501524          5</span></span>
<span><span class="co">## 463 463 4.9442742 5.0341703          5</span></span>
<span><span class="co">## 464 464 5.4642755 5.5962257          5</span></span>
<span><span class="co">## 465 465 5.1310785 4.6266227          5</span></span>
<span><span class="co">## 466 466 5.0042911 4.6920679          5</span></span>
<span><span class="co">## 467 467 4.7522912 4.7050338          5</span></span>
<span><span class="co">## 468 468 4.4833772 5.3444352          5</span></span>
<span><span class="co">## 469 469        NA 4.9740896          5</span></span>
<span><span class="co">## 470 470 5.2568916 5.4105207          5</span></span>
<span><span class="co">## 471 471 4.8881868 4.7603572          5</span></span>
<span><span class="co">## 472 472 4.8910291 4.7058548          5</span></span>
<span><span class="co">## 473 473 5.8132555 5.3058181          5</span></span>
<span><span class="co">## 474 474 5.0951816 5.0620412          5</span></span>
<span><span class="co">## 475 475 4.8204404 4.9222689          5</span></span>
<span><span class="co">## 476 476        NA 5.5659040          5</span></span>
<span><span class="co">## 477 477 4.6588269 5.0512429          5</span></span>
<span><span class="co">## 478 478 4.7263057 5.2138632          5</span></span>
<span><span class="co">## 479 479        NA 4.1948721          5</span></span>
<span><span class="co">## 480 480 4.8856174 4.9368947          5</span></span>
<span><span class="co">## 481 481 5.4487780 4.3258923          5</span></span>
<span><span class="co">## 482 482 5.1463183 5.0782262          5</span></span>
<span><span class="co">## 483 483 5.2147613 4.7161557          5</span></span>
<span><span class="co">## 484 484 4.6464806 4.6955460          5</span></span>
<span><span class="co">## 485 485 5.0873426 5.4285909          5</span></span>
<span><span class="co">## 486 486 4.9410952 5.3756473          5</span></span>
<span><span class="co">## 487 487 4.8182023 4.4468860          5</span></span>
<span><span class="co">## 488 488 5.0324426 5.1507903          5</span></span>
<span><span class="co">## 489 489        NA 4.8925392          5</span></span>
<span><span class="co">## 490 490 5.3415734 5.2570574          5</span></span>
<span><span class="co">## 491 491 5.0939423 4.7213679          5</span></span>
<span><span class="co">## 492 492 5.0301263 5.2850327          5</span></span>
<span><span class="co">## 493 493 4.9725643 4.8117807          5</span></span>
<span><span class="co">## 494 494 4.8652587 4.9068832          5</span></span>
<span><span class="co">## 495 495 4.8909992 4.2577597          5</span></span>
<span><span class="co">## 496 496 5.0657419 4.4297378          5</span></span>
<span><span class="co">## 497 497 5.0041300 5.0509305          5</span></span>
<span><span class="co">## 498 498 5.0709363 4.8546798          5</span></span>
<span><span class="co">## 499 499 5.1463348 5.1086778          5</span></span>
<span><span class="co">## 500 500 4.7421544 5.2676586          5</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.97</span></span></code></pre>
<p>and plotting the results (without the NA’s) we get:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 100 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="usage_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="high-dimensions">High dimensions<a class="anchor" aria-label="anchor" href="#high-dimensions"></a>
</h2>
<p>Let’s move to higher dimensions (and higher noise):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">30</span>, dims <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="comparison-with-r-vanilla-kmeans">Comparison with R vanilla kmeans<a class="anchor" aria-label="anchor" href="#comparison-with-r-vanilla-kmeans"></a>
</h2>
<p>Let’s compare it to R vanilla kmeans:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">km_standard</span><span class="op">$</span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, clust <span class="op">=</span> <span class="va">km_standard</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km_standard</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6</span></span></code></pre>
<p>We can see that kmeans++ clusters significantly better than R vanilla
kmeans.</p>
</div>
<div class="section level2">
<h2 id="random-seed">Random seed<a class="anchor" aria-label="anchor" href="#random-seed"></a>
</h2>
<p>we can set the seed for the c++ random number generator, for
reproducible results:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">km1</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">km2</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aviezer Lifshitz, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
