<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>basic usage • tglkmeans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="basic usage">
<meta property="og:description" content="tglkmeans">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tglkmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../articles/usage.html">
    <span class="fa fa-road"></span>
     
    Usage
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tanaylab/tglkmeans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>basic usage</h1>
                        <h4 data-toc-skip class="author">Aviezer
Lifshitz</h4>
            
            <h4 data-toc-skip class="date">2023-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tanaylab/tglkmeans/blob/HEAD/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>Basic usage of the package.</p>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>First, let’s create 5 clusters normally distributed around 1 to 5,
with sd of 0.3:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">5</span>, dims <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1 0.8188280 0.9966275          1</span></span>
<span><span class="co">## 2     2 0.5961526 0.2448524          1</span></span>
<span><span class="co">## 3     3 1.2878798 0.9523234          1</span></span>
<span><span class="co">## 4     4 1.1452386 0.6845486          1</span></span>
<span><span class="co">## 5     5 1.0367838 1.4471093          1</span></span>
<span><span class="co">## 6     6 1.0661379 1.0775916          1</span></span>
<span><span class="co">## 7     7 1.3369140 1.5427066          1</span></span>
<span><span class="co">## 8     8 1.1959286 0.8973236          1</span></span>
<span><span class="co">## 9     9 0.4938583 0.8645343          1</span></span>
<span><span class="co">## 10   10 0.9362103 1.4175774          1</span></span>
<span><span class="co">## 11   11 1.3010990 1.2781073          1</span></span>
<span><span class="co">## 12   12 0.7896602 0.7255738          1</span></span>
<span><span class="co">## 13   13 1.7323458 1.4555507          1</span></span>
<span><span class="co">## 14   14 1.5428318 1.3004856          1</span></span>
<span><span class="co">## 15   15 1.4443598 0.6687689          1</span></span>
<span><span class="co">## 16   16 1.0905494 1.0800339          1</span></span>
<span><span class="co">## 17   17 1.1887296 0.5036605          1</span></span>
<span><span class="co">## 18   18 0.6295992 0.9537295          1</span></span>
<span><span class="co">## 19   19 1.1028873 0.9398331          1</span></span>
<span><span class="co">## 20   20 0.7775887 1.1541446          1</span></span>
<span><span class="co">## 21   21 0.9834659 1.2391041          1</span></span>
<span><span class="co">## 22   22 1.0567297 0.9482430          1</span></span>
<span><span class="co">## 23   23 1.1697952 1.2713699          1</span></span>
<span><span class="co">## 24   24 1.3895388 0.9061066          1</span></span>
<span><span class="co">## 25   25 0.6008567 1.1828310          1</span></span>
<span><span class="co">## 26   26 1.1542779 0.7786776          1</span></span>
<span><span class="co">## 27   27 1.4263896 0.6263562          1</span></span>
<span><span class="co">## 28   28 0.6696653 1.0710904          1</span></span>
<span><span class="co">## 29   29 1.0112142 0.5677481          1</span></span>
<span><span class="co">## 30   30 0.9504909 0.9925098          1</span></span>
<span><span class="co">## 31   31 1.1952104 0.8910515          1</span></span>
<span><span class="co">## 32   32 1.6321424 0.9500865          1</span></span>
<span><span class="co">## 33   33 1.1281729 0.8080582          1</span></span>
<span><span class="co">## 34   34 1.2120664 1.0385841          1</span></span>
<span><span class="co">## 35   35 0.8633086 1.4675713          1</span></span>
<span><span class="co">## 36   36 1.0841344 1.1837852          1</span></span>
<span><span class="co">## 37   37 0.7316616 0.3909947          1</span></span>
<span><span class="co">## 38   38 1.1010060 0.7308528          1</span></span>
<span><span class="co">## 39   39 1.4241218 1.2565578          1</span></span>
<span><span class="co">## 40   40 1.1928094 0.9454138          1</span></span>
<span><span class="co">## 41   41 1.3010064 0.3877956          1</span></span>
<span><span class="co">## 42   42 1.1680418 0.7626537          1</span></span>
<span><span class="co">## 43   43 0.8216290 0.8531213          1</span></span>
<span><span class="co">## 44   44 0.5439822 0.2971495          1</span></span>
<span><span class="co">## 45   45 1.0308020 1.1113343          1</span></span>
<span><span class="co">## 46   46 1.2908144 1.5073288          1</span></span>
<span><span class="co">## 47   47 1.6003298 0.5243866          1</span></span>
<span><span class="co">## 48   48 0.9465606 0.8816125          1</span></span>
<span><span class="co">## 49   49 0.7917819 1.1821391          1</span></span>
<span><span class="co">## 50   50 1.2882612 1.4308688          1</span></span>
<span><span class="co">## 51   51 1.1385981 1.2664792          1</span></span>
<span><span class="co">## 52   52 0.6151377 1.2244604          1</span></span>
<span><span class="co">## 53   53 1.1247607 0.8190489          1</span></span>
<span><span class="co">## 54   54 1.1720667 0.8203357          1</span></span>
<span><span class="co">## 55   55 0.6160849 0.9561350          1</span></span>
<span><span class="co">## 56   56 1.2925343 0.8188187          1</span></span>
<span><span class="co">## 57   57 1.1212146 1.1476306          1</span></span>
<span><span class="co">## 58   58 1.1746002 0.9714103          1</span></span>
<span><span class="co">## 59   59 0.9776854 0.8700007          1</span></span>
<span><span class="co">## 60   60 0.6578205 1.2859991          1</span></span>
<span><span class="co">## 61   61 1.3605197 1.2332100          1</span></span>
<span><span class="co">## 62   62 0.7195622 0.9444836          1</span></span>
<span><span class="co">## 63   63 0.8810501 1.0161335          1</span></span>
<span><span class="co">## 64   64 1.3047780 1.0161465          1</span></span>
<span><span class="co">## 65   65 1.5101158 1.0142607          1</span></span>
<span><span class="co">## 66   66 0.5731514 1.0243621          1</span></span>
<span><span class="co">## 67   67 0.8100637 1.0571703          1</span></span>
<span><span class="co">## 68   68 0.9511783 0.5074623          1</span></span>
<span><span class="co">## 69   69 0.9803648 0.8485589          1</span></span>
<span><span class="co">## 70   70 0.6296381 1.1637192          1</span></span>
<span><span class="co">## 71   71 0.4285077 0.6146679          1</span></span>
<span><span class="co">## 72   72 0.7287063 1.7449338          1</span></span>
<span><span class="co">## 73   73 0.8192213 0.7427164          1</span></span>
<span><span class="co">## 74   74 1.0440940 1.1987677          1</span></span>
<span><span class="co">## 75   75 1.1274625 1.0436112          1</span></span>
<span><span class="co">## 76   76 1.1732213 0.9396261          1</span></span>
<span><span class="co">## 77   77 1.1507294 1.0595235          1</span></span>
<span><span class="co">## 78   78 0.9308075 0.6634640          1</span></span>
<span><span class="co">## 79   79 0.4462272 1.5636335          1</span></span>
<span><span class="co">## 80   80 1.2496639 0.9142423          1</span></span>
<span><span class="co">## 81   81 1.2590981 0.9400401          1</span></span>
<span><span class="co">## 82   82 0.8757597 1.2123659          1</span></span>
<span><span class="co">## 83   83 1.2154681 1.1794770          1</span></span>
<span><span class="co">## 84   84 0.6049736 0.5346539          1</span></span>
<span><span class="co">## 85   85 0.4986965 1.4565610          1</span></span>
<span><span class="co">## 86   86 0.6964748 1.1775595          1</span></span>
<span><span class="co">## 87   87 1.0114122 1.2574625          1</span></span>
<span><span class="co">## 88   88 1.1414979 1.2283909          1</span></span>
<span><span class="co">## 89   89 1.4588612 0.3611688          1</span></span>
<span><span class="co">## 90   90 0.8550975 0.7043796          1</span></span>
<span><span class="co">## 91   91 1.4067225 1.2387041          1</span></span>
<span><span class="co">## 92   92 0.7777326 0.9703458          1</span></span>
<span><span class="co">## 93   93 1.1601545 0.8219973          1</span></span>
<span><span class="co">## 94   94 0.6799122 1.0370679          1</span></span>
<span><span class="co">## 95   95 0.6488871 1.3094400          1</span></span>
<span><span class="co">## 96   96 1.2678301 0.9081572          1</span></span>
<span><span class="co">## 97   97 1.0237648 1.2748075          1</span></span>
<span><span class="co">## 98   98 1.2108471 1.0895608          1</span></span>
<span><span class="co">## 99   99 0.8808951 1.1215119          1</span></span>
<span><span class="co">## 100 100 1.4800307 0.6977767          1</span></span>
<span><span class="co">## 101 101 2.2010873 1.9024262          2</span></span>
<span><span class="co">## 102 102 1.9975286 2.0254427          2</span></span>
<span><span class="co">## 103 103 2.6116819 2.2296135          2</span></span>
<span><span class="co">## 104 104 2.3745574 1.8402332          2</span></span>
<span><span class="co">## 105 105 2.2290987 2.1758514          2</span></span>
<span><span class="co">## 106 106 1.6659972 2.1831748          2</span></span>
<span><span class="co">## 107 107 1.4149340 2.4277871          2</span></span>
<span><span class="co">## 108 108 2.2377821 2.3850042          2</span></span>
<span><span class="co">## 109 109 2.3617725 1.8804781          2</span></span>
<span><span class="co">## 110 110 2.1751510 2.1104521          2</span></span>
<span><span class="co">## 111 111 1.7545716 1.5948683          2</span></span>
<span><span class="co">## 112 112 2.1141673 2.0777955          2</span></span>
<span><span class="co">## 113 113 2.5061933 1.7615562          2</span></span>
<span><span class="co">## 114 114 1.9883697 1.5982726          2</span></span>
<span><span class="co">## 115 115 2.0691359 2.0171946          2</span></span>
<span><span class="co">## 116 116 2.2625447 2.1219282          2</span></span>
<span><span class="co">## 117 117 1.2333152 1.8659345          2</span></span>
<span><span class="co">## 118 118 2.2211346 2.0789490          2</span></span>
<span><span class="co">## 119 119 1.5232200 2.1219369          2</span></span>
<span><span class="co">## 120 120 2.2728396 2.0486167          2</span></span>
<span><span class="co">## 121 121 1.8603712 2.5316977          2</span></span>
<span><span class="co">## 122 122 2.0924361 2.2920710          2</span></span>
<span><span class="co">## 123 123 1.8069465 1.8170792          2</span></span>
<span><span class="co">## 124 124 1.8753251 2.0522120          2</span></span>
<span><span class="co">## 125 125 1.7531796 2.2579903          2</span></span>
<span><span class="co">## 126 126 2.1118428 2.0869394          2</span></span>
<span><span class="co">## 127 127 2.1462140 2.2119830          2</span></span>
<span><span class="co">## 128 128 2.0970074 1.9924477          2</span></span>
<span><span class="co">## 129 129 2.5880837 1.9463810          2</span></span>
<span><span class="co">## 130 130 2.0240974 2.1448038          2</span></span>
<span><span class="co">## 131 131 2.1545785 1.9333252          2</span></span>
<span><span class="co">## 132 132 2.1219719 2.4442252          2</span></span>
<span><span class="co">## 133 133 2.2157441 2.3436415          2</span></span>
<span><span class="co">## 134 134 1.9452814 1.8008444          2</span></span>
<span><span class="co">## 135 135 1.9641237 1.9167961          2</span></span>
<span><span class="co">## 136 136 1.3995928 2.6015746          2</span></span>
<span><span class="co">## 137 137 2.2144193 1.8485561          2</span></span>
<span><span class="co">## 138 138 1.7204685 2.2934480          2</span></span>
<span><span class="co">## 139 139 2.1481378 1.5526403          2</span></span>
<span><span class="co">## 140 140 1.6924195 2.2490631          2</span></span>
<span><span class="co">## 141 141 2.2096968 2.2753329          2</span></span>
<span><span class="co">## 142 142 2.1026165 2.5422417          2</span></span>
<span><span class="co">## 143 143 2.2886342 1.8319458          2</span></span>
<span><span class="co">## 144 144 2.1776268 2.3374816          2</span></span>
<span><span class="co">## 145 145 1.5588719 1.9454143          2</span></span>
<span><span class="co">## 146 146 1.8825093 2.3453191          2</span></span>
<span><span class="co">## 147 147 1.9148764 2.2067067          2</span></span>
<span><span class="co">## 148 148 1.6784828 2.1791696          2</span></span>
<span><span class="co">## 149 149 2.6871420 2.1658603          2</span></span>
<span><span class="co">## 150 150 1.9659266 2.2418448          2</span></span>
<span><span class="co">## 151 151 2.3076136 1.9209120          2</span></span>
<span><span class="co">## 152 152 2.1286580 1.5893448          2</span></span>
<span><span class="co">## 153 153 2.1198780 1.5716553          2</span></span>
<span><span class="co">## 154 154 1.6889849 2.4909070          2</span></span>
<span><span class="co">## 155 155 2.5319038 2.0462034          2</span></span>
<span><span class="co">## 156 156 1.6775532 2.0877268          2</span></span>
<span><span class="co">## 157 157 1.5363914 1.8724078          2</span></span>
<span><span class="co">## 158 158 1.8441586 2.0461562          2</span></span>
<span><span class="co">## 159 159 1.4334410 2.1694837          2</span></span>
<span><span class="co">## 160 160 1.9078268 1.6324034          2</span></span>
<span><span class="co">## 161 161 1.9057242 1.4830011          2</span></span>
<span><span class="co">## 162 162 1.5284758 1.9306908          2</span></span>
<span><span class="co">## 163 163 2.2261095 2.2329786          2</span></span>
<span><span class="co">## 164 164 1.7614955 1.7137537          2</span></span>
<span><span class="co">## 165 165 2.0477586 2.3164767          2</span></span>
<span><span class="co">## 166 166 2.0690508 2.1646896          2</span></span>
<span><span class="co">## 167 167 2.4322930 1.4581385          2</span></span>
<span><span class="co">## 168 168 2.1082711 1.8090311          2</span></span>
<span><span class="co">## 169 169 1.7642908 2.1324784          2</span></span>
<span><span class="co">## 170 170 2.0185416 2.1592019          2</span></span>
<span><span class="co">## 171 171 2.4676438 2.2975675          2</span></span>
<span><span class="co">## 172 172 2.2825955 2.0911848          2</span></span>
<span><span class="co">## 173 173 1.8407199 1.9739971          2</span></span>
<span><span class="co">## 174 174 1.5855019 2.6058717          2</span></span>
<span><span class="co">## 175 175 2.5210544 1.1823549          2</span></span>
<span><span class="co">## 176 176 2.3450794 2.3765002          2</span></span>
<span><span class="co">## 177 177 2.4556446 1.7710293          2</span></span>
<span><span class="co">## 178 178 2.1301206 2.5211041          2</span></span>
<span><span class="co">## 179 179 2.2646898 2.0758557          2</span></span>
<span><span class="co">## 180 180 1.3243252 1.8330117          2</span></span>
<span><span class="co">## 181 181 2.1736598 2.3039585          2</span></span>
<span><span class="co">## 182 182 1.7563822 1.7034834          2</span></span>
<span><span class="co">## 183 183 2.1975593 1.8682225          2</span></span>
<span><span class="co">## 184 184 1.6887688 1.9968722          2</span></span>
<span><span class="co">## 185 185 1.8380501 2.0310634          2</span></span>
<span><span class="co">## 186 186 1.7911072 2.2208284          2</span></span>
<span><span class="co">## 187 187 2.3901058 2.2512976          2</span></span>
<span><span class="co">## 188 188 2.0824695 1.8017373          2</span></span>
<span><span class="co">## 189 189 2.4825584 1.9664695          2</span></span>
<span><span class="co">## 190 190 1.9318182 2.2379403          2</span></span>
<span><span class="co">## 191 191 2.3916380 1.8901986          2</span></span>
<span><span class="co">## 192 192 2.0016698 2.0232903          2</span></span>
<span><span class="co">## 193 193 1.6624869 2.2354141          2</span></span>
<span><span class="co">## 194 194 1.7732575 2.0212683          2</span></span>
<span><span class="co">## 195 195 2.5285175 2.0724604          2</span></span>
<span><span class="co">## 196 196 2.0517766 1.4569029          2</span></span>
<span><span class="co">## 197 197 1.8793515 2.1792718          2</span></span>
<span><span class="co">## 198 198 2.0252196 1.8495164          2</span></span>
<span><span class="co">## 199 199 1.3927070 2.1275527          2</span></span>
<span><span class="co">## 200 200 1.6560387 1.5339254          2</span></span>
<span><span class="co">## 201 201 2.8245980 2.7043531          3</span></span>
<span><span class="co">## 202 202 3.3712476 2.7116695          3</span></span>
<span><span class="co">## 203 203 3.1964315 3.0749625          3</span></span>
<span><span class="co">## 204 204 2.1644290 3.1262982          3</span></span>
<span><span class="co">## 205 205 2.4539518 2.9154418          3</span></span>
<span><span class="co">## 206 206 3.2095846 3.1980655          3</span></span>
<span><span class="co">## 207 207 3.0796136 3.0002601          3</span></span>
<span><span class="co">## 208 208 2.9752658 2.5912607          3</span></span>
<span><span class="co">## 209 209 2.6763133 3.0356867          3</span></span>
<span><span class="co">## 210 210 3.0771083 2.8602302          3</span></span>
<span><span class="co">## 211 211 3.2092895 3.1218145          3</span></span>
<span><span class="co">## 212 212 2.6275983 2.7755104          3</span></span>
<span><span class="co">## 213 213 2.6188028 2.8032442          3</span></span>
<span><span class="co">## 214 214 3.1086807 3.0395545          3</span></span>
<span><span class="co">## 215 215 3.3192110 2.7239159          3</span></span>
<span><span class="co">## 216 216 2.5463100 3.4722458          3</span></span>
<span><span class="co">## 217 217 3.1917848 2.6955421          3</span></span>
<span><span class="co">## 218 218 3.7704684 2.3208809          3</span></span>
<span><span class="co">## 219 219 3.1059193 3.5998946          3</span></span>
<span><span class="co">## 220 220 3.5647069 2.8406557          3</span></span>
<span><span class="co">## 221 221 3.3940169 3.2645761          3</span></span>
<span><span class="co">## 222 222 3.2237497 2.8208562          3</span></span>
<span><span class="co">## 223 223 3.1353866 3.3957150          3</span></span>
<span><span class="co">## 224 224 3.4474581 3.1728887          3</span></span>
<span><span class="co">## 225 225 3.0116611 3.2003587          3</span></span>
<span><span class="co">## 226 226 2.9032498 3.2309624          3</span></span>
<span><span class="co">## 227 227 2.7971668 2.7751989          3</span></span>
<span><span class="co">## 228 228 3.4282511 2.9766606          3</span></span>
<span><span class="co">## 229 229 2.9803893 2.8810149          3</span></span>
<span><span class="co">## 230 230 2.8448174 2.8236056          3</span></span>
<span><span class="co">## 231 231 2.3978052 2.9643663          3</span></span>
<span><span class="co">## 232 232 2.3579432 2.7863673          3</span></span>
<span><span class="co">## 233 233 2.4712457 3.4113462          3</span></span>
<span><span class="co">## 234 234 3.0853685 3.1487178          3</span></span>
<span><span class="co">## 235 235 2.6270358 3.2884402          3</span></span>
<span><span class="co">## 236 236 2.5289633 3.0417238          3</span></span>
<span><span class="co">## 237 237 3.0185018 3.0464284          3</span></span>
<span><span class="co">## 238 238 3.0794613 3.1905905          3</span></span>
<span><span class="co">## 239 239 3.0048675 2.8510989          3</span></span>
<span><span class="co">## 240 240 3.3340404 2.6147916          3</span></span>
<span><span class="co">## 241 241 3.1950538 2.8553115          3</span></span>
<span><span class="co">## 242 242 2.8959601 2.9083909          3</span></span>
<span><span class="co">## 243 243 2.5566049 3.4670853          3</span></span>
<span><span class="co">## 244 244 3.3338760 2.4776105          3</span></span>
<span><span class="co">## 245 245 2.7978055 3.5209735          3</span></span>
<span><span class="co">## 246 246 3.0258936 3.1610647          3</span></span>
<span><span class="co">## 247 247 3.0731425 3.0566585          3</span></span>
<span><span class="co">## 248 248 3.1555109 3.1272019          3</span></span>
<span><span class="co">## 249 249 2.8937240 3.0645863          3</span></span>
<span><span class="co">## 250 250 3.0624771 2.6324183          3</span></span>
<span><span class="co">## 251 251 2.9668346 3.1390371          3</span></span>
<span><span class="co">## 252 252 3.0396503 2.8148493          3</span></span>
<span><span class="co">## 253 253 3.0257121 2.8065728          3</span></span>
<span><span class="co">## 254 254 2.7763684 2.9404265          3</span></span>
<span><span class="co">## 255 255 3.1767422 2.8929780          3</span></span>
<span><span class="co">## 256 256 3.0769801 3.2720997          3</span></span>
<span><span class="co">## 257 257 2.8881411 2.7313446          3</span></span>
<span><span class="co">## 258 258 2.6106584 3.1966053          3</span></span>
<span><span class="co">## 259 259 3.2263614 2.9406147          3</span></span>
<span><span class="co">## 260 260 3.1549076 2.2148285          3</span></span>
<span><span class="co">## 261 261 3.3483770 2.8115673          3</span></span>
<span><span class="co">## 262 262 3.1726395 3.0390642          3</span></span>
<span><span class="co">## 263 263 2.8131098 3.4943082          3</span></span>
<span><span class="co">## 264 264 2.7490266 2.9874754          3</span></span>
<span><span class="co">## 265 265 2.9106570 2.8327460          3</span></span>
<span><span class="co">## 266 266 2.4389882 2.8186104          3</span></span>
<span><span class="co">## 267 267 3.2287741 2.6297190          3</span></span>
<span><span class="co">## 268 268 2.9099028 2.9839667          3</span></span>
<span><span class="co">## 269 269 3.3419557 2.8403124          3</span></span>
<span><span class="co">## 270 270 3.3842104 2.9272434          3</span></span>
<span><span class="co">## 271 271 3.0552488 3.4290933          3</span></span>
<span><span class="co">## 272 272 2.8655934 2.7724626          3</span></span>
<span><span class="co">## 273 273 3.0591572 3.5888864          3</span></span>
<span><span class="co">## 274 274 3.1739928 3.2832737          3</span></span>
<span><span class="co">## 275 275 3.2377208 2.7682926          3</span></span>
<span><span class="co">## 276 276 3.2583176 3.2329557          3</span></span>
<span><span class="co">## 277 277 3.0747159 2.6446256          3</span></span>
<span><span class="co">## 278 278 2.8401007 3.9210475          3</span></span>
<span><span class="co">## 279 279 2.8325465 3.4236195          3</span></span>
<span><span class="co">## 280 280 3.3825222 3.0588892          3</span></span>
<span><span class="co">## 281 281 3.2161776 3.1346372          3</span></span>
<span><span class="co">## 282 282 2.8940366 3.3104659          3</span></span>
<span><span class="co">## 283 283 2.8211344 2.9506649          3</span></span>
<span><span class="co">## 284 284 2.3448742 3.6880963          3</span></span>
<span><span class="co">## 285 285 2.8165333 3.6331283          3</span></span>
<span><span class="co">## 286 286 2.7301836 3.2693776          3</span></span>
<span><span class="co">## 287 287 1.9830599 3.5042785          3</span></span>
<span><span class="co">## 288 288 3.0980625 3.1007737          3</span></span>
<span><span class="co">## 289 289 2.9083625 2.5631529          3</span></span>
<span><span class="co">## 290 290 3.3037459 2.7261910          3</span></span>
<span><span class="co">## 291 291 3.1125714 2.5009099          3</span></span>
<span><span class="co">## 292 292 3.3606121 2.6393693          3</span></span>
<span><span class="co">## 293 293 2.8054698 2.8805369          3</span></span>
<span><span class="co">## 294 294 2.8397886 2.9662385          3</span></span>
<span><span class="co">## 295 295 2.8304193 3.6515209          3</span></span>
<span><span class="co">## 296 296 3.7277042 3.0238688          3</span></span>
<span><span class="co">## 297 297 3.2053648 2.6524427          3</span></span>
<span><span class="co">## 298 298 2.9879548 3.0433323          3</span></span>
<span><span class="co">## 299 299 3.3878268 2.2310781          3</span></span>
<span><span class="co">## 300 300 2.8500946 3.2121849          3</span></span>
<span><span class="co">## 301 301 4.3476113 4.0833800          4</span></span>
<span><span class="co">## 302 302 4.0811491 4.2922800          4</span></span>
<span><span class="co">## 303 303 3.9241840 3.9615376          4</span></span>
<span><span class="co">## 304 304 4.1461873 3.6611067          4</span></span>
<span><span class="co">## 305 305 4.3604671 4.2259583          4</span></span>
<span><span class="co">## 306 306 4.0935740 3.7467551          4</span></span>
<span><span class="co">## 307 307 3.8721639 3.7883726          4</span></span>
<span><span class="co">## 308 308 3.4861016 4.3130108          4</span></span>
<span><span class="co">## 309 309 3.9020509 4.2146970          4</span></span>
<span><span class="co">## 310 310 3.8943025 4.1124451          4</span></span>
<span><span class="co">## 311 311 3.8649831 3.5956771          4</span></span>
<span><span class="co">## 312 312 3.6861914 4.2532210          4</span></span>
<span><span class="co">## 313 313 4.2667627 4.3468959          4</span></span>
<span><span class="co">## 314 314 3.7170234 4.3835279          4</span></span>
<span><span class="co">## 315 315 3.6873592 3.9572186          4</span></span>
<span><span class="co">## 316 316 3.8618723 3.8170176          4</span></span>
<span><span class="co">## 317 317 3.8910541 4.3970700          4</span></span>
<span><span class="co">## 318 318 4.0247128 3.6726218          4</span></span>
<span><span class="co">## 319 319 4.2423415 4.6445756          4</span></span>
<span><span class="co">## 320 320 3.9953988 3.7483550          4</span></span>
<span><span class="co">## 321 321 3.6700867 3.9808400          4</span></span>
<span><span class="co">## 322 322 4.0182994 3.4815520          4</span></span>
<span><span class="co">## 323 323 4.0618012 3.9696211          4</span></span>
<span><span class="co">## 324 324 3.8040993 3.7848547          4</span></span>
<span><span class="co">## 325 325 3.6878628 3.9887545          4</span></span>
<span><span class="co">## 326 326 4.3431280 4.3815871          4</span></span>
<span><span class="co">## 327 327 4.1411970 3.4125192          4</span></span>
<span><span class="co">## 328 328 4.0954998 4.2221941          4</span></span>
<span><span class="co">## 329 329 3.7182955 3.5868060          4</span></span>
<span><span class="co">## 330 330 3.9834742 3.3729089          4</span></span>
<span><span class="co">## 331 331 4.0750968 4.2559792          4</span></span>
<span><span class="co">## 332 332 3.9073358 4.3362139          4</span></span>
<span><span class="co">## 333 333 3.8886601 4.6168791          4</span></span>
<span><span class="co">## 334 334 4.5298790 4.0262013          4</span></span>
<span><span class="co">## 335 335 4.6013946 4.2254429          4</span></span>
<span><span class="co">## 336 336 4.0287620 3.7150802          4</span></span>
<span><span class="co">## 337 337 4.1396525 3.7137105          4</span></span>
<span><span class="co">## 338 338 4.1631615 3.5476991          4</span></span>
<span><span class="co">## 339 339 3.7094595 4.0050947          4</span></span>
<span><span class="co">## 340 340 3.9656169 3.7082002          4</span></span>
<span><span class="co">## 341 341 3.5007602 4.4271645          4</span></span>
<span><span class="co">## 342 342 3.9242084 3.4728176          4</span></span>
<span><span class="co">## 343 343 3.9381516 3.5472580          4</span></span>
<span><span class="co">## 344 344 4.3124886 4.0765256          4</span></span>
<span><span class="co">## 345 345 4.2112480 3.9481417          4</span></span>
<span><span class="co">## 346 346 4.0329488 4.5279996          4</span></span>
<span><span class="co">## 347 347 3.9821254 4.2913447          4</span></span>
<span><span class="co">## 348 348 4.2061152 4.4573028          4</span></span>
<span><span class="co">## 349 349 4.0189243 3.9160553          4</span></span>
<span><span class="co">## 350 350 3.8554139 4.2793872          4</span></span>
<span><span class="co">## 351 351 4.1271775 3.8450185          4</span></span>
<span><span class="co">## 352 352 3.3834456 3.8884039          4</span></span>
<span><span class="co">## 353 353 4.1096120 4.0324993          4</span></span>
<span><span class="co">## 354 354 3.7302732 3.7311135          4</span></span>
<span><span class="co">## 355 355 4.0457811 2.9616443          4</span></span>
<span><span class="co">## 356 356 4.6709243 3.6917795          4</span></span>
<span><span class="co">## 357 357 4.0006321 4.3176244          4</span></span>
<span><span class="co">## 358 358 4.1591242 4.2608237          4</span></span>
<span><span class="co">## 359 359 4.2796416 4.3260656          4</span></span>
<span><span class="co">## 360 360 3.6771400 3.9714158          4</span></span>
<span><span class="co">## 361 361 3.5142601 3.7860458          4</span></span>
<span><span class="co">## 362 362 3.8016827 3.5288225          4</span></span>
<span><span class="co">## 363 363 4.1123999 4.0279196          4</span></span>
<span><span class="co">## 364 364 3.8042529 3.9366958          4</span></span>
<span><span class="co">## 365 365 3.9386542 4.1379059          4</span></span>
<span><span class="co">## 366 366 4.3183945 3.8589133          4</span></span>
<span><span class="co">## 367 367 3.7532944 4.3636754          4</span></span>
<span><span class="co">## 368 368 4.3918052 3.5096838          4</span></span>
<span><span class="co">## 369 369 3.4698336 4.1485125          4</span></span>
<span><span class="co">## 370 370 3.9129625 3.4703048          4</span></span>
<span><span class="co">## 371 371 4.2766464 4.1842627          4</span></span>
<span><span class="co">## 372 372 3.7798053 4.0074826          4</span></span>
<span><span class="co">## 373 373 4.3901014 3.9622655          4</span></span>
<span><span class="co">## 374 374 3.6973581 3.8136761          4</span></span>
<span><span class="co">## 375 375 4.6932017 3.7682068          4</span></span>
<span><span class="co">## 376 376 3.9748930 3.8995107          4</span></span>
<span><span class="co">## 377 377 3.7265317 3.7053186          4</span></span>
<span><span class="co">## 378 378 4.5699700 4.2297142          4</span></span>
<span><span class="co">## 379 379 3.9122306 4.3860119          4</span></span>
<span><span class="co">## 380 380 4.1433704 3.3385204          4</span></span>
<span><span class="co">## 381 381 3.9289711 4.1553022          4</span></span>
<span><span class="co">## 382 382 3.7715241 4.0812221          4</span></span>
<span><span class="co">## 383 383 4.1651317 3.9553057          4</span></span>
<span><span class="co">## 384 384 3.7942889 4.0815295          4</span></span>
<span><span class="co">## 385 385 4.1767359 3.8394400          4</span></span>
<span><span class="co">## 386 386 4.0917468 3.7860130          4</span></span>
<span><span class="co">## 387 387 4.6132600 3.8110521          4</span></span>
<span><span class="co">## 388 388 3.7314267 3.9432055          4</span></span>
<span><span class="co">## 389 389 3.8863206 4.4865011          4</span></span>
<span><span class="co">## 390 390 4.2266712 4.2910643          4</span></span>
<span><span class="co">## 391 391 3.7471674 3.8587951          4</span></span>
<span><span class="co">## 392 392 3.9256410 3.9401889          4</span></span>
<span><span class="co">## 393 393 4.3848105 4.2453839          4</span></span>
<span><span class="co">## 394 394 4.1118215 3.9360279          4</span></span>
<span><span class="co">## 395 395 4.2539791 3.7915140          4</span></span>
<span><span class="co">## 396 396 4.1089845 3.4686990          4</span></span>
<span><span class="co">## 397 397 3.6151247 4.4387316          4</span></span>
<span><span class="co">## 398 398 4.4765113 4.2012565          4</span></span>
<span><span class="co">## 399 399 4.1399433 3.6851421          4</span></span>
<span><span class="co">## 400 400 4.1300059 4.2514147          4</span></span>
<span><span class="co">## 401 401 5.3343839 4.7920910          5</span></span>
<span><span class="co">## 402 402 4.9959306 4.9221884          5</span></span>
<span><span class="co">## 403 403 4.6923458 4.3572358          5</span></span>
<span><span class="co">## 404 404 4.7261569 5.2192036          5</span></span>
<span><span class="co">## 405 405 4.6762163 4.8466997          5</span></span>
<span><span class="co">## 406 406 5.1930712 5.1130384          5</span></span>
<span><span class="co">## 407 407 4.7928630 4.9080253          5</span></span>
<span><span class="co">## 408 408 4.8593605 5.2764635          5</span></span>
<span><span class="co">## 409 409 4.6852745 4.7430760          5</span></span>
<span><span class="co">## 410 410 4.6242546 4.6773451          5</span></span>
<span><span class="co">## 411 411 5.1301263 4.7942656          5</span></span>
<span><span class="co">## 412 412 5.3397536 5.3932975          5</span></span>
<span><span class="co">## 413 413 5.6417151 4.9321350          5</span></span>
<span><span class="co">## 414 414 5.3773583 4.9729154          5</span></span>
<span><span class="co">## 415 415 5.2176663 5.3715613          5</span></span>
<span><span class="co">## 416 416 4.7635133 4.7865542          5</span></span>
<span><span class="co">## 417 417 5.0097447 4.1841061          5</span></span>
<span><span class="co">## 418 418 5.2998103 4.9666848          5</span></span>
<span><span class="co">## 419 419 5.0312908 4.3089380          5</span></span>
<span><span class="co">## 420 420 5.0576325 5.0593560          5</span></span>
<span><span class="co">## 421 421 4.8765537 5.1586615          5</span></span>
<span><span class="co">## 422 422 5.0218617 4.9290106          5</span></span>
<span><span class="co">## 423 423 4.8379250 5.0568355          5</span></span>
<span><span class="co">## 424 424 5.2032534 5.3463638          5</span></span>
<span><span class="co">## 425 425 4.2012186 4.4618072          5</span></span>
<span><span class="co">## 426 426 4.9080355 5.1334754          5</span></span>
<span><span class="co">## 427 427 4.9594344 5.0196659          5</span></span>
<span><span class="co">## 428 428 4.8297422 4.6801578          5</span></span>
<span><span class="co">## 429 429 5.0389111 5.2466981          5</span></span>
<span><span class="co">## 430 430 4.8243611 5.0674834          5</span></span>
<span><span class="co">## 431 431 5.0103149 5.4932616          5</span></span>
<span><span class="co">## 432 432 4.2371489 5.2139609          5</span></span>
<span><span class="co">## 433 433 5.2539687 4.7847469          5</span></span>
<span><span class="co">## 434 434 5.5845605 5.1680419          5</span></span>
<span><span class="co">## 435 435 4.8284386 5.2815980          5</span></span>
<span><span class="co">## 436 436 4.8749062 4.7235893          5</span></span>
<span><span class="co">## 437 437 5.8172448 4.8092533          5</span></span>
<span><span class="co">## 438 438 5.0760002 4.4172800          5</span></span>
<span><span class="co">## 439 439 5.0194589 5.4063744          5</span></span>
<span><span class="co">## 440 440 5.1293335 5.3807414          5</span></span>
<span><span class="co">## 441 441 5.1191819 5.2209016          5</span></span>
<span><span class="co">## 442 442 5.0445426 5.2475333          5</span></span>
<span><span class="co">## 443 443 4.6287564 5.0548766          5</span></span>
<span><span class="co">## 444 444 5.2118409 4.9032582          5</span></span>
<span><span class="co">## 445 445 5.6638959 5.0523344          5</span></span>
<span><span class="co">## 446 446 5.3145530 5.1930416          5</span></span>
<span><span class="co">## 447 447 4.4570645 5.4607618          5</span></span>
<span><span class="co">## 448 448 5.0760689 4.6763538          5</span></span>
<span><span class="co">## 449 449 5.0381747 5.1496774          5</span></span>
<span><span class="co">## 450 450 4.8272057 5.3364948          5</span></span>
<span><span class="co">## 451 451 4.7808727 5.0235064          5</span></span>
<span><span class="co">## 452 452 5.2945529 4.8962242          5</span></span>
<span><span class="co">## 453 453 5.4757443 5.1899469          5</span></span>
<span><span class="co">## 454 454 4.7182740 4.9672040          5</span></span>
<span><span class="co">## 455 455 5.2682671 4.4839289          5</span></span>
<span><span class="co">## 456 456 5.0331961 5.0106834          5</span></span>
<span><span class="co">## 457 457 5.1217395 5.1115765          5</span></span>
<span><span class="co">## 458 458 4.8037793 4.7892040          5</span></span>
<span><span class="co">## 459 459 5.4020159 4.7253572          5</span></span>
<span><span class="co">## 460 460 5.5096393 5.1352760          5</span></span>
<span><span class="co">## 461 461 5.2080385 4.8186683          5</span></span>
<span><span class="co">## 462 462 5.1271320 5.3816297          5</span></span>
<span><span class="co">## 463 463 4.9592384 5.0394938          5</span></span>
<span><span class="co">## 464 464 5.0895444 4.9383306          5</span></span>
<span><span class="co">## 465 465 4.9013956 4.9615092          5</span></span>
<span><span class="co">## 466 466 4.6300329 4.9853191          5</span></span>
<span><span class="co">## 467 467 5.1639580 4.7844373          5</span></span>
<span><span class="co">## 468 468 5.0421553 4.9330479          5</span></span>
<span><span class="co">## 469 469 4.4318750 4.9100666          5</span></span>
<span><span class="co">## 470 470 5.0647101 4.7918841          5</span></span>
<span><span class="co">## 471 471 4.4391316 4.5769057          5</span></span>
<span><span class="co">## 472 472 4.8541755 5.2877469          5</span></span>
<span><span class="co">## 473 473 5.2544497 4.8715962          5</span></span>
<span><span class="co">## 474 474 5.3549912 5.2071717          5</span></span>
<span><span class="co">## 475 475 4.3945679 5.0108248          5</span></span>
<span><span class="co">## 476 476 4.6416200 5.5223492          5</span></span>
<span><span class="co">## 477 477 4.9352093 4.9834198          5</span></span>
<span><span class="co">## 478 478 4.9855329 5.2227229          5</span></span>
<span><span class="co">## 479 479 5.4272300 4.8673243          5</span></span>
<span><span class="co">## 480 480 5.2161602 4.5831224          5</span></span>
<span><span class="co">## 481 481 4.7548856 4.9095649          5</span></span>
<span><span class="co">## 482 482 4.8043153 5.0517028          5</span></span>
<span><span class="co">## 483 483 4.9251742 4.8908952          5</span></span>
<span><span class="co">## 484 484 5.1209896 4.5090521          5</span></span>
<span><span class="co">## 485 485 5.0853067 5.1741574          5</span></span>
<span><span class="co">## 486 486 5.1619070 4.9207909          5</span></span>
<span><span class="co">## 487 487 5.1559873 5.1271740          5</span></span>
<span><span class="co">## 488 488 4.6709052 5.3782679          5</span></span>
<span><span class="co">## 489 489 5.0309160 4.9045341          5</span></span>
<span><span class="co">## 490 490 5.0791769 4.6635926          5</span></span>
<span><span class="co">## 491 491 4.7949350 4.6975622          5</span></span>
<span><span class="co">## 492 492 5.3660370 4.0646708          5</span></span>
<span><span class="co">## 493 493 5.2729691 5.2634901          5</span></span>
<span><span class="co">## 494 494 4.4840541 4.7187407          5</span></span>
<span><span class="co">## 495 495 5.3028545 5.1858557          5</span></span>
<span><span class="co">## 496 496 5.1142745 4.9687492          5</span></span>
<span><span class="co">## 497 497 5.3958797 5.5934658          5</span></span>
<span><span class="co">## 498 498 4.6283699 4.7587944          5</span></span>
<span><span class="co">## 499 499 4.5387547 4.9756455          5</span></span>
<span><span class="co">## 500 500 4.9658920 4.7929955          5</span></span></code></pre>
<p>This is how our data looks like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now we can cluster it using kmeans++:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_for_clust</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data_for_clust</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## id column: id</span></span></code></pre>
<pre><code><span><span class="co">## KMEans: will generate seeds</span></span>
<span><span class="co">## KMeans into generate seeds</span></span>
<span><span class="co">## at seed 0</span></span>
<span><span class="co">## add new core from 122 to 0</span></span>
<span><span class="co">## at seed 1</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 350 450</span></span>
<span><span class="co">## picked up 427 dist was 2.01345</span></span>
<span><span class="co">## add new core from 427 to 1</span></span>
<span><span class="co">## at seed 2</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 300 400</span></span>
<span><span class="co">## picked up 223 dist was 0.996243</span></span>
<span><span class="co">## add new core from 223 to 2</span></span>
<span><span class="co">## at seed 3</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 250 350</span></span>
<span><span class="co">## picked up 382 dist was 0.570931</span></span>
<span><span class="co">## add new core from 382 to 3</span></span>
<span><span class="co">## at seed 4</span></span>
<span><span class="co">## done update min distance</span></span>
<span><span class="co">## seed range 200 300</span></span>
<span><span class="co">## picked up 231 dist was 0.457457</span></span>
<span><span class="co">## add new core from 231 to 4</span></span>
<span><span class="co">## KMEans: reassign after init</span></span>
<span><span class="co">## KMEans: iter 0</span></span>
<span><span class="co">## KMEans: iter 1 changed 23</span></span>
<span><span class="co">## KMEans: iter 1</span></span>
<span><span class="co">## KMEans: iter 2 changed 54</span></span>
<span><span class="co">## KMEans: iter 2</span></span>
<span><span class="co">## KMEans: iter 3 changed 31</span></span>
<span><span class="co">## KMEans: iter 3</span></span>
<span><span class="co">## KMEans: iter 4 changed 9</span></span>
<span><span class="co">## KMEans: iter 4</span></span>
<span><span class="co">## KMEans: iter 5 changed 1</span></span>
<span><span class="co">## KMEans: iter 5</span></span>
<span><span class="co">## KMEans: iter 6 changed 0</span></span></code></pre>
<p>The returned list contains 3 fields:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">km</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "centers" "cluster" "size"</span></span></code></pre>
<p><code>km$centers</code> contains a tibble with <code>clust</code>
column and the cluster centers:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1  4.02 3.98 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2  1.02 0.989</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3  5.01 4.98 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4  2.99 3.01 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5  2.01 2.04</span></span></code></pre>
<p>clusters are numbered according to <code>order_func</code> (see
‘Custom cluster ordering’ section).</p>
<p><code>km$cluster</code> contains tibble with <code>id</code> column
with the observation id (<code>1:n</code> if no id column was supplied),
and <code>clust</code> column with the observation assigned cluster:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">cluster</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 500 × 2</span></span></span>
<span><span class="co">##    id    clust</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 2         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 5         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 6         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 7         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 8         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 9         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 10        2</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre>
<p><code>km$size</code> contains tibble with <code>clust</code> column
and <code>n</code> column with the number of points in each cluster:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span><span class="op">$</span><span class="va">size</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">##   clust     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1   101</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2    99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3    99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5   101</span></span></code></pre>
<p>We can now check our clustering performance - fraction of
observations that were classified correctly (Note that
<code>match_clusters</code> function is internal to the package and is
used only in this vignette):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.996</span></span></code></pre>
<p>And plot the results:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="custom-cluster-ordering">Custom cluster ordering<a class="anchor" aria-label="anchor" href="#custom-cluster-ordering"></a>
</h2>
<p>By default, the clusters where ordered using the following function:
<code>hclust(dist(cor(t(centers))))</code> - hclust of the euclidean
distance of the correlation matrix of the centers.</p>
<p>We can supply our own function to order the clusters using
<code>reorder_func</code> argument. The function would be applied to
each center and he clusters would be ordered by the result.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    reorder_func <span class="op">=</span> <span class="va">median</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km</span><span class="op">$</span><span class="va">centers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   clust    V1    V2</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1  1.02 0.989</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2  2.01 2.04 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3  2.99 3.01 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4  4.02 3.98 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5  5.01 4.98</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>tglkmeans can deal with missing data, as long as at least one
dimension is not missing. for example:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">##      id        V1        V2 true_clust</span></span>
<span><span class="co">## 1     1 0.8188280 0.9966275          1</span></span>
<span><span class="co">## 2     2 0.5961526 0.2448524          1</span></span>
<span><span class="co">## 3     3 1.2878798 0.9523234          1</span></span>
<span><span class="co">## 4     4 1.1452386 0.6845486          1</span></span>
<span><span class="co">## 5     5 1.0367838 1.4471093          1</span></span>
<span><span class="co">## 6     6 1.0661379 1.0775916          1</span></span>
<span><span class="co">## 7     7        NA 1.5427066          1</span></span>
<span><span class="co">## 8     8 1.1959286 0.8973236          1</span></span>
<span><span class="co">## 9     9 0.4938583 0.8645343          1</span></span>
<span><span class="co">## 10   10 0.9362103 1.4175774          1</span></span>
<span><span class="co">## 11   11 1.3010990 1.2781073          1</span></span>
<span><span class="co">## 12   12 0.7896602 0.7255738          1</span></span>
<span><span class="co">## 13   13 1.7323458 1.4555507          1</span></span>
<span><span class="co">## 14   14 1.5428318 1.3004856          1</span></span>
<span><span class="co">## 15   15 1.4443598 0.6687689          1</span></span>
<span><span class="co">## 16   16 1.0905494 1.0800339          1</span></span>
<span><span class="co">## 17   17 1.1887296 0.5036605          1</span></span>
<span><span class="co">## 18   18 0.6295992 0.9537295          1</span></span>
<span><span class="co">## 19   19 1.1028873 0.9398331          1</span></span>
<span><span class="co">## 20   20 0.7775887 1.1541446          1</span></span>
<span><span class="co">## 21   21 0.9834659 1.2391041          1</span></span>
<span><span class="co">## 22   22 1.0567297 0.9482430          1</span></span>
<span><span class="co">## 23   23 1.1697952 1.2713699          1</span></span>
<span><span class="co">## 24   24 1.3895388 0.9061066          1</span></span>
<span><span class="co">## 25   25 0.6008567 1.1828310          1</span></span>
<span><span class="co">## 26   26        NA 0.7786776          1</span></span>
<span><span class="co">## 27   27 1.4263896 0.6263562          1</span></span>
<span><span class="co">## 28   28        NA 1.0710904          1</span></span>
<span><span class="co">## 29   29 1.0112142 0.5677481          1</span></span>
<span><span class="co">## 30   30 0.9504909 0.9925098          1</span></span>
<span><span class="co">## 31   31 1.1952104 0.8910515          1</span></span>
<span><span class="co">## 32   32 1.6321424 0.9500865          1</span></span>
<span><span class="co">## 33   33        NA 0.8080582          1</span></span>
<span><span class="co">## 34   34 1.2120664 1.0385841          1</span></span>
<span><span class="co">## 35   35 0.8633086 1.4675713          1</span></span>
<span><span class="co">## 36   36 1.0841344 1.1837852          1</span></span>
<span><span class="co">## 37   37        NA 0.3909947          1</span></span>
<span><span class="co">## 38   38 1.1010060 0.7308528          1</span></span>
<span><span class="co">## 39   39 1.4241218 1.2565578          1</span></span>
<span><span class="co">## 40   40 1.1928094 0.9454138          1</span></span>
<span><span class="co">## 41   41 1.3010064 0.3877956          1</span></span>
<span><span class="co">## 42   42 1.1680418 0.7626537          1</span></span>
<span><span class="co">## 43   43 0.8216290 0.8531213          1</span></span>
<span><span class="co">## 44   44        NA 0.2971495          1</span></span>
<span><span class="co">## 45   45 1.0308020 1.1113343          1</span></span>
<span><span class="co">## 46   46        NA 1.5073288          1</span></span>
<span><span class="co">## 47   47        NA 0.5243866          1</span></span>
<span><span class="co">## 48   48 0.9465606 0.8816125          1</span></span>
<span><span class="co">## 49   49 0.7917819 1.1821391          1</span></span>
<span><span class="co">## 50   50 1.2882612 1.4308688          1</span></span>
<span><span class="co">## 51   51 1.1385981 1.2664792          1</span></span>
<span><span class="co">## 52   52 0.6151377 1.2244604          1</span></span>
<span><span class="co">## 53   53 1.1247607 0.8190489          1</span></span>
<span><span class="co">## 54   54 1.1720667 0.8203357          1</span></span>
<span><span class="co">## 55   55 0.6160849 0.9561350          1</span></span>
<span><span class="co">## 56   56 1.2925343 0.8188187          1</span></span>
<span><span class="co">## 57   57 1.1212146 1.1476306          1</span></span>
<span><span class="co">## 58   58 1.1746002 0.9714103          1</span></span>
<span><span class="co">## 59   59        NA 0.8700007          1</span></span>
<span><span class="co">## 60   60 0.6578205 1.2859991          1</span></span>
<span><span class="co">## 61   61        NA 1.2332100          1</span></span>
<span><span class="co">## 62   62 0.7195622 0.9444836          1</span></span>
<span><span class="co">## 63   63 0.8810501 1.0161335          1</span></span>
<span><span class="co">## 64   64 1.3047780 1.0161465          1</span></span>
<span><span class="co">## 65   65 1.5101158 1.0142607          1</span></span>
<span><span class="co">## 66   66        NA 1.0243621          1</span></span>
<span><span class="co">## 67   67        NA 1.0571703          1</span></span>
<span><span class="co">## 68   68 0.9511783 0.5074623          1</span></span>
<span><span class="co">## 69   69 0.9803648 0.8485589          1</span></span>
<span><span class="co">## 70   70 0.6296381 1.1637192          1</span></span>
<span><span class="co">## 71   71 0.4285077 0.6146679          1</span></span>
<span><span class="co">## 72   72 0.7287063 1.7449338          1</span></span>
<span><span class="co">## 73   73 0.8192213 0.7427164          1</span></span>
<span><span class="co">## 74   74 1.0440940 1.1987677          1</span></span>
<span><span class="co">## 75   75 1.1274625 1.0436112          1</span></span>
<span><span class="co">## 76   76        NA 0.9396261          1</span></span>
<span><span class="co">## 77   77 1.1507294 1.0595235          1</span></span>
<span><span class="co">## 78   78        NA 0.6634640          1</span></span>
<span><span class="co">## 79   79 0.4462272 1.5636335          1</span></span>
<span><span class="co">## 80   80 1.2496639 0.9142423          1</span></span>
<span><span class="co">## 81   81 1.2590981 0.9400401          1</span></span>
<span><span class="co">## 82   82 0.8757597 1.2123659          1</span></span>
<span><span class="co">## 83   83 1.2154681 1.1794770          1</span></span>
<span><span class="co">## 84   84        NA 0.5346539          1</span></span>
<span><span class="co">## 85   85        NA 1.4565610          1</span></span>
<span><span class="co">## 86   86 0.6964748 1.1775595          1</span></span>
<span><span class="co">## 87   87 1.0114122 1.2574625          1</span></span>
<span><span class="co">## 88   88 1.1414979 1.2283909          1</span></span>
<span><span class="co">## 89   89 1.4588612 0.3611688          1</span></span>
<span><span class="co">## 90   90 0.8550975 0.7043796          1</span></span>
<span><span class="co">## 91   91 1.4067225 1.2387041          1</span></span>
<span><span class="co">## 92   92 0.7777326 0.9703458          1</span></span>
<span><span class="co">## 93   93 1.1601545 0.8219973          1</span></span>
<span><span class="co">## 94   94 0.6799122 1.0370679          1</span></span>
<span><span class="co">## 95   95 0.6488871 1.3094400          1</span></span>
<span><span class="co">## 96   96 1.2678301 0.9081572          1</span></span>
<span><span class="co">## 97   97 1.0237648 1.2748075          1</span></span>
<span><span class="co">## 98   98 1.2108471 1.0895608          1</span></span>
<span><span class="co">## 99   99        NA 1.1215119          1</span></span>
<span><span class="co">## 100 100 1.4800307 0.6977767          1</span></span>
<span><span class="co">## 101 101 2.2010873 1.9024262          2</span></span>
<span><span class="co">## 102 102 1.9975286 2.0254427          2</span></span>
<span><span class="co">## 103 103        NA 2.2296135          2</span></span>
<span><span class="co">## 104 104 2.3745574 1.8402332          2</span></span>
<span><span class="co">## 105 105 2.2290987 2.1758514          2</span></span>
<span><span class="co">## 106 106 1.6659972 2.1831748          2</span></span>
<span><span class="co">## 107 107 1.4149340 2.4277871          2</span></span>
<span><span class="co">## 108 108 2.2377821 2.3850042          2</span></span>
<span><span class="co">## 109 109 2.3617725 1.8804781          2</span></span>
<span><span class="co">## 110 110        NA 2.1104521          2</span></span>
<span><span class="co">## 111 111        NA 1.5948683          2</span></span>
<span><span class="co">## 112 112        NA 2.0777955          2</span></span>
<span><span class="co">## 113 113 2.5061933 1.7615562          2</span></span>
<span><span class="co">## 114 114 1.9883697 1.5982726          2</span></span>
<span><span class="co">## 115 115        NA 2.0171946          2</span></span>
<span><span class="co">## 116 116        NA 2.1219282          2</span></span>
<span><span class="co">## 117 117 1.2333152 1.8659345          2</span></span>
<span><span class="co">## 118 118 2.2211346 2.0789490          2</span></span>
<span><span class="co">## 119 119 1.5232200 2.1219369          2</span></span>
<span><span class="co">## 120 120        NA 2.0486167          2</span></span>
<span><span class="co">## 121 121 1.8603712 2.5316977          2</span></span>
<span><span class="co">## 122 122 2.0924361 2.2920710          2</span></span>
<span><span class="co">## 123 123 1.8069465 1.8170792          2</span></span>
<span><span class="co">## 124 124 1.8753251 2.0522120          2</span></span>
<span><span class="co">## 125 125 1.7531796 2.2579903          2</span></span>
<span><span class="co">## 126 126 2.1118428 2.0869394          2</span></span>
<span><span class="co">## 127 127        NA 2.2119830          2</span></span>
<span><span class="co">## 128 128        NA 1.9924477          2</span></span>
<span><span class="co">## 129 129 2.5880837 1.9463810          2</span></span>
<span><span class="co">## 130 130 2.0240974 2.1448038          2</span></span>
<span><span class="co">## 131 131 2.1545785 1.9333252          2</span></span>
<span><span class="co">## 132 132        NA 2.4442252          2</span></span>
<span><span class="co">## 133 133 2.2157441 2.3436415          2</span></span>
<span><span class="co">## 134 134 1.9452814 1.8008444          2</span></span>
<span><span class="co">## 135 135        NA 1.9167961          2</span></span>
<span><span class="co">## 136 136 1.3995928 2.6015746          2</span></span>
<span><span class="co">## 137 137 2.2144193 1.8485561          2</span></span>
<span><span class="co">## 138 138 1.7204685 2.2934480          2</span></span>
<span><span class="co">## 139 139        NA 1.5526403          2</span></span>
<span><span class="co">## 140 140 1.6924195 2.2490631          2</span></span>
<span><span class="co">## 141 141 2.2096968 2.2753329          2</span></span>
<span><span class="co">## 142 142 2.1026165 2.5422417          2</span></span>
<span><span class="co">## 143 143 2.2886342 1.8319458          2</span></span>
<span><span class="co">## 144 144 2.1776268 2.3374816          2</span></span>
<span><span class="co">## 145 145 1.5588719 1.9454143          2</span></span>
<span><span class="co">## 146 146 1.8825093 2.3453191          2</span></span>
<span><span class="co">## 147 147 1.9148764 2.2067067          2</span></span>
<span><span class="co">## 148 148 1.6784828 2.1791696          2</span></span>
<span><span class="co">## 149 149 2.6871420 2.1658603          2</span></span>
<span><span class="co">## 150 150 1.9659266 2.2418448          2</span></span>
<span><span class="co">## 151 151 2.3076136 1.9209120          2</span></span>
<span><span class="co">## 152 152 2.1286580 1.5893448          2</span></span>
<span><span class="co">## 153 153 2.1198780 1.5716553          2</span></span>
<span><span class="co">## 154 154 1.6889849 2.4909070          2</span></span>
<span><span class="co">## 155 155 2.5319038 2.0462034          2</span></span>
<span><span class="co">## 156 156 1.6775532 2.0877268          2</span></span>
<span><span class="co">## 157 157        NA 1.8724078          2</span></span>
<span><span class="co">## 158 158        NA 2.0461562          2</span></span>
<span><span class="co">## 159 159 1.4334410 2.1694837          2</span></span>
<span><span class="co">## 160 160 1.9078268 1.6324034          2</span></span>
<span><span class="co">## 161 161 1.9057242 1.4830011          2</span></span>
<span><span class="co">## 162 162 1.5284758 1.9306908          2</span></span>
<span><span class="co">## 163 163 2.2261095 2.2329786          2</span></span>
<span><span class="co">## 164 164 1.7614955 1.7137537          2</span></span>
<span><span class="co">## 165 165 2.0477586 2.3164767          2</span></span>
<span><span class="co">## 166 166        NA 2.1646896          2</span></span>
<span><span class="co">## 167 167 2.4322930 1.4581385          2</span></span>
<span><span class="co">## 168 168 2.1082711 1.8090311          2</span></span>
<span><span class="co">## 169 169 1.7642908 2.1324784          2</span></span>
<span><span class="co">## 170 170        NA 2.1592019          2</span></span>
<span><span class="co">## 171 171 2.4676438 2.2975675          2</span></span>
<span><span class="co">## 172 172 2.2825955 2.0911848          2</span></span>
<span><span class="co">## 173 173 1.8407199 1.9739971          2</span></span>
<span><span class="co">## 174 174        NA 2.6058717          2</span></span>
<span><span class="co">## 175 175 2.5210544 1.1823549          2</span></span>
<span><span class="co">## 176 176 2.3450794 2.3765002          2</span></span>
<span><span class="co">## 177 177 2.4556446 1.7710293          2</span></span>
<span><span class="co">## 178 178        NA 2.5211041          2</span></span>
<span><span class="co">## 179 179        NA 2.0758557          2</span></span>
<span><span class="co">## 180 180 1.3243252 1.8330117          2</span></span>
<span><span class="co">## 181 181        NA 2.3039585          2</span></span>
<span><span class="co">## 182 182 1.7563822 1.7034834          2</span></span>
<span><span class="co">## 183 183 2.1975593 1.8682225          2</span></span>
<span><span class="co">## 184 184 1.6887688 1.9968722          2</span></span>
<span><span class="co">## 185 185 1.8380501 2.0310634          2</span></span>
<span><span class="co">## 186 186 1.7911072 2.2208284          2</span></span>
<span><span class="co">## 187 187 2.3901058 2.2512976          2</span></span>
<span><span class="co">## 188 188 2.0824695 1.8017373          2</span></span>
<span><span class="co">## 189 189 2.4825584 1.9664695          2</span></span>
<span><span class="co">## 190 190 1.9318182 2.2379403          2</span></span>
<span><span class="co">## 191 191 2.3916380 1.8901986          2</span></span>
<span><span class="co">## 192 192 2.0016698 2.0232903          2</span></span>
<span><span class="co">## 193 193 1.6624869 2.2354141          2</span></span>
<span><span class="co">## 194 194        NA 2.0212683          2</span></span>
<span><span class="co">## 195 195 2.5285175 2.0724604          2</span></span>
<span><span class="co">## 196 196        NA 1.4569029          2</span></span>
<span><span class="co">## 197 197 1.8793515 2.1792718          2</span></span>
<span><span class="co">## 198 198        NA 1.8495164          2</span></span>
<span><span class="co">## 199 199        NA 2.1275527          2</span></span>
<span><span class="co">## 200 200 1.6560387 1.5339254          2</span></span>
<span><span class="co">## 201 201 2.8245980 2.7043531          3</span></span>
<span><span class="co">## 202 202 3.3712476 2.7116695          3</span></span>
<span><span class="co">## 203 203        NA 3.0749625          3</span></span>
<span><span class="co">## 204 204 2.1644290 3.1262982          3</span></span>
<span><span class="co">## 205 205        NA 2.9154418          3</span></span>
<span><span class="co">## 206 206 3.2095846 3.1980655          3</span></span>
<span><span class="co">## 207 207 3.0796136 3.0002601          3</span></span>
<span><span class="co">## 208 208 2.9752658 2.5912607          3</span></span>
<span><span class="co">## 209 209 2.6763133 3.0356867          3</span></span>
<span><span class="co">## 210 210 3.0771083 2.8602302          3</span></span>
<span><span class="co">## 211 211 3.2092895 3.1218145          3</span></span>
<span><span class="co">## 212 212 2.6275983 2.7755104          3</span></span>
<span><span class="co">## 213 213 2.6188028 2.8032442          3</span></span>
<span><span class="co">## 214 214 3.1086807 3.0395545          3</span></span>
<span><span class="co">## 215 215        NA 2.7239159          3</span></span>
<span><span class="co">## 216 216 2.5463100 3.4722458          3</span></span>
<span><span class="co">## 217 217 3.1917848 2.6955421          3</span></span>
<span><span class="co">## 218 218 3.7704684 2.3208809          3</span></span>
<span><span class="co">## 219 219 3.1059193 3.5998946          3</span></span>
<span><span class="co">## 220 220 3.5647069 2.8406557          3</span></span>
<span><span class="co">## 221 221 3.3940169 3.2645761          3</span></span>
<span><span class="co">## 222 222 3.2237497 2.8208562          3</span></span>
<span><span class="co">## 223 223 3.1353866 3.3957150          3</span></span>
<span><span class="co">## 224 224 3.4474581 3.1728887          3</span></span>
<span><span class="co">## 225 225        NA 3.2003587          3</span></span>
<span><span class="co">## 226 226 2.9032498 3.2309624          3</span></span>
<span><span class="co">## 227 227 2.7971668 2.7751989          3</span></span>
<span><span class="co">## 228 228 3.4282511 2.9766606          3</span></span>
<span><span class="co">## 229 229 2.9803893 2.8810149          3</span></span>
<span><span class="co">## 230 230 2.8448174 2.8236056          3</span></span>
<span><span class="co">## 231 231 2.3978052 2.9643663          3</span></span>
<span><span class="co">## 232 232 2.3579432 2.7863673          3</span></span>
<span><span class="co">## 233 233 2.4712457 3.4113462          3</span></span>
<span><span class="co">## 234 234 3.0853685 3.1487178          3</span></span>
<span><span class="co">## 235 235        NA 3.2884402          3</span></span>
<span><span class="co">## 236 236 2.5289633 3.0417238          3</span></span>
<span><span class="co">## 237 237 3.0185018 3.0464284          3</span></span>
<span><span class="co">## 238 238 3.0794613 3.1905905          3</span></span>
<span><span class="co">## 239 239 3.0048675 2.8510989          3</span></span>
<span><span class="co">## 240 240 3.3340404 2.6147916          3</span></span>
<span><span class="co">## 241 241 3.1950538 2.8553115          3</span></span>
<span><span class="co">## 242 242 2.8959601 2.9083909          3</span></span>
<span><span class="co">## 243 243 2.5566049 3.4670853          3</span></span>
<span><span class="co">## 244 244        NA 2.4776105          3</span></span>
<span><span class="co">## 245 245 2.7978055 3.5209735          3</span></span>
<span><span class="co">## 246 246 3.0258936 3.1610647          3</span></span>
<span><span class="co">## 247 247        NA 3.0566585          3</span></span>
<span><span class="co">## 248 248 3.1555109 3.1272019          3</span></span>
<span><span class="co">## 249 249        NA 3.0645863          3</span></span>
<span><span class="co">## 250 250 3.0624771 2.6324183          3</span></span>
<span><span class="co">## 251 251 2.9668346 3.1390371          3</span></span>
<span><span class="co">## 252 252        NA 2.8148493          3</span></span>
<span><span class="co">## 253 253 3.0257121 2.8065728          3</span></span>
<span><span class="co">## 254 254        NA 2.9404265          3</span></span>
<span><span class="co">## 255 255 3.1767422 2.8929780          3</span></span>
<span><span class="co">## 256 256 3.0769801 3.2720997          3</span></span>
<span><span class="co">## 257 257 2.8881411 2.7313446          3</span></span>
<span><span class="co">## 258 258 2.6106584 3.1966053          3</span></span>
<span><span class="co">## 259 259 3.2263614 2.9406147          3</span></span>
<span><span class="co">## 260 260        NA 2.2148285          3</span></span>
<span><span class="co">## 261 261 3.3483770 2.8115673          3</span></span>
<span><span class="co">## 262 262 3.1726395 3.0390642          3</span></span>
<span><span class="co">## 263 263 2.8131098 3.4943082          3</span></span>
<span><span class="co">## 264 264        NA 2.9874754          3</span></span>
<span><span class="co">## 265 265 2.9106570 2.8327460          3</span></span>
<span><span class="co">## 266 266        NA 2.8186104          3</span></span>
<span><span class="co">## 267 267 3.2287741 2.6297190          3</span></span>
<span><span class="co">## 268 268 2.9099028 2.9839667          3</span></span>
<span><span class="co">## 269 269 3.3419557 2.8403124          3</span></span>
<span><span class="co">## 270 270 3.3842104 2.9272434          3</span></span>
<span><span class="co">## 271 271 3.0552488 3.4290933          3</span></span>
<span><span class="co">## 272 272 2.8655934 2.7724626          3</span></span>
<span><span class="co">## 273 273 3.0591572 3.5888864          3</span></span>
<span><span class="co">## 274 274 3.1739928 3.2832737          3</span></span>
<span><span class="co">## 275 275 3.2377208 2.7682926          3</span></span>
<span><span class="co">## 276 276 3.2583176 3.2329557          3</span></span>
<span><span class="co">## 277 277        NA 2.6446256          3</span></span>
<span><span class="co">## 278 278 2.8401007 3.9210475          3</span></span>
<span><span class="co">## 279 279        NA 3.4236195          3</span></span>
<span><span class="co">## 280 280 3.3825222 3.0588892          3</span></span>
<span><span class="co">## 281 281 3.2161776 3.1346372          3</span></span>
<span><span class="co">## 282 282 2.8940366 3.3104659          3</span></span>
<span><span class="co">## 283 283        NA 2.9506649          3</span></span>
<span><span class="co">## 284 284 2.3448742 3.6880963          3</span></span>
<span><span class="co">## 285 285 2.8165333 3.6331283          3</span></span>
<span><span class="co">## 286 286        NA 3.2693776          3</span></span>
<span><span class="co">## 287 287 1.9830599 3.5042785          3</span></span>
<span><span class="co">## 288 288 3.0980625 3.1007737          3</span></span>
<span><span class="co">## 289 289 2.9083625 2.5631529          3</span></span>
<span><span class="co">## 290 290 3.3037459 2.7261910          3</span></span>
<span><span class="co">## 291 291 3.1125714 2.5009099          3</span></span>
<span><span class="co">## 292 292 3.3606121 2.6393693          3</span></span>
<span><span class="co">## 293 293 2.8054698 2.8805369          3</span></span>
<span><span class="co">## 294 294 2.8397886 2.9662385          3</span></span>
<span><span class="co">## 295 295 2.8304193 3.6515209          3</span></span>
<span><span class="co">## 296 296 3.7277042 3.0238688          3</span></span>
<span><span class="co">## 297 297        NA 2.6524427          3</span></span>
<span><span class="co">## 298 298 2.9879548 3.0433323          3</span></span>
<span><span class="co">## 299 299 3.3878268 2.2310781          3</span></span>
<span><span class="co">## 300 300 2.8500946 3.2121849          3</span></span>
<span><span class="co">## 301 301 4.3476113 4.0833800          4</span></span>
<span><span class="co">## 302 302        NA 4.2922800          4</span></span>
<span><span class="co">## 303 303 3.9241840 3.9615376          4</span></span>
<span><span class="co">## 304 304        NA 3.6611067          4</span></span>
<span><span class="co">## 305 305 4.3604671 4.2259583          4</span></span>
<span><span class="co">## 306 306        NA 3.7467551          4</span></span>
<span><span class="co">## 307 307 3.8721639 3.7883726          4</span></span>
<span><span class="co">## 308 308 3.4861016 4.3130108          4</span></span>
<span><span class="co">## 309 309 3.9020509 4.2146970          4</span></span>
<span><span class="co">## 310 310        NA 4.1124451          4</span></span>
<span><span class="co">## 311 311 3.8649831 3.5956771          4</span></span>
<span><span class="co">## 312 312 3.6861914 4.2532210          4</span></span>
<span><span class="co">## 313 313 4.2667627 4.3468959          4</span></span>
<span><span class="co">## 314 314 3.7170234 4.3835279          4</span></span>
<span><span class="co">## 315 315 3.6873592 3.9572186          4</span></span>
<span><span class="co">## 316 316 3.8618723 3.8170176          4</span></span>
<span><span class="co">## 317 317 3.8910541 4.3970700          4</span></span>
<span><span class="co">## 318 318 4.0247128 3.6726218          4</span></span>
<span><span class="co">## 319 319 4.2423415 4.6445756          4</span></span>
<span><span class="co">## 320 320 3.9953988 3.7483550          4</span></span>
<span><span class="co">## 321 321        NA 3.9808400          4</span></span>
<span><span class="co">## 322 322 4.0182994 3.4815520          4</span></span>
<span><span class="co">## 323 323 4.0618012 3.9696211          4</span></span>
<span><span class="co">## 324 324 3.8040993 3.7848547          4</span></span>
<span><span class="co">## 325 325 3.6878628 3.9887545          4</span></span>
<span><span class="co">## 326 326 4.3431280 4.3815871          4</span></span>
<span><span class="co">## 327 327 4.1411970 3.4125192          4</span></span>
<span><span class="co">## 328 328 4.0954998 4.2221941          4</span></span>
<span><span class="co">## 329 329 3.7182955 3.5868060          4</span></span>
<span><span class="co">## 330 330 3.9834742 3.3729089          4</span></span>
<span><span class="co">## 331 331        NA 4.2559792          4</span></span>
<span><span class="co">## 332 332 3.9073358 4.3362139          4</span></span>
<span><span class="co">## 333 333 3.8886601 4.6168791          4</span></span>
<span><span class="co">## 334 334 4.5298790 4.0262013          4</span></span>
<span><span class="co">## 335 335        NA 4.2254429          4</span></span>
<span><span class="co">## 336 336 4.0287620 3.7150802          4</span></span>
<span><span class="co">## 337 337 4.1396525 3.7137105          4</span></span>
<span><span class="co">## 338 338 4.1631615 3.5476991          4</span></span>
<span><span class="co">## 339 339 3.7094595 4.0050947          4</span></span>
<span><span class="co">## 340 340 3.9656169 3.7082002          4</span></span>
<span><span class="co">## 341 341 3.5007602 4.4271645          4</span></span>
<span><span class="co">## 342 342 3.9242084 3.4728176          4</span></span>
<span><span class="co">## 343 343 3.9381516 3.5472580          4</span></span>
<span><span class="co">## 344 344 4.3124886 4.0765256          4</span></span>
<span><span class="co">## 345 345 4.2112480 3.9481417          4</span></span>
<span><span class="co">## 346 346 4.0329488 4.5279996          4</span></span>
<span><span class="co">## 347 347 3.9821254 4.2913447          4</span></span>
<span><span class="co">## 348 348 4.2061152 4.4573028          4</span></span>
<span><span class="co">## 349 349        NA 3.9160553          4</span></span>
<span><span class="co">## 350 350 3.8554139 4.2793872          4</span></span>
<span><span class="co">## 351 351 4.1271775 3.8450185          4</span></span>
<span><span class="co">## 352 352 3.3834456 3.8884039          4</span></span>
<span><span class="co">## 353 353 4.1096120 4.0324993          4</span></span>
<span><span class="co">## 354 354 3.7302732 3.7311135          4</span></span>
<span><span class="co">## 355 355 4.0457811 2.9616443          4</span></span>
<span><span class="co">## 356 356 4.6709243 3.6917795          4</span></span>
<span><span class="co">## 357 357 4.0006321 4.3176244          4</span></span>
<span><span class="co">## 358 358 4.1591242 4.2608237          4</span></span>
<span><span class="co">## 359 359 4.2796416 4.3260656          4</span></span>
<span><span class="co">## 360 360 3.6771400 3.9714158          4</span></span>
<span><span class="co">## 361 361 3.5142601 3.7860458          4</span></span>
<span><span class="co">## 362 362        NA 3.5288225          4</span></span>
<span><span class="co">## 363 363 4.1123999 4.0279196          4</span></span>
<span><span class="co">## 364 364        NA 3.9366958          4</span></span>
<span><span class="co">## 365 365 3.9386542 4.1379059          4</span></span>
<span><span class="co">## 366 366 4.3183945 3.8589133          4</span></span>
<span><span class="co">## 367 367 3.7532944 4.3636754          4</span></span>
<span><span class="co">## 368 368 4.3918052 3.5096838          4</span></span>
<span><span class="co">## 369 369 3.4698336 4.1485125          4</span></span>
<span><span class="co">## 370 370 3.9129625 3.4703048          4</span></span>
<span><span class="co">## 371 371 4.2766464 4.1842627          4</span></span>
<span><span class="co">## 372 372 3.7798053 4.0074826          4</span></span>
<span><span class="co">## 373 373 4.3901014 3.9622655          4</span></span>
<span><span class="co">## 374 374 3.6973581 3.8136761          4</span></span>
<span><span class="co">## 375 375 4.6932017 3.7682068          4</span></span>
<span><span class="co">## 376 376        NA 3.8995107          4</span></span>
<span><span class="co">## 377 377 3.7265317 3.7053186          4</span></span>
<span><span class="co">## 378 378 4.5699700 4.2297142          4</span></span>
<span><span class="co">## 379 379 3.9122306 4.3860119          4</span></span>
<span><span class="co">## 380 380 4.1433704 3.3385204          4</span></span>
<span><span class="co">## 381 381        NA 4.1553022          4</span></span>
<span><span class="co">## 382 382        NA 4.0812221          4</span></span>
<span><span class="co">## 383 383 4.1651317 3.9553057          4</span></span>
<span><span class="co">## 384 384 3.7942889 4.0815295          4</span></span>
<span><span class="co">## 385 385 4.1767359 3.8394400          4</span></span>
<span><span class="co">## 386 386 4.0917468 3.7860130          4</span></span>
<span><span class="co">## 387 387        NA 3.8110521          4</span></span>
<span><span class="co">## 388 388        NA 3.9432055          4</span></span>
<span><span class="co">## 389 389        NA 4.4865011          4</span></span>
<span><span class="co">## 390 390 4.2266712 4.2910643          4</span></span>
<span><span class="co">## 391 391 3.7471674 3.8587951          4</span></span>
<span><span class="co">## 392 392 3.9256410 3.9401889          4</span></span>
<span><span class="co">## 393 393 4.3848105 4.2453839          4</span></span>
<span><span class="co">## 394 394 4.1118215 3.9360279          4</span></span>
<span><span class="co">## 395 395 4.2539791 3.7915140          4</span></span>
<span><span class="co">## 396 396 4.1089845 3.4686990          4</span></span>
<span><span class="co">## 397 397 3.6151247 4.4387316          4</span></span>
<span><span class="co">## 398 398 4.4765113 4.2012565          4</span></span>
<span><span class="co">## 399 399 4.1399433 3.6851421          4</span></span>
<span><span class="co">## 400 400 4.1300059 4.2514147          4</span></span>
<span><span class="co">## 401 401        NA 4.7920910          5</span></span>
<span><span class="co">## 402 402 4.9959306 4.9221884          5</span></span>
<span><span class="co">## 403 403 4.6923458 4.3572358          5</span></span>
<span><span class="co">## 404 404        NA 5.2192036          5</span></span>
<span><span class="co">## 405 405 4.6762163 4.8466997          5</span></span>
<span><span class="co">## 406 406 5.1930712 5.1130384          5</span></span>
<span><span class="co">## 407 407        NA 4.9080253          5</span></span>
<span><span class="co">## 408 408        NA 5.2764635          5</span></span>
<span><span class="co">## 409 409 4.6852745 4.7430760          5</span></span>
<span><span class="co">## 410 410 4.6242546 4.6773451          5</span></span>
<span><span class="co">## 411 411        NA 4.7942656          5</span></span>
<span><span class="co">## 412 412 5.3397536 5.3932975          5</span></span>
<span><span class="co">## 413 413 5.6417151 4.9321350          5</span></span>
<span><span class="co">## 414 414        NA 4.9729154          5</span></span>
<span><span class="co">## 415 415 5.2176663 5.3715613          5</span></span>
<span><span class="co">## 416 416 4.7635133 4.7865542          5</span></span>
<span><span class="co">## 417 417 5.0097447 4.1841061          5</span></span>
<span><span class="co">## 418 418 5.2998103 4.9666848          5</span></span>
<span><span class="co">## 419 419 5.0312908 4.3089380          5</span></span>
<span><span class="co">## 420 420 5.0576325 5.0593560          5</span></span>
<span><span class="co">## 421 421 4.8765537 5.1586615          5</span></span>
<span><span class="co">## 422 422 5.0218617 4.9290106          5</span></span>
<span><span class="co">## 423 423 4.8379250 5.0568355          5</span></span>
<span><span class="co">## 424 424        NA 5.3463638          5</span></span>
<span><span class="co">## 425 425 4.2012186 4.4618072          5</span></span>
<span><span class="co">## 426 426 4.9080355 5.1334754          5</span></span>
<span><span class="co">## 427 427        NA 5.0196659          5</span></span>
<span><span class="co">## 428 428        NA 4.6801578          5</span></span>
<span><span class="co">## 429 429 5.0389111 5.2466981          5</span></span>
<span><span class="co">## 430 430 4.8243611 5.0674834          5</span></span>
<span><span class="co">## 431 431 5.0103149 5.4932616          5</span></span>
<span><span class="co">## 432 432 4.2371489 5.2139609          5</span></span>
<span><span class="co">## 433 433        NA 4.7847469          5</span></span>
<span><span class="co">## 434 434 5.5845605 5.1680419          5</span></span>
<span><span class="co">## 435 435 4.8284386 5.2815980          5</span></span>
<span><span class="co">## 436 436 4.8749062 4.7235893          5</span></span>
<span><span class="co">## 437 437        NA 4.8092533          5</span></span>
<span><span class="co">## 438 438 5.0760002 4.4172800          5</span></span>
<span><span class="co">## 439 439 5.0194589 5.4063744          5</span></span>
<span><span class="co">## 440 440 5.1293335 5.3807414          5</span></span>
<span><span class="co">## 441 441 5.1191819 5.2209016          5</span></span>
<span><span class="co">## 442 442 5.0445426 5.2475333          5</span></span>
<span><span class="co">## 443 443        NA 5.0548766          5</span></span>
<span><span class="co">## 444 444 5.2118409 4.9032582          5</span></span>
<span><span class="co">## 445 445 5.6638959 5.0523344          5</span></span>
<span><span class="co">## 446 446 5.3145530 5.1930416          5</span></span>
<span><span class="co">## 447 447 4.4570645 5.4607618          5</span></span>
<span><span class="co">## 448 448 5.0760689 4.6763538          5</span></span>
<span><span class="co">## 449 449 5.0381747 5.1496774          5</span></span>
<span><span class="co">## 450 450 4.8272057 5.3364948          5</span></span>
<span><span class="co">## 451 451        NA 5.0235064          5</span></span>
<span><span class="co">## 452 452 5.2945529 4.8962242          5</span></span>
<span><span class="co">## 453 453 5.4757443 5.1899469          5</span></span>
<span><span class="co">## 454 454        NA 4.9672040          5</span></span>
<span><span class="co">## 455 455 5.2682671 4.4839289          5</span></span>
<span><span class="co">## 456 456 5.0331961 5.0106834          5</span></span>
<span><span class="co">## 457 457 5.1217395 5.1115765          5</span></span>
<span><span class="co">## 458 458 4.8037793 4.7892040          5</span></span>
<span><span class="co">## 459 459 5.4020159 4.7253572          5</span></span>
<span><span class="co">## 460 460 5.5096393 5.1352760          5</span></span>
<span><span class="co">## 461 461 5.2080385 4.8186683          5</span></span>
<span><span class="co">## 462 462 5.1271320 5.3816297          5</span></span>
<span><span class="co">## 463 463 4.9592384 5.0394938          5</span></span>
<span><span class="co">## 464 464        NA 4.9383306          5</span></span>
<span><span class="co">## 465 465 4.9013956 4.9615092          5</span></span>
<span><span class="co">## 466 466 4.6300329 4.9853191          5</span></span>
<span><span class="co">## 467 467 5.1639580 4.7844373          5</span></span>
<span><span class="co">## 468 468 5.0421553 4.9330479          5</span></span>
<span><span class="co">## 469 469 4.4318750 4.9100666          5</span></span>
<span><span class="co">## 470 470 5.0647101 4.7918841          5</span></span>
<span><span class="co">## 471 471        NA 4.5769057          5</span></span>
<span><span class="co">## 472 472 4.8541755 5.2877469          5</span></span>
<span><span class="co">## 473 473 5.2544497 4.8715962          5</span></span>
<span><span class="co">## 474 474 5.3549912 5.2071717          5</span></span>
<span><span class="co">## 475 475        NA 5.0108248          5</span></span>
<span><span class="co">## 476 476 4.6416200 5.5223492          5</span></span>
<span><span class="co">## 477 477 4.9352093 4.9834198          5</span></span>
<span><span class="co">## 478 478 4.9855329 5.2227229          5</span></span>
<span><span class="co">## 479 479 5.4272300 4.8673243          5</span></span>
<span><span class="co">## 480 480        NA 4.5831224          5</span></span>
<span><span class="co">## 481 481        NA 4.9095649          5</span></span>
<span><span class="co">## 482 482 4.8043153 5.0517028          5</span></span>
<span><span class="co">## 483 483 4.9251742 4.8908952          5</span></span>
<span><span class="co">## 484 484 5.1209896 4.5090521          5</span></span>
<span><span class="co">## 485 485 5.0853067 5.1741574          5</span></span>
<span><span class="co">## 486 486 5.1619070 4.9207909          5</span></span>
<span><span class="co">## 487 487        NA 5.1271740          5</span></span>
<span><span class="co">## 488 488 4.6709052 5.3782679          5</span></span>
<span><span class="co">## 489 489        NA 4.9045341          5</span></span>
<span><span class="co">## 490 490 5.0791769 4.6635926          5</span></span>
<span><span class="co">## 491 491 4.7949350 4.6975622          5</span></span>
<span><span class="co">## 492 492 5.3660370 4.0646708          5</span></span>
<span><span class="co">## 493 493        NA 5.2634901          5</span></span>
<span><span class="co">## 494 494 4.4840541 4.7187407          5</span></span>
<span><span class="co">## 495 495 5.3028545 5.1858557          5</span></span>
<span><span class="co">## 496 496        NA 4.9687492          5</span></span>
<span><span class="co">## 497 497 5.3958797 5.5934658          5</span></span>
<span><span class="co">## 498 498 4.6283699 4.7587944          5</span></span>
<span><span class="co">## 499 499        NA 4.9756455          5</span></span>
<span><span class="co">## 500 500        NA 4.7929955          5</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.984</span></span></code></pre>
<p>and plotting the results (without the NA’s) we get:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new_clust</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">true_clust</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_shape_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"true cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">km</span><span class="op">$</span><span class="va">centers</span>, size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 100 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="usage_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="high-dimensions">High dimensions<a class="anchor" aria-label="anchor" href="#high-dimensions"></a>
</h2>
<p>Let’s move to higher dimensions (and higher noise):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">0.3</span>, nclust <span class="op">=</span> <span class="fl">30</span>, dims <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">km</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="comparison-with-r-vanilla-kmeans">Comparison with R vanilla kmeans<a class="anchor" aria-label="anchor" href="#comparison-with-r-vanilla-kmeans"></a>
</h2>
<p>Let’s compare it to R vanilla kmeans:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">km_standard</span><span class="op">$</span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, clust <span class="op">=</span> <span class="va">km_standard</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tglkmeans</span><span class="fu">:::</span><span class="fu">match_clusters</span><span class="op">(</span><span class="va">data</span>, <span class="va">km_standard</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">true_clust</span> <span class="op">==</span> <span class="va">d</span><span class="op">$</span><span class="va">new_clust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">new_clust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6521739</span></span></code></pre>
<p>We can see that kmeans++ clusters significantly better than R vanilla
kmeans.</p>
</div>
<div class="section level2">
<h2 id="random-seed">Random seed<a class="anchor" aria-label="anchor" href="#random-seed"></a>
</h2>
<p>we can set the seed for the c++ random number generator, for
reproducible results:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="va">km2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TGL_kmeans_tidy.html">TGL_kmeans_tidy</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"V"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"euclid"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">60427</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">km1</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">km2</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aviezer Lifshitz, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
